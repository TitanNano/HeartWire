{"version":3,"sources":["webpack:///webpack/bootstrap 1779f1489a8ccb39d852","webpack:///./src/js/bootstrap.js","webpack:///./src/js/main.js","webpack:///./src/af/util/make.js","webpack:///./src/js/Account.js","webpack:///./src/af/core/prototypes/EventTarget.js","webpack:///./src/af/core/prototypes/Application.js","webpack:///./src/af/core/prototypes/Thread.js","webpack:///./src/af/core/objects/Shared.js","webpack:///./src/af/core/prototypes/ApplicationInternal.js","webpack:///./src/js/BottomInput.js","webpack:///./src/af/modules/DataBinding.js","webpack:///./src/af/modules/DataBinding/Template.js","webpack:///./src/af/modules/DataBinding/Bind.js","webpack:///./src/af/modules/DataBinding/Parser.js","webpack:///./src/af/modules/DataBinding/Mapping.js","webpack:///./src/af/modules/DataBinding/Util.js","webpack:///./src/af/modules/DataBinding/AutoBinding.js","webpack:///./src/af/modules/DataBinding/Binding.js","webpack:///./src/af/modules/DataBinding/BindingRegistry.js","webpack:///./src/af/modules/DataBinding/ClassBinding.js","webpack:///./src/af/modules/DataBinding/RenderEngine.js","webpack:///./src/af/modules/DataBinding/RenderEngine/TaskList.js","webpack:///./src/af/modules/DataBinding/EnabledBinding.js","webpack:///./src/af/modules/DataBinding/ScopePrototype.js","webpack:///./src/af/modules/DataBinding/StyleBinding.js","webpack:///./src/af/modules/DataBinding/TemplateRepeatBinding.js","webpack:///./src/af/modules/DataBinding/TwoWayBinding.js","webpack:///./src/af/modules/DataBinding/TemplateLoader.js","webpack:///./src/af/core/prototypes/NetworkRequest.js","webpack:///./src/af/modules/DataBinding/ViewPort.js","webpack:///./src/af/modules/DataBinding/IfBinding.js","webpack:///./src/af/modules/DataBinding/ElementToScopeBinding.js","webpack:///./src/af/modules/DataBinding/AttributeBinding.js","webpack:///./src/js/Header.js","webpack:///./src/js/LoginDialog.js","webpack:///./src/js/MessageList.js","webpack:///./src/js/PushManager.js","webpack:///./src/js/ScreenManager.js","webpack:///./src/js/Socket.js","webpack:///./src/af/modules/uuid.js","webpack:///./src/af/modules/sha-1.js"],"names":["onDeviceReady","init","deviceReady","Promise","ready","window","cordova","document","addEventListener","readyState","polymerReady","Polymer","ImportStatus","_ready","whenReady","all","then","application","name","pushManager","socket","headerController","bottomInputController","messageListController","loginDialog","_make","sreeenManager","host","account","apply","target","source","Object","keys","forEach","key","defineProperty","getOwnPropertyDescriptor","Make","object","prototype","arguments","length","create","m","make","args","get","hasPrototype","p","getPrototypeOf","undefined","Mixin","prototypes","Proxy","MixinTrap","findProperty","i","item","bind","value","Account","_socket","_userData","credentialsReady","busy","isReady","_credentials","username","password","connected","sendMessage","response","data","error","reject","user","console","log","emit","catch","reason","localStorage","removeItem","disconnect","authenticate","btoa","setItem","getItem","EventTarget","_listeners","on","type","listener","push","setTimeout","Internal","WeakMap","Application","version","author","set","scope","listeners","removeListener","index","indexOf","splice","f","thread","workers","terminate","Thread","parent","_thread","_promise","Worker","threadLoader","postMessage","func","progressListeners","done","e","ApplicationInternal","modules","BottomInput","currentDraft","inputValue","inputFocused","inputElement","getAttribute","usePlaceholderClass","inputFocusChange","event","cancleRecycle","view","__apply__","makeTemplate","NodeList","NamedNodeMap","Array","style","createElement","innerHTML","head","appendChild","DataBinding","bindNode","ViewPort","makeElementFromTemplate","template","schedulePostRenderTask","node","importNode","content","placeholder","querySelector","attributes","firstElementChild","setAttribute","attr","parentNode","replaceChild","children","className","id","map","search","replace","hasAttribute","element","parentScope","processed","makeElement","list","querySelectorAll","MutationObserver","mutations","addedNodes","slice","reduce","prev","next","concat","filter","localName","observe","body","childList","subtree","isReplace","isInsert","elementList","childNodes","__cleanElements__","removeChild","parentName","insertBefore","scopeList","Map","scopeIndex","watcherList","expressionTracking","isolated","Node","bindings","checkNode","recycle","dataRegex","scopeInfo","nodeName","nodeType","text","textContent","variables","match","visibilityBinding","transparencyBinding","enabledAttribute","classes","modelBinding","autoBinding","twoWay","styleBinding","singleBinding","bindTwoWay","bindClasses","bindEnabled","bindAuto","bindStyle","test","bindSimple","repeatedTemplate","child","bindTemplateRepeat","events","bindEvents","removeAttribute","indirect","property","split","viewBinding","eventBinding","preventDefault","binding","properties","originalNodeValue","currentValue","compareTwoWay","getElementValue","newValue","singleExpression","marker","createComment","method","modifier","$methods","trim","canceled","scopeName","executeWatchers","watcher","expression","cb","scheduleRenderTask","t0","performance","now","update","expr","t1","duration","color","toFixed","destoryScope","inProgress","scopes","destory","scopes_add","bindings_add","delete","ObjectParser","keyBuffer","valueBuffer","run","char","parseExpression","contexts","chain","functionTest","pos","scopeChild","substring","arg","assignExpression","attributeNames","visible","transparent","prefix","enabled","model","modelEvent","rename","selectElement","query","context","polyMask","selectAllElements","nodeList","unwrapPolymerNode","polyNode","additions","bare","dom","polyInvoke","getPolyParent","AutoBinding","_isBound","_scope","subScope","scopeHolder","scopeObjName","lastIndexOf","pop","join","__destroy__","Binding","localNode","values","pair","Attr","toString","registry","BindingRegistry","register","warn","ClassBinding","applyClass","substr","classList","add","remove","JSON","parse","stringify","preRenderHooks","postRenderHooks","preRenderTasks","renderTasks","postRenderTasks","nextPostRenderTasks","active","renderCycle","hook","task","tasks","flush","scheduleNextFrame","requestAnimationFrame","RenderEngine","addPreRenderHook","addPostRenderHook","removePreRenderHook","removePostRenderHook","schedulePreRenderTask","renderFrame","TaskList","registeredIds","EnabledBinding","ScopePrototype","fn","localRecycle","__watch__","has","require","readStyleProperties","container","getComputedStyle","dimensions","getBoundingClientRect","styleKey","StyleBinding","TemplateRepeatBinding","itemNodeList","itemScopeList","modelBackup","renderItem","itemName","fragment","polyParent","childScope","$first","$last","$index","__parentScope__","link","dirty","isArray","DocumentFragment","nextElementSibling","count","TwoWayBinding","attribute","oldValue","activeElement","range","createRange","selection","getSelection","selectNodeContents","collapse","removeAllRanges","addRange","importTemplate","request","send","markup","stripHashKey","NetworkRequest","_body","_headers","url","headers","setHeader","onReady","self","xhr","XMLHttpRequest","open","promise","success","failure","onreadystatechange","status","getResponseHeader","setRequestHeader","LIST_HAS_ITEMS","ViewPortInstance","_bound","_innerScope","_originalTemplate","_application","templateUrl","overflow","firstChild","alowOverflow","_elements","getInstance","free","instance","IfBinding","nextSibling","isTrue","ElementToScopeBinding","AttributeBinding","config","attrName","attrValue","attrEnabled","Header","notConnected","isOnline","isConnected","connectionStatus","isConnecting","onStatusChange","LoginDialog","_account","userNameField","passwordField","usernameError","passwordError","isOpen","isNotActive","isValid","usernameField","validate","login","getErrorMessage","validationMessage","MessageList","currentMessages","timestamp","PushManager","platform","serviceStatus","_newPushHandler","_registerHandler","_handleServiceError","_baiduHandleServiceReady","_register","clientId","_handleMessageError","platformId","navigator","_newMessage","token","_registerServiceSimple","force","registrations","onsuccess","result","unregister","enpoint","_simpleHandleServiceReady","onerror","baiduPush","startWork","onNotificationArrived","mozSetMessageHandler","onPush","_newPusHandler","onRegister","setRegistrationFailed","ScreenManager","applicationIsActive","hidden","uuid","Socket","_host","_hostId","_websocket","_online","_connected","_connecting","_stop","_onStatusChange","_decelerate","_decelerateTimeout","_decelerateMaxTimeout","_statusChange","_onceQueue","_connectedHandler","onLine","reconnect","_ack","messageId","v5","_onMessage","message","once","close","decelerate","WebSocket","onopen","onclose","onmessage","UUID_SIZE","ReadBytesOfHexString","_value","readByte","byte","parseInt","hex8Bit","hex16Bit","hex32Bit","hex48Bit","buffer","Uint8Array","time_low","time_mid","time_hi_and_version","clock_seq","pushToBuffer","reverse","namespace","nameValue","ArrayBuffer","namespaceValue","completeValue","byteLength","uuidBuffer","hash","charCodeAt","clock_seq_hi_and_reserved","clock_seq_low","uint32","Math","pow","leftRotateBits","amount","hex64Bit","stringToBuffer","unescape","encodeURIComponent","bufferView","sha1","h0","h1","h2","h3","h4","messageLength","bufferSize","temp","Uint32Array","a","b","c","d","k"],"mappings":"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","file":"1779f1489a8ccb39d852.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 1779f1489a8ccb39d852\n **/","import application from './main.js';\n\nlet onDeviceReady = function() {\n    application.init();\n}\n\n\nlet deviceReady = new Promise((ready) => {\n    if (!!window.cordova) {\n        document.addEventListener('deviceready', ready, false);\n    } else if (document.readyState != 'loading') {\n        onDeviceReady();\n    } else {\n        document.addEventListener('DOMContentLoaded', ready, false);\n    }\n});\n\nlet polymerReady = new Promise((ready) => {\n    if (window.Polymer && window.Polymer.ImportStatus._ready) {\n        window.Polymer.ImportStatus.whenReady(ready);\n    } else {\n        window.addEventListener('WebComponentsReady', ready);\n    }\n});\n\nPromise.all([deviceReady, polymerReady]).then(onDeviceReady);\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/bootstrap.js\n **/","import { Make } from '../af/util/make.js';\nimport Account from './Account.js';\nimport Application from '../af/core/prototypes/Application.js';\nimport BottomInput from './BottomInput.js';\nimport Header from './Header.js';\nimport LoginDialog from './LoginDialog.js';\nimport MessageList from './MessageList.js';\nimport PushManager from './PushManager.js';\nimport ScreenManager from './ScreenManager.js';\nimport Socket from './Socket.js';\n\nlet application = Make({\n    name: 'HeartWire',\n\n    pushManager: null,\n    socket: null,\n\n    headerController: null,\n    bottomInputController: null,\n    messageListController: null,\n    loginDialog: null,\n\n    _make: function() {\n        this.pushManager = PushManager;\n        this.sreeenManager = ScreenManager;\n\n        this.socket = Make(Socket)({\n            host: [\n                'localhost:5000',\n                '192.168.44.210:5000',\n                '192.168.44.231:5000',\n                '192.168.178.25:5000',\n            ]\n        });\n\n        this.account = Make(Account)(this.socket);\n\n        this.headerController = Make(Header)(this);\n        this.bottomInputController = Make(BottomInput)();\n        this.messageListController = Make(MessageList)();\n        this.loginDialog = Make(LoginDialog)(this.account);\n    },\n\n    init: function() {\n        this.pushManager.init();\n    },\n\n}, Application)();\n\nexport default application;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/main.js\n **/","/**\n * The make module consits of Make, getPrototypeOf and mixin.\n * See the documentation for each method to see what is does.\n * This module is part of the ApplicationFrame.\n * @module Make\n * @author Jovan Gerodetti\n * @copyright Jovan Gerodetti\n * @version 1.0\n */\n\n\n/**\n * Internal function to apply one objects propteries to a target object.\n *\n * @param {Object} target\n * @param {Object} source\n * @inner\n */\nvar apply = function (target, source) {\n    Object.keys(source).forEach(function(key){\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n    });\n\n    return target;\n};\n\n/**\n * Creates a new object with the given prototype.\n * If two arguments are passed in, the properties of the first object will be\n * applied to the new object.\n *\n * @param {Object} object\n * @param {Object} prototype\n * @return {function}\n */\nexport var Make = function(object, prototype) {\n    if(arguments.length < 2){\n        prototype = object;\n        object = null;\n    }\n\n    if (object === null) {\n        object = Object.create(prototype);\n    } else {\n        object = apply(Object.create(prototype), object);\n    }\n\n    var m = function(...args){\n        var make = object.make || object._make || function(){};\n\n        make.apply(object, args);\n\n        return object;\n    };\n\n    m.get = function(){ return object; };\n\n    return m;\n};\n\n/**\n * This method checks if the given prototype is in the prototype chain of\n * the given target object.\n *\n * @param {Object} object\n * @param {Object} prototype\n * @return {boolean}\n */\nexport var hasPrototype = function(object, prototype){\n    var p = Object.getPrototypeOf(object);\n\n    while(p !== null && p !== undefined){\n        if(typeof prototype == 'function')\n            prototype = prototype.prototype;\n\n        if(p == prototype)\n            return true;\n        else\n            p = Object.getPrototypeOf(p);\n    }\n\n    return false;\n};\n\n/**\n * Creates a new prototype mixing all the given prototypes. Incase two or more\n * prototypes contain the same propterty, the new prototype will return\n * the propterty of the first prototype in the list which contains it.\n *\n * @param {...Object} prototypes - the porotype object to combine\n * @return {Proxy} - the resulting proxy object\n */\nexport var Mixin = function(...prototypes){\n\n    return new Proxy(prototypes, MixinTrap);\n\n};\n\n/**\n * Internal function to find a proptery in a list of prototypes.\n *\n * @param {Object[]} prototypes\n * @param {string} key\n * @return {Object}\n */\nvar findProperty = function(prototypes, key) {\n    for (var i = 0; i < prototypes.length; i++) {\n        var item = prototypes[i];\n\n        if (item && item[key]) {\n            return item;\n        }\n    }\n\n    return undefined;\n};\n\n/**\n * Traps to create a mixin.\n */\nvar MixinTrap = {\n\n    'get' : function(prototypes, key) {\n        var object = findProperty(prototypes, key);\n\n        if (object && typeof object[key] === 'function') {\n            return object[key].bind(object);\n        }\n\n        return (object ? object[key] : null);\n    },\n\n    'set' : function(prototypes, key, value) {\n        var object = findProperty(prototypes, key);\n\n        if (object) {\n            object[key] = value;\n        } else {\n            prototypes[0][key] = value;\n        }\n\n        return true;\n    }\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/util/make.js\n **/","import { Make } from '../af/util/make.js';\nimport EventTarget from '../af/core/prototypes/EventTarget';\n\nconst Account = Make(/** @lends Account# */{\n\n    /**\n     * [_socket description]\n     *\n     * @type {Socket}\n     */\n    _socket: null,\n    _userData: null,\n\n    credentialsReady: false,\n    busy: false,\n\n    get isReady() {\n        return !!this._userData;\n    },\n\n    _make: function(socket) {\n        EventTarget._make.apply(this);\n\n        let [username, password] = this._credentials;\n\n        this._socket = socket;\n\n        if (username && password) {\n            this.credentialsReady = true;\n            this._socket.init();\n        }\n\n        this._socket.connected(() => {\n            let [username, password] = this._credentials;\n\n            if (username && password) {\n                this._socket.sendMessage('authentication', {\n                    username: username,\n                    password: password\n                }).then(response => {\n                    if (response.data.error) {\n                        return Promise.reject(response);\n                    } else {\n                        return response;\n                    }\n                }).then(({ data: user }) => {\n                    console.log('Account: user ', user, 'sucessfully logged in');\n\n                    this._userData = user;\n                    this.busy = false;\n                    this.emit('statusChange');\n                }).catch(error => {\n                    console.error('login faild! reason:', error.data.reason);\n\n                    this.credentialsReady = false;\n                    this.busy = false;\n                    window.localStorage.removeItem('heartwire.username');\n                    window.localStorage.removeItem('heartwire.password');\n                    this._socket.disconnect();\n                    this.emit('statusChange');\n                });\n            }\n        });\n    },\n\n    /**\n     * [authenticate description]\n     *\n     * @param  {string} username [description]\n     * @param  {string} password [description]\n     *\n     * @return {Promise}          [description]\n     */\n    authenticate: function(username, password) {\n        password = btoa(password);\n\n        window.localStorage.setItem('heartwire.username', username);\n        window.localStorage.setItem('heartwire.password', password);\n\n        this.credentialsReady = true;\n        this.busy = true;\n        this._socket.init();\n    },\n\n    get _credentials() {\n        let username = window.localStorage.getItem('heartwire.username');\n        let password = window.localStorage.getItem('heartwire.password');\n\n        return [username, password];\n    }\n\n}, EventTarget).get();\n\nexport default Account;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/Account.js\n **/","/** @lends EventTarget# */\nlet EventTarget = {\n\n    /** @type {Object} */\n    _listeners : null,\n\n    /**\n     * @constructs\n     *\n     * @return {void}\n     */\n    _make : function(){\n        this._listeners = {};\n    },\n\n    /**\n     * registers a new listener for the given event.\n     *\n     * @param {string} type the type of event\n     * @param {function} listener callback to execute when the event fires\n     *\n     * @return {void}\n     */\n    on : function(type, listener){\n        if (!this._listeners[type]) {\n            this._listeners[type] = [];\n        }\n\n        this._listeners[type].push(listener);\n    },\n\n    /**\n     * emmits a new event on this object\n     *\n     * @param {string} type the type of event\n     * @param {*} data data to send to the callbacks\n     *\n     * @return {void}\n     */\n    emit : function(type, data){\n        if (this._listeners[type]) {\n            setTimeout(() =>\n                this._listeners[type].forEach(listener =>\n                    listener.apply(this, [data])\n            ), 0);\n        }\n    }\n};\n\nexport default EventTarget;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/core/prototypes/EventTarget.js\n **/","import { Make } from '../../util/make.js';\nimport Thread from './Thread.js';\nimport ApplicationInternal from './ApplicationInternal.js';\n\nlet Internal = new WeakMap();\n\n/** @lends Application.prototype */\nlet Application = {\n\n    /**\n    * Name of this application so other components can identify the application.\n    *\n    * @type {string}\n    */\n    name : '',\n\n    /**\n    * Some components may need to know the version of this applicaion.\n    *\n    * @type {string}\n    */\n    version : '0.0.0',\n\n    /**\n    * @type {string}\n    */\n    author : '',\n\n    /**\n    * @constructs\n    *\n    * @return {void}\n    */\n    _make : function(){\n        Internal.set(this, Make(ApplicationInternal)());\n    },\n\n    /**\n    * Initializes this application, default interface for components and modules.\n    *\n    * @return {void}\n    */\n    init : function(){\n        console.log(`Initialzing Application \"${this.name}\"!`);\n    },\n\n\n    /**\n    * Registers a new event listener for the given event type.\n    *\n    * @param {string} type the event type\n    * @param {function} listener the listener function\n    *\n    * @return {Application} this application\n    */\n    on : function(type, listener){\n        let scope = Internal.get(this);\n\n        if (!scope.listeners[type]) {\n            scope.listeners[type] = [];\n        }\n\n        scope.listeners[type].push(listener);\n\n        return this;\n    },\n\n    /**\n    * removes a previously attached listener function.\n    *\n    * @param  {string} type     the listener type\n    * @param  {Function} listener the listener function to remove\n    *\n    * @return {void}\n    */\n    removeListener: function(type, listener) {\n        let scope = Internal.get(this);\n\n        if (scope.listeners[type]) {\n            let index = scope.listeners[type].indexOf(listener);\n\n            scope.listeners[type].splice(index, 1);\n        }\n    },\n\n    /**\n    * Emmits a new event on this application.\n    *\n    * @param {string} type event type\n    * @param {Object} data event data\n    *\n    * @return {void}\n    */\n    emit : function(type, data){\n        let scope = Internal.get(this);\n        let name = this.name ? `${this.name}:%c ` : '%c%c';\n\n        if (scope.listeners[type]) {\n            console.log(`%c${name}${type} event emitted`,\n                'font-weight: 900; text-decoration: underline;',\n                'font-weight: initial; text-decoration: initial;');\n\n            setTimeout(() => scope.listeners[type].forEach(f => f(data)), 0);\n        }\n    },\n\n    /**\n    * Creates a new thread for this applicaion.\n    *\n    * @param {function} f function to execute in a new thread\n    *\n    * @return {ApplicationScopeInterface} this applicaion scope\n    */\n    thread : function(f){\n        let scope= Internal.get(this);\n\n        scope.workers.push(Make(Thread)(f));\n\n        return this;\n    },\n\n    /**\n    * This function will try to terminate the application by emitting the termination event.\n    *\n    * @param {string} reason - the reason for the termination.\n    *\n    * @return {void}\n    */\n    terminate : function(reason){\n        this.emit('terminate', reason);\n    }\n\n};\n\nexport default Application;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/core/prototypes/Application.js\n **/","/**\n * @file Thread\n * @deprecated Don't use this anymore. It will be removed soon.\n */\n\nimport Shared from '../objects/Shared.js';\n\n/**\n * this prototype defines a new scope worker\n */\nlet Thread = {\n\n    /**\n     * The parent application of this thread.\n     *\n     * @type {Application}\n     */\n    parent : null,\n\n    /**\n     * The Worker Object for this thread.\n     *\n     * @type {Worker}\n     * @private\n     */\n    _thread : null,\n\n    _promise : null,\n\n    then : null,\n\n    catch : null,\n\n    /**\n     * @constructs\n     * @param {function} f\n     * @param {Application} parent\n     */\n    _make : function(f, parent){\n        this.parent= parent;\n        this.thread= new Worker(Shared.threadLoader);\n        this.thread.postMessage({ name : 'init', func : f });\n        this.progressListeners= [];\n\n        this._promise = new Promise((done) => {\n            this._thread.addEventListener('message', function(e){\n                if(e.data.name == 'af-worker-done')\n                    done(e.data.data);\n            }, false);\n        });\n\n        this._thread.addEventListener('message', e => {\n            if(e.data.name == 'af-worker-progress') {\n                this.emit('progress', e.data.data);\n            }\n        }, false);\n\n        this.then = this._promise.then.bind(this._promise);\n        this.catch = this._promise.catch.bind(this._promise);\n    }\n};\n\nexport default Thread;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/core/prototypes/Thread.js\n **/","/**\n * @file Shared\n * @deprecated Don't use this anymore. It will be removed soon.\n */\n\nexport default {};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/core/objects/Shared.js\n **/","\n/** @lends ApplicationInternal# */\nlet ApplicationInternal = {\n    /**\n     * @type {Thread}\n     */\n    thread : null,\n\n    /**\n     * @type {Worker[]}\n     */\n    workers : null,\n\n    /**\n     * @type {Function[]}\n     */\n    listeners : null,\n\n    /**\n     * @type {Catalog}\n     */\n    modules : null,\n\n    /**\n     * this prototype defines a new application scope\n     *\n     * @constructs\n     *\n     * @return {void}\n     */\n    _make : function(){\n        this.workers= [];\n        this.listeners= [];\n\n        this._make = null;\n    }\n};\n\nexport default ApplicationInternal;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/core/prototypes/ApplicationInternal.js\n **/","import DataBinding from '../af/modules/DataBinding.js';\n\nlet BottomInput = {\n    currentDraft: '',\n\n    get inputValue() {\n        return this.inputFocused || this.currentDraft.length > 0 ?\n            this.currentDraft : (this.inputElement && this.inputElement.getAttribute('placeholder'));\n    },\n\n    set inputValue(value) {\n        this.currentDraft = value;\n    },\n\n    inputFocused: false,\n\n    get usePlaceholderClass() {\n        return (!this.inputFocused && this.currentDraft.length === 0) ? 'placeholder': '';\n    },\n\n    /** @type HTMLDivElement */\n    inputElement: null,\n\n    inputFocusChange: function(event) {\n        event.cancleRecycle();\n        this.view.inputFocused = event.type === 'focus';\n        this.__apply__(null, true);\n    },\n\n    scope: null,\n\n    _make: function() {\n        this.scope = DataBinding.makeTemplate('#bottom-input', { view: this });\n    }\n}\n\nexport default BottomInput;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/BottomInput.js\n **/","/**\n * DataBinding Module\n *\n * @module DataBinding\n * @default module:DataBinding.DataBinding\n */\n\nimport { makeTemplate } from './DataBinding/Template.js';\nimport { polyInvoke } from './DataBinding/Util.js';\nimport { bindNode } from './DataBinding/Bind.js';\nimport ViewPort from './DataBinding/ViewPort.js';\nimport './DataBinding/IfBinding.js';\nimport './DataBinding/ElementToScopeBinding.js';\nimport './DataBinding/AttributeBinding.js';\n\nNodeList.prototype.forEach = NamedNodeMap.prototype.forEach = Array.prototype.forEach;\n\nlet style = document.createElement('style');\n\nstyle.innerHTML = `\n    [bind-display=\"false\"] {\n        display: none !important;\n    }\n\n    [bind-visible=\"false\"] {\n        visibility: hidden;\n    }\n`;\n\npolyInvoke(document.head).appendChild(style);\n\n/**\n * [DataBinding description]\n *\n * @type {module:DataBinding.ModuleInterface}\n */\nexport let DataBinding = {\n    makeTemplate : makeTemplate,\n    bindNode : bindNode,\n    ViewPort : ViewPort,\n};\n\nexport default DataBinding;\n\n/**\n * @interface ModuleInterface\n * @borrows module:DataBinding/Bind.bindNode as bindNode\n * @borrows module:DataBinding/Template.makeTemplate as makeTemplate\n * @borrows module:DataBinding/ViewPort.ViewPort\n * @static\n *\n */\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/modules/DataBinding.js\n **/","/**\n * @module DataBinding/Template\n */\n\nimport { Make } from '../../util/make.js';\nimport { bindNode } from './Bind.js';\nimport { getPolyParent, polyInvoke } from './Util.js';\nimport { importTemplate } from './TemplateLoader.js';\nimport { parseExpression } from './Parser';\nimport RenderEngine from './RenderEngine';\nimport ScopePrototype from './ScopePrototype.js';\n\n/**\n * Instanciates a template based on a specified element.\n *\n * @param  {HTMLTemplateElement}               template    the template to instanciate\n * @param  {module:DataBinding.ScopePrototype} scope       the scope to operate on\n * @param  {Application}                       application the application this binding belongs to\n * @param  {Node}                              item        the original node\n *\n * @return {void}\n */\nlet makeElementFromTemplate = function(template, scope, application, item) {\n    RenderEngine.schedulePostRenderTask(() => {\n    let node = document.importNode(template.content, true);\n    let placeholder = node.querySelector('bind-placeholder');\n\n    item.attributes.forEach(attr => {\n        polyInvoke(node.firstElementChild).setAttribute(attr.name, attr.value);\n    });\n\n    if (placeholder) {\n        let node = item.firstElementChild;\n        polyInvoke(placeholder.parentNode).replaceChild(item.firstElementChild, placeholder);\n\n        [].forEach.apply(item.children, [item => {\n            polyInvoke(node.parentNode).appendChild(item);\n        }]);\n    }\n\n    node.firstElementChild.className = template.id + ' ' + node.firstElementChild.className;\n\n    scope = scope();\n\n    [].map.apply(node.firstElementChild.attributes, [item => {\n        if (item.name.search(/^scope\\-/) > -1 ) {\n            scope[item.name.replace(/^scope\\-/, '')] = item.value;\n        }\n    }]);\n\n    if (template.hasAttribute('component')) {\n        scope.element = node.firstElementChild;\n    }\n\n    scope = bindNode(node, scope);\n\n    polyInvoke(item.parentNode).replaceChild(node, item);\n\n    if (application) {\n        application.emit(`newElement:${template.id}`, scope);\n    }\n    });\n};\n\n/**\n * creates a new instance of an HTML template and applies the binding with\n * the given scope.\n *\n * @function\n *\n * @param {Node|string} template - the template to render\n * @param {ScopePrototype} scope - the scope for this template to bind to\n * @param {Application} [application] - the application this template belongs to\n * @param {ScopePrototype} [parentScope] - the surounding scope of this template node\n *\n * @return {Object} - collection of scope and rendered element\n */\nexport let makeTemplate = function (template, scope, application, parentScope) {\n    template = (typeof template === 'string') ? document.querySelector(template) : template;\n\n    if (template.hasAttribute('src') && !template.processed) {\n        let source = template.getAttribute('src');\n\n        if (parentScope) {\n            let value = parseExpression(source, parentScope);\n\n            source = (value && value != '') ? value : source;\n        }\n\n        scope = Make(scope, ScopePrototype)();\n\n        importTemplate(source, template)\n            .then(template => {\n                template.processed = true;\n                makeTemplate(template, scope, application, parentScope)\n            });\n\n        return scope;\n\n    } else if (template.hasAttribute('bind-element')) {\n        let makeElement = makeElementFromTemplate.bind(this, template, scope, application);\n        let list = document.querySelectorAll(template.id);\n\n        [].forEach.apply(list, [makeElement]);\n\n        (new MutationObserver(mutations => {\n            mutations.forEach(item => {\n                if (item.addedNodes.length > 0) {\n                    let list = [].map.apply(item.addedNodes, [node => {\n                        return node.querySelectorAll ? [].slice.apply(node.querySelectorAll(template.id)) : [];\n                    }]).reduce((prev, next) => prev.concat(next), []);\n\n                    list = list.concat([].filter.apply(item.addedNodes, [node => node.localName === template.id]));\n\n                    [].forEach.apply(list, [makeElement]);\n                }\n            });\n        })).observe(document.body, {\n            childList : true,\n            subtree : true\n        });\n\n    } else {\n        let node = document.importNode(template.content, true);\n        let isReplace = template.hasAttribute('replace');\n        let isInsert = template.hasAttribute('insert');\n\n        scope = bindNode(node, scope);\n\n        if (isReplace || isInsert) {\n            let elementList = [].slice.apply(node.childNodes);\n\n            scope.__cleanElements__ = function(){\n                elementList.forEach(node => {\n                    node.parentNode && node.parentNode.removeChild(node);\n                });\n            }\n        }\n\n        let parentNode = template.parentNode;\n\n        if (template.getAttribute('poly-parent')) {\n            let parentName = template.getAttribute('poly-parent');\n\n            parentNode = getPolyParent(template, parentName);\n        }\n\n        if (isReplace) {\n            console.log('replace template');\n\n            polyInvoke(parentNode).replaceChild(node, template);\n        } else if (isInsert) {\n            polyInvoke(parentNode).insertBefore(node, template);\n        }\n\n        return {　node : node, scope : scope };\n    }\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/modules/DataBinding/Template.js\n **/","/**\n * @module DataBinding/Bind\n */\n\nimport { Make, hasPrototype } from '../../util/make.js';\nimport { ObjectParser, parseExpression, assignExpression } from './Parser.js';\nimport { attributeNames } from './Mapping.js';\nimport { polyInvoke } from './Util.js';\nimport AutoBinding from './AutoBinding.js';\nimport Binding from './Binding.js';\nimport BindingRegistry from './BindingRegistry.js';\nimport ClassBinding from './ClassBinding.js';\nimport EnabledBinding from './EnabledBinding.js';\nimport RenderEngine from './RenderEngine';\nimport ScopePrototype from './ScopePrototype.js';\nimport StyleBinding from './StyleBinding';\nimport TemplateRepeatBinding from './TemplateRepeatBinding.js';\nimport TwoWayBinding from './TwoWayBinding.js';\n\n/**\n * Contains all scope, scopeInfo pairs.\n *\n * @type {WeakMap}\n */\nlet scopeList = new Map();\n\n/**\n * @type {ScopePrototype[]}\n */\nlet scopeIndex = [];\n\n/**\n * @type {Array[]}\n */\nexport let watcherList = new Map();\n\n/**\n * @type {Object}\n */\nlet expressionTracking = {};\n\n/**\n * applies the binding to the node for the given scope.\n *\n * @function\n * @param {Node|string} node - the node which should be bound\n * @param {Object} scope - the scope which should be bound to\n * @param {boolean} isolated - indicates if this scope should be recycled isolated\n * @return {module:DataBinding~ScopePrototype} the scope this node is bound to\n */\nexport let bindNode = function(node, scope, isolated) {\n\tscope = hasPrototype(scope, ScopePrototype) ? scope : Make(scope, ScopePrototype)();\n    node = hasPrototype(node, Node) ? node : document.querySelector(node);\n\n\tscopeList.set(scope, {\n\t\tnode : node,\n\t\tbindings : []\n\t});\n\n    scopeIndex.push(scope);\n\n\tcheckNode(node, scope);\n    recycle(isolated ? scope : false);\n\n\treturn scope;\n};\n\n/**\n * Travels through a node and it's children searching for binding expressions\n *\n * @param {Node} node - the node to check\n * @param {module:DataBinding.ScopePrototype} scope - the scope this node should be bound to\n * @param {Node} parentNode - the parent of the provided node\n * @return {void}\n */\nlet checkNode = function(node, scope, parentNode) {\n    let dataRegex = /{{[^{}]*}}/g;\n    let scopeInfo = scopeList.get(scope);\n\n\tif (node.nodeName == '#text' || node.nodeType === 2) {\n    \tlet text = node.value || polyInvoke(node).textContent,\n            variables = text.match(dataRegex),\n            visibilityBinding = (node.name === attributeNames.get('visible')),\n            transparencyBinding = (node.name === attributeNames.get('transparent')),\n            enabledAttribute = node.name === attributeNames.get('enabled'),\n            classes = (node.name === attributeNames.get('classes')),\n            modelBinding = node.name === attributeNames.get('model'),\n            autoBinding = node.name === 'bind',\n            twoWay = (node.name === attributeNames.get('value') || modelBinding),\n            styleBinding = (node.name === 'bind-style');\n\n        let singleBinding = visibilityBinding || transparencyBinding;\n\n        if (twoWay) {\n            bindTwoWay(text, scope, scopeInfo, node, parentNode, modelBinding);\n        } else if (classes) {\n            bindClasses(text, node, scopeInfo, parentNode);\n        } else if (enabledAttribute) {\n            bindEnabled(text, scopeInfo, parentNode);\n        } else if (autoBinding) {\n            bindAuto(text, scopeInfo, parentNode);\n        } else if (styleBinding) {\n            bindStyle(text, scopeInfo, scope, parentNode);\n        } else if (BindingRegistry.get(node.name) && BindingRegistry.get(node.name).test()) {\n            Make(BindingRegistry.get(node.name))({\n                text: text,\n                variables: variables,\n                scope: scope,\n                scopeInfo: scopeInfo,\n                node: node,\n                parentNode: parentNode,\n            });\n        } else if (variables || singleBinding) {\n            bindSimple(text, node, variables, scopeInfo, singleBinding, parentNode);\n        }\n\n    } else if(node.localName === 'template'){\n        let repeatedTemplate = (node.hasAttribute('replace') &&\n                                node.hasAttribute('repeat')) ||\n                                node.hasAttribute('bind-repeat');\n\n        node.attributes.forEach(child => checkNode(child, scope, node));\n\n        if (repeatedTemplate) {\n            bindTemplateRepeat(node, scopeInfo);\n        }\n    } else {\n        if (node.attributes) {\n            node.attributes.forEach((child) => checkNode(child, scope, node));\n\n            let events = node.getAttribute(attributeNames.get('events'));\n\n        \tif (events !== null) {\n        \t\tbindEvents(events, node, scope);\n\n\t\t\t\tpolyInvoke(node).removeAttribute(attributeNames.get('events'));\n       \t\t}\n        }\n\n        node.childNodes.forEach((node) => { return checkNode(node, scope); });\n    }\n};\n\n/**\n * creates a two way binding\n *\n * @param {string} text - the attribute text\n * @param {module:DataBinding.ScopePrototype} scope - the scope for this binding\n * @param {Object} scopeInfo - the scopeInfo for this binding\n * @param {Node} node - the attribute node\n * @param {Node} parentNode - the actual node\n * @param {boolean} indirect - indicates if this binding is indirect\n * @return {void}\n */\nlet bindTwoWay = function(text, scope, scopeInfo, node, parentNode, indirect){\n    let property = text.replace(/[{}]/g, '');\n    let value = parseExpression(property, scope);\n    let [event, viewBinding, eventBinding, preventDefault] = (parentNode.getAttribute(attributeNames.get('modelEvent')) || '').split(':');\n\n    /** @type {TwoWayBinding} */\n    let binding = Make({\n        properties : [property],\n        originalNodeValue : text,\n        currentValue : value,\n        node : node,\n        parentNode : parentNode,\n        indirect : indirect,\n        viewBinding : viewBinding,\n    }, TwoWayBinding).get();\n\n    scopeInfo.bindings.push(binding);\n\n    if (node.name === attributeNames.get('model')) {\n        parentNode.addEventListener(event, e => {\n            if (preventDefault === 'true') {\n                e.preventDefault();\n            }\n\n            console.log(e);\n            let value = parseExpression(eventBinding, e);\n            compareTwoWay(value, scope, binding);\n        });\n    } else if(node.name === attributeNames.get('value')) {\n        parentNode.addEventListener('keyup', e => {\n            e.preventDefault();\n            compareTwoWay(getElementValue(e.target), scope, binding);\n        });\n    }\n};\n\n/**\n * Compares for changes in the UI in a two way binding\n *\n * @param {string} newValue - the new value to compare\n * @param {module:DataBinding.ScopePrototype} scope - the scope of the comparison\n * @param {TwoWayBinding} binding - the binding to compare\n * @return {void}\n */\nlet compareTwoWay = function(newValue, scope, binding){\n    if (binding.currentValue !== newValue) {\n        assignExpression(binding.properties[0], scope, newValue);\n        binding.currentValue = newValue;\n\n        console.log('update from view:', scope);\n\n        recycle();\n    }\n}\n\n/**\n * creates a simple binding\n *\n * @param {string} text the initial text of the node\n * @param {Node} node the text or attribute node of the binding\n * @param {string[]} variables list of expressions\n * @param {Object} scopeInfo meta data of the current scope\n * @param {boolean} singleExpression - indicates if text contains only one expression\n * @param {Node} parentNode the element that contains the text node or attribute\n *\n * @return {void}\n */\nlet bindSimple = function(text, node, variables, scopeInfo, singleExpression, parentNode){\n    /** @type {Binding} */\n    let binding = Make({\n        originalNodeValue : text,\n        node : node,\n        parentNode : parentNode,\n        singleExpression : singleExpression,\n        properties : variables ? variables.map(item => item.replace(/[{}]/g, '')) : []\n    }, Binding).get();\n\n    scopeInfo.bindings.push(binding);\n}\n\n/**\n * binds an object expression to node.className.\n *\n * @param  {string} text      the initial text value of the binding node\n * @param  {Node}   node        the binding node\n * @param  {Object} scopeInfo the meta data of the current scope\n * @param  {Node}   parentNode  the parent of the binding node\n *\n * @return {void}\n */\nlet bindClasses = function(text, node, scopeInfo, parentNode) {\n    let binding = Make({\n        originalNodeValue : text,\n        node : node,\n        classes : ObjectParser(text),\n        parentNode : parentNode\n    }, ClassBinding).get();\n\n    scopeInfo.bindings.push(binding);\n};\n\n/**\n * binds an expression to the disabled attribute.\n *\n * @param  {string} text       the initial value of the binding node\n * @param  {Object} scopeInfo  the meta data of the current scope\n * @param  {Node}   parentNode the parent of the binding node\n *\n * @return {void}\n */\nlet bindEnabled = function(text, scopeInfo, parentNode) {\n    let binding = Make({\n        originalNodeValue : text,\n        parentNode : parentNode\n    }, EnabledBinding)();\n\n    scopeInfo.bindings.push(binding);\n};\n\n/**\n * binds a template to an array or list. The template is repeated for each list item.\n *\n * @param  {Node}   template  the template node\n * @param  {Object} scopeInfo the meta data of the current scope\n *\n * @return {void}\n */\nlet bindTemplateRepeat = function(template, scopeInfo) {\n    let text = template.hasAttribute('bind-repeat') ?\n                            template.getAttribute('bind-repeat') :\n                            template.getAttribute('repeat');\n\n    let marker = document.createComment(`repeat ${template.id} with ${text}`);\n    let binding = Make({\n        originalNodeValue : text,\n        template : template,\n        marker : marker,\n    }, TemplateRepeatBinding)();\n\n    console.log('replace template with marker');\n    polyInvoke(template.parentNode).replaceChild(marker, template);\n    scopeInfo.bindings.push(binding);\n};\n\n/**\n * Binds the events specified for a Node\n *\n * @param {string[]}                          events a string representation of the object with all the event / expression pairs.\n * @param {Node}                              node   the node on which the event listeners should be registered.\n * @param {module:DataBinding~ScopePrototype} scope  the data scope on which the binding happens.\n * @return {void}\n */\nlet bindEvents = function(events, node, scope){\n\tevents = ObjectParser(events);\n\n\tObject.keys(events).forEach(name => {\n\t\tlet [method, modifier] = events[name].split('|');\n\n        if (scope.$methods && scope.$methods[method.trim()]) {\n            node.addEventListener(name.trim(), e => {\n                scope.$methods[method.trim()].apply(scope, [e]);\n\n                scope.__apply__();\n            });\n        } else {\n            method = parseExpression(method.trim(), scope);\n\n            node.addEventListener(name.trim(), e => {\n                let canceled = false;\n\n                e.cancleRecycle = function(){\n                    canceled = true;\n                }\n\n                method.apply(scope, [e]);\n\n                if (!canceled)\n                    scope.__apply__();\n            }, modifier === 'capture');\n        }\n\t});\n};\n\n/**\n * automatically binds a template to a property of the current scope\n *\n * @param  {string} text      the binding text\n * @param  {Object} scopeInfo the meta data of the current scope\n * @param  {Node}   template  the template node\n *\n * @return {void}\n */\nlet bindAuto = function(text, scopeInfo, template) {\n    let binding = Make({\n        scopeName : text,\n        template : template\n    }, AutoBinding)();\n\n    scopeInfo.bindings.push(binding);\n}\n\n/**\n * binds visual properties to the scope\n *\n * @param  {string}                            text       the binding text\n * @param  {Object}                            scopeInfo  the meta data of the scope\n * @param  {module:DataBinding~ScopePrototype} scope      the current scope\n * @param  {Node}                              parentNode the parent of the binding node\n *\n * @return {void}\n */\nlet bindStyle = function(text, scopeInfo, scope, parentNode) {\n    let binding = Make({\n        bindings: text,\n        parentNode: parentNode,\n    }, StyleBinding)(scope);\n\n    scopeInfo.bindings.push(binding);\n}\n\n/**\n * executes every watcher for the given scope.\n *\n * @param  {module:DataBinding~ScopePrototype} scope the current scope\n *\n * @return {void}\n */\nlet executeWatchers = function(scope) {\n    watcherList.get(scope) && watcherList.get(scope).forEach(watcher => {\n        let value = parseExpression(watcher.expression, scope);\n\n        expressionTracking[watcher.expression] = expressionTracking[watcher.expression] || { value : '', newValue : '' };\n\n        if (expressionTracking[watcher.expression].value !== value) {\n            watcher.cb.apply(scope, [value]);\n\n            expressionTracking[watcher.expression].newValue = value;\n        }\n    });\n}\n\n/**\n * Checks every binding for the given scope and updates every value.\n *\n * @function\n * @param {module:DataBinding~ScopePrototype} [scope] the scope to recycle\n *\n * @return {void}\n */\nexport let recycle = function (scope) {\n    RenderEngine.scheduleRenderTask(() => {\n        let t0 = window.performance.now();\n\n        if (scope) {\n            executeWatchers(scope);\n            scopeList.get(scope).bindings.forEach(binding => binding.update(scope));\n\n        } else {\n            scopeIndex.forEach(scope => {\n                executeWatchers(scope);\n    \t        scopeList.get(scope).bindings.forEach(binding => binding.update(scope));\n            });\n        }\n\n        Object.keys(expressionTracking).forEach(expr => {\n            expr = expressionTracking[expr];\n\n            expr.value = expr.newValue;\n        });\n\n        let t1 = window.performance.now();\n        let duration = ((t1 - t0) / 1000);\n        let color = null;\n\n        if (duration >= 0.033) {\n            color = 'red';\n        } else if (duration >= 0.016) {\n            color = 'yellow';\n        } else {\n            color = 'green';\n        }\n\n        color = `color: ${color};`;\n        duration = duration.toFixed(2);\n\n        if (scope) {\n            console.log(`scope recycled in %c${duration}s`, color);\n        } else {\n            console.log(`full recycle in %c${duration}s`, color);\n        }\n    }, scope || 'DataBindingRecycle');\n};\n\n/**\n * destories a scope.\n *\n * @function\n * @param {module:DataBinding~ScopePrototype} scope the scope to destory\n * @param {boolean} inProgress                indicates if this is an initial call or not.\n *\n * @return {void}\n */\nexport let destoryScope = function(scope, inProgress) {\n    console.log(scopeList);\n    let scopeInfo = scopeList.get(scope);\n\n    let [scopes, bindings] = scopeInfo.bindings.reduce((prev, binding) => {\n        let [scopes, bindings] = prev;\n\n        if (binding.destory) {\n            let [scopes_add, bindings_add] = binding.destory();\n\n            scopes += scopes_add;\n            bindings += bindings_add;\n        }\n\n        return [scopes, bindings];\n    }, [0, 0]);\n\n    bindings += scopeInfo.bindings.length;\n    scopes += 1;\n\n    scopeList.delete(scope);\n    scopeIndex.splice(scopeIndex.indexOf(scope), 1);\n    watcherList.delete(scope);\n\n    if (inProgress) {\n        return [scopes, bindings];\n    } else {\n        console.log(`${scopes} scopes and ${bindings} bindings cleaned!`);\n    }\n};\n\n/**\n * Returns the value of an DOM Node\n *\n * @param {Node} node the node to fetch the value from\n *\n * @return {string} value of this node\n */\nlet getElementValue = function(node){\n    if (node.localName === 'input') {\n        return node.value;\n    } else {\n        return 'UNKNOWN NODE!';\n    }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/modules/DataBinding/Bind.js\n **/","/**\n * @module DataBinding/Parser\n */\n\n/**\n * Parses an object expression\n *\n * @param {string} source - the string to parse.\n * @return {Object} the parsed result.\n */\nexport let ObjectParser = function(source){\n    let target = null;\n    let key = false;\n    let keyBuffer = '';\n    let valueBuffer = '';\n    let run = true;\n\n    source.split('').forEach((char) => {\n        if (run) {\n            if (char === '{') {\n                target = {};\n                key = true;\n            } else if(char === ':') {\n                key = false;\n            } else if(char === ',') {\n                target[keyBuffer.trim()] = valueBuffer.trim();\n                keyBuffer = valueBuffer = '';\n                key = true;\n            } else if(char === '}') {\n                target[keyBuffer.trim()] = valueBuffer.trim();\n                run = false;\n            } else if(key) {\n                keyBuffer += char;\n            } else if(!key) {\n                valueBuffer += char;\n            }\n        }\n    });\n\n    return target;\n};\n\n/**\n * Parses a given expression in the context of the given scope.\n *\n * @param {string} expression - the expression to parse.\n * @param {ScopePrototype} scope - the scope on which the expression should be parsed.\n * @return {*} the result value.\n */\nexport let parseExpression = function(expression, ...contexts){\n\tlet chain = expression.split('.');\n    let scope = null;\n    let functionTest = /\\(((([\\w\\.]+)(, |,|))+)\\)/;\n\n    for (let i = 0; i < contexts.length; i++) {\n        scope = contexts[i];\n\n        chain.forEach((item) => {\n            let pos = item.search(functionTest);\n\n            if (scope) {\n                if (pos > 0) {\n                    let args = item.match(functionTest)[1].split(',').map(item => item.trim());\n                    let scopeChild = scope[item.substring(0, pos)];\n\n                    if (scopeChild) {\n                        args = args.map(arg => parseExpression(arg, ...contexts));\n                        scope = scopeChild.apply(scope, args);\n                    } else {\n                        return null;\n                    }\n                } else {\n                    scope = scope[item];\n                }\n            }\n        });\n\n        if (scope !== null && scope !== undefined) {\n            break;\n        }\n    }\n\n    return (scope !== null && typeof scope !== \"undefined\") ? scope : '';\n};\n\n/**\n * Assings an value to an expression in an given scope\n *\n * @param {string} expression the expression on whith the value should be assigned\n * @param {ScopePrototype} scope the scope to operate on\n * @param {string} value the value to assign\n *\n * @return {void}\n */\nexport let assignExpression = function(expression, scope, value){\n    let chain = expression.split('.');\n\n    chain.forEach((property, index) => {\n        if (chain.length -1 !== index) {\n            scope = scope[property];\n        } else {\n            scope[property] = value;\n        }\n    });\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/modules/DataBinding/Parser.js\n **/","/**\n * @module DataBinding/Mapping\n */\n\n/**\n * Contains all the attribute names\n *\n * @namespace\n */\nexport let attributeNames = {\n    events : 'events',\n    visible : 'display',\n    transparent : 'visible',\n    classes : 'class',\n    value : 'value',\n    prefix : 'bind',\n    enabled : 'enabled',\n    model : 'model',\n    modelEvent : 'model-event',\n\n    /**\n     * returns the value for a key\n     *\n     * @param  {string} key the key to lookup\n     *\n     * @return {string}     the coresponding value\n     */\n    get : function(key){\n        return `${this.prefix}-${this[key]}`;\n    },\n\n    /**\n     * cuts off the prefix of the name\n     *\n     * @param  {string} name initial value\n     *\n     * @return {string}      the clean value\n     */\n    rename : function(name){\n        return name.replace(`${this.prefix}\\-`, '');\n    }\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/modules/DataBinding/Mapping.js\n **/","import { Mixin, hasPrototype } from '../../util/make.js';\n\n/**\n * selects a dom node by the given query.\n *\n * @function\n * @deprecated don't use this anymore, polyMask is deprecated.\n *\n * @param {string} query the query selector to search for on the DOM\n * @param {Node} [context] the node to start the searching on\n *\n * @return {Node} the first node that matches the selector\n */\nexport let selectElement = function(query, context){\n    let node = null;\n\n    if (context) {\n        node = context.querySelector(query);\n    } else {\n        node = document.querySelector(query);\n    }\n\n    node = polyMask(node);\n\n    return node;\n};\n\n/**\n * @function\n * @deprecated don't use anymore. Use {@link document.querySelectorAll}\n *\n * @param {string} query the query to look for\n * @param {Node} context the node to start the searching on\n *\n * @return {NodeList} the node list with all matching nodes\n */\nexport let selectAllElements = function(query, context) {\n    let nodeList = null;\n\n    if (context) {\n        nodeList = context.querySelectorAll(query);\n    } else {\n        nodeList = document.querySelectorAll(query);\n    }\n\n    if (window.Polymer) {\n        nodeList = [].map.apply(nodeList, [polyMask]);\n    }\n\n    return nodeList;\n}\n\n/**\n * attempts to extract the original node from an polymer node\n *\n * @function\n * @deprecated there is no need to use this function anymore\n *\n * @param {Node} node the node to unwrap\n *\n * @return {Node} a mixin exposing the original node\n */\nexport let unwrapPolymerNode = function(node) {\n    if (!hasPrototype(node, Node)) {\n        return Mixin(node, node.node);\n    }\n\n    return node;\n}\n\n/**\n * creates a mixin of the node and a wrapped version from Polymer\n *\n * @function\n * @deprecated this method shouldn't be used anymore. Use polyInvoke\n *\n * @param {Node} node the dom node to mask\n *\n * @return {Node} returns the masked node\n */\nexport let polyMask = function(node){\n    let polyNode = {};\n\n    let additions = {\n        get bare (){\n            return node;\n        }\n    };\n\n    if (window.Polymer) {\n        polyNode = window.Polymer.dom(node);\n    }\n\n    return Mixin(polyNode, node, additions);\n};\n\n/**\n * Tries to call Polymers dom() function if available, to keep them in the loop.\n *\n * @param {Node} node the node we want to take care of.\n * @return {Node} the dom node, maybe wrapped.\n */\nexport let polyInvoke = function(node) {\n\n    if (window.Polymer) {\n        node = window.Polymer.dom(node);\n    }\n\n    return node;\n}\n\n/**\n * attempts to find a parent node with a particular node name\n *\n * @function\n *\n * @param {Node} node the base node\n * @param {string} parentName the node name to search for\n *\n * @return {Node} the node we where searching for \n */\nexport let getPolyParent = function(node, parentName){\n    while (node && node.localName !== parentName) {\n        node = node.parentNode;\n    }\n\n    return node;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/modules/DataBinding/Util.js\n **/","import { Make } from '../../util/make.js';\nimport Binding from './Binding.js';\nimport { parseExpression } from './Parser.js';\nimport { makeTemplate } from './Template.js';\n\nlet AutoBinding = Make(/** @lends module:DataBinding.AutoBinding.prototype*/{\n\n    scopeName : '',\n\n    /** @type {HTMLTemplateNode} */\n    template : null,\n\n    /** @type {boolean} */\n    _isBound : false,\n\n    /**\n     * An auto binding instanciates a template and binds it\n     * to a property of the current scope.\n     *\n     * @constructs\n     * @extends module:DataBinding.Binding\n     * @return {void}\n     */\n    _make : function(){},\n\n    /** @type module:DataBinding.ScopePrototype */\n    _scope : null,\n\n    update : function(scope) {\n        if (!this._isBound) {\n            let subScope = parseExpression(this.scopeName, scope);\n\n            setTimeout(() => {\n                let scopeHolder = null;\n                let scopeObjName = null;\n\n                if (this.scopeName.lastIndexOf('.') > 0) {\n                    scopeHolder = this.scopeName.split('.');\n                    scopeObjName =  scopeHolder.pop();\n                    scopeHolder = parseExpression(scopeHolder.join('.'), scope);\n\n                    scopeHolder[scopeObjName] = makeTemplate(this.template, subScope, true);\n\n                    this._scope = scopeHolder[scopeObjName];\n                } else {\n                    this._scope = makeTemplate(this.template, subScope, true);\n                }\n            }, 0);\n\n            this._isBound = true;\n        }\n    },\n\n    /**\n     * destroys this binding. This binding needs to be destroied before\n     * it is deleted, since it creates a new scope.\n     *\n     * @return {void}\n     */\n    destory : function(){\n        if (this._scope) {\n            return this._scope.__destroy__(true);\n        } else {\n            return [0, 0];\n        }\n    }\n\n}, Binding).get();\n\nexport default AutoBinding;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/modules/DataBinding/AutoBinding.js\n **/","import { hasPrototype } from '../../util/make';\nimport { parseExpression } from './Parser.js';\nimport { polyInvoke } from './Util.js';\n\n/** @lends module:DataBinding.Binding.prototype */\nlet Binding = {\n\n    /**\n     * @type {string[]}\n     */\n    properties : null,\n\n    /**\n     * @type {string}\n     */\n    originalNodeValue : '',\n\n    /**\n     * @type {Node}\n     */\n    node : null,\n\n    /**\n     * @type {Node}\n     */\n    parentNode : null,\n\n    /**\n     * @type {Boolean}\n     */\n    singleExpression : false,\n\n    /**\n     * The basic prototype for bindings. Any binding should inherit form this prototype.\n     *\n     * @constructs\n     * @return {void}\n     */\n    _make : function() {\n        this.properties = [];\n    },\n\n    /**\n     * updates a binding. The model will be checked for changes\n     * and new data will be applied to the binding target.\n     *\n     * @param  {module:DataBinding.ScopePrototype} scope the scope on which\n     *                                             this binding should operate.\n     *\n     * @return {void}\n     */\n    update : function(scope){\n        let text = this.originalNodeValue;\n        let localNode = { element: this.parentNode };\n        let values = this.properties.map(key => {\n            let item = { name : key, value : parseExpression(key, localNode, scope) };\n\n            return item;\n        });\n\n        if (this.singleExpression) {\n                text = parseExpression(text, localNode, scope);\n        } else {\n            values.forEach(pair => {\n                text = text.replace(`\\{\\{${pair.name}\\}\\}`, pair.value);\n            });\n        }\n\n        if (hasPrototype(this.node, window.Attr)) {\n            if (this.parentNode.getAttribute(this.node.name) !== text) {\n                polyInvoke(this.parentNode).setAttribute(this.node.name, text);\n            }\n        } else {\n            text = text.toString().replace(/ /g, '\\u00a0');\n\n            if (this.node.textContent !== text) {\n                this.node.textContent = text;\n            }\n        }\n    },\n\n    test: function() { return true; }\n};\n\nexport default Binding;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/modules/DataBinding/Binding.js\n **/","/**\n * @module DataBinding/BindingRegistry\n */\n\n/**\n * Registry of all bindings.\n *\n * @type {Object}\n */\nlet registry = {};\n\n\n/**\n * Public Singleton Interface for the binding registry.\n *\n * @class BindingRegistry\n */\n/** @lends module:DataBinding/BindingRegistry~BindingRegistry.prototype */\nlet BindingRegistry = {\n\n    /**\n     * @param {Binding} binding - new binding type\n     * @return {boolean} - success status\n     */\n    register : function(binding) {\n        if (!registry[binding.name]) {\n            registry[binding.name] = binding;\n            return true;\n\n        } else {\n            console.warn(`Binding type ${binding.name} already exists!`);\n            return false;\n        }\n    },\n\n    /**\n     * @param {string} name - binding name\n     * @return {Binding} - the binding for the given name\n     */\n    get: function(name) {\n        return registry[name];\n    }\n}\n\n/**\n * @member BindingRegistry\n * @static\n * @type module:DataBinding/BindingRegistry~BindingRegistry\n */\nexport default BindingRegistry;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/modules/DataBinding/BindingRegistry.js\n **/","import { Make } from '../../util/make.js';\nimport { parseExpression } from './Parser.js';\nimport Binding from './Binding.js';\nimport RenderEngine from './RenderEngine';\n\nlet ClassBinding = Make(/** @lends module:DataBinding.ClassBinding.prototype */{\n\n    /**\n     * @type {Object}\n     */\n    classes : null,\n\n    /**\n     * @type {Node}\n     */\n    parentNode : null,\n\n    /**\n     * @constructs\n     * @extends {module:DataBinding.Binding}\n     */\n    _make : Binding._make,\n\n    /**\n     * applies a class to the parent node, based on the binding values.\n     *\n     * @param  {module:DataBinding.ScopePrototype} scope the scope to operate on.\n     * @param  {Object} classes class-expression-map\n     * @param  {string} key     the class name to apply\n     *\n     * @return {void}\n     */\n    applyClass : function(scope, classes, key) {\n        let expression = classes[key];\n        let value = parseExpression(expression, scope);\n\n        key = (key[0] === '!') ? key.substr(1) : key;\n\n        if (value) {\n            this.parentNode.classList.add(key);\n        } else {\n            this.parentNode.classList.remove(key);\n        }\n    },\n\n    update : function(scope){\n        let classes = JSON.parse(JSON.stringify(this.classes));\n\n        Object.keys(classes)\n            .filter(key => key.indexOf('!') === 0)\n            .forEach(this.applyClass.bind(this, scope, classes));\n\n        RenderEngine.scheduleRenderTask(() => {\n            Object.keys(classes)\n                .filter(key => key.indexOf('!') !== 0)\n                .forEach(this.applyClass.bind(this, scope, classes));\n        });\n    }\n\n}, Binding).get();\n\nexport default ClassBinding;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/modules/DataBinding/ClassBinding.js\n **/","/**\n * @module RenderEngine\n */\n\nimport { Make } from '../../util/make';\nimport TaskList from './RenderEngine/TaskList';\n\n/** @type {Function[]} */\nlet preRenderHooks = [];\n\n/** @type {Function[]} */\nlet postRenderHooks = [];\n\n/** @type {module:RenderEngine.TaskList} */\nlet preRenderTasks = Make(TaskList)();\n\n/** @type {module:RenderEngine.TaskList} */\nlet renderTasks = Make(TaskList)();\n\n/** @type {Function[]} */\nlet postRenderTasks = [];\n\n/** @type {Function[]} */\nlet nextPostRenderTasks = [];\n\n/** @type {boolean} */\nlet active = false;\n\n/**\n * performs all render tasks from one frame. This is one render cycle.\n *\n * @return {void}\n */\nlet renderCycle = function() {\n    active = false;\n\n    // run all post render hooks after a frame has been painted. So this happens\n    // at the beginning of the next cycle.\n    postRenderHooks.forEach(hook => hook());\n    postRenderTasks.forEach(task => task());\n\n    // init render cycle.\n    // nothing at the moment.\n\n    // run the pre render hooks before we start to do render stuff.\n    preRenderHooks.forEach(hook => hook());\n\n    // run pre render tasks\n    let tasks = preRenderTasks.tasks;\n    preRenderTasks.flush();\n    tasks.forEach(task => task());\n\n    //run all render tasks.\n    tasks = renderTasks.tasks;\n    renderTasks.flush();\n    tasks.forEach(task => task());\n\n    //finish rendering, final steps\n    postRenderTasks = nextPostRenderTasks;\n    nextPostRenderTasks = [];\n\n    // done wait for next frame.\n    scheduleNextFrame();\n};\n\n/**\n * Schedules a new render cycle in the browsers rendeing engine.\n * The cycle is performed as soon as the browser is ready to render a new frame.\n *\n * @return {void}\n */\nlet scheduleNextFrame = function() {\n    if (!active && (postRenderHooks.length > 0 || preRenderHooks.length > 0 ||\n        renderTasks.length > 0 || postRenderTasks.length > 0 || nextPostRenderTasks.length > 0)) {\n            window.requestAnimationFrame(renderCycle);\n\n            active = true;\n    }\n}\n\n\n/**\n * RenderEngine Singleton\n *\n * @namespace\n */\nlet RenderEngine = {\n\n    /**\n     * @param {Function} f a hook function to execute before each render cycle\n     * @return {Function} returns the function which has been passed in\n     */\n    addPreRenderHook: function(f) {\n        preRenderHooks.push(f);\n        scheduleNextFrame();\n\n        return f;\n    },\n\n    /**\n     * @param {Function} f - a hook function to execute after each render cycle\n     * @return {Function} returns the function which has been passed in.\n     */\n    addPostRenderHook: function(f) {\n        postRenderHooks.push(f);\n        scheduleNextFrame();\n\n        return f;\n    },\n\n    /**\n     * Removes a previously added pre render hook\n     *\n     * @param  {Function} f - the function which was previously added\n     * @return {*} - see Array.prototype.splice\n     */\n    removePreRenderHook: function(f) {\n        return preRenderHooks.splice(preRenderHooks.indexOf(f), 1);\n    },\n\n    /**\n     * Removes a previously added post render hook\n     *\n     * @param  {Function} f - the function which was previously added\n     * @return {*} {@link Array.prototype.splice}\n     */\n    removePostRenderHook: function(f) {\n        return postRenderHooks.splice(postRenderHooks.indexOf(f), 1);\n    },\n\n    /**\n     * @param {Function} f - the task to preform in the next render cycle.\n     * @param {string} [id] optional task id\n     * @return {Function} the function which has been passed in.\n     */\n    schedulePreRenderTask: function(f, id) {\n        preRenderTasks.push(f, id);\n        scheduleNextFrame();\n\n        return f;\n    },\n\n    /**\n     * @param {Function} f - the task to preform in the next render cycle.\n     * @param {string} [id] optional task id\n     * @return {Function} the function which has been passed in.\n     */\n    scheduleRenderTask: function(f, id) {\n        renderTasks.push(f, id);\n        scheduleNextFrame();\n\n        return f;\n    },\n\n    /**\n     * @param {Function} f - the task to preform after the next render cycle.\n     * @return {Function} the function which has been passed in.\n     */\n    schedulePostRenderTask: function(f) {\n        nextPostRenderTasks.push(f);\n        scheduleNextFrame();\n\n        return f;\n    },\n\n    /**\n     * Forces the engine to render a new frame even if there are no tasks\n     *\n     * @return {void}\n     */\n    renderFrame: function() {\n        if(!active) {\n            scheduleNextFrame();\n        }\n    }\n};\n\n/**\n * @member {module:RenderEngine~RenderEngine} RenderEngine\n * @static\n */\nexport default RenderEngine;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/modules/DataBinding/RenderEngine.js\n **/","\n/** @lends module:RenderEngine.TaskList.prototype */\nlet TaskList = {\n\n    /** @type Array */\n    tasks: null,\n\n    /** @type Array */\n    registeredIds: null,\n\n    /**\n     * Render TaskList to manage rendertaks and optionally track duplicates by ids.\n     *\n     * @constructs\n     * @return {void}\n     */\n    _make: function() {\n        this.tasks = [];\n        this.registeredIds = [];\n    },\n\n    /**\n     * adds a new item to the task list.\n     *\n     * @param  {Function} task the task to add to the list\n     * @param  {string} [id] the id of this tasks. If provided no task with the same id can be added again.\n     * @return {void}\n     */\n    push: function(task, id) {\n        if (!id || this.registeredIds.indexOf(id) < 0) {\n            this.tasks.push(task);\n\n            if (id) {\n                this.registeredIds.push(id);\n            }\n        }\n    },\n\n    /** @type {number} */\n    get length() {\n        return this.tasks.length;\n    },\n\n    flush: function() {\n        this.tasks = [];\n        this.registeredIds = [];\n    }\n};\n\nexport default TaskList;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/modules/DataBinding/RenderEngine/TaskList.js\n **/","import { Make } from '../../util/make.js';\nimport { parseExpression } from './Parser.js';\nimport { polyInvoke } from './Util.js';\nimport Binding from './Binding.js';\n\nlet EnabledBinding = Make(/** @lends module:DataBinding.EnabledBinding# */{\n    /**\n     * @type {Node}\n     */\n    parentNode : null,\n\n    /**\n     * @constructs\n     * @extends {module:DataBinding.Binding}\n     */\n    _make: Binding._make,\n\n    /**\n     * @param {module:DataBinding.ScopePrototype} scope the scope to work on\n     * @return {void}\n     */\n    update : function(scope){\n        let value = parseExpression(this.originalNodeValue, scope);\n\n        if (!value) {\n            polyInvoke(this.parentNode).setAttribute('disabled', '');\n        } else {\n            polyInvoke(this.parentNode).removeAttribute('disabled');\n        }\n    }\n\n}, Binding).get();\n\nexport default EnabledBinding;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/modules/DataBinding/EnabledBinding.js\n **/","import { parseExpression } from './Parser';\nimport { recycle, watcherList, destoryScope } from './Bind.js';\n\n/**\n * @class ScopePrototype\n * @memberof module:DataBinding\n */\n\n/**\n * @lends module:DataBinding.ScopePrototype.prototype\n */\nlet ScopePrototype = {\n\n    /**\n    * will apply the current state of the bound model.\n    *\n    * @param {function} [fn]            function to execute before rendering\n    * @param {boolean} [localRecycle]   only recycle the current scope\n    *\n    * @return {void}\n    */\n    __apply__ : function(fn, localRecycle){\n        if (fn) {\n            fn();\n        }\n\n        return recycle(localRecycle ? this : null);\n    },\n\n    /**\n     * starts to watch the given expression and fires when the value changes.\n     *\n     * @param  {string}   expression the expression to watch\n     * @param  {Function} cb         will be called once the value changes\n     *\n     * @return {void}\n     */\n    __watch__ : function(expression, cb) {\n        if (!watcherList.has(this)) {\n            watcherList.set(this, []);\n        }\n\n        watcherList.get(this).push({\n            expression : expression,\n            cb : cb\n        });\n    },\n\n    /**\n     * destorys a scope\n     *\n     * @param  {boolean} inProgress whenever this is an initial call or not\n     *\n     * @return {boolean} status\n     */\n    __destroy__ : function(inProgress) {\n        return destoryScope(this, inProgress);\n    },\n\n    /**\n    * resolves when the expression returns not undefined or null\n    *\n    * @param  {string|Function}   expression the expression to evaluate\n    *\n    * @return {Promise}                      resolves when stable\n    */\n    require: function(expression) {\n        return new Promise((done) => {\n            let value = null;\n\n            if (typeof expression === 'function') {\n                value = expression();\n            } else {\n                value = parseExpression(expression, this);\n            }\n\n            if (value !== undefined && value !== null) {\n                done(value);\n            }\n        });\n    }\n};\n\nexport default ScopePrototype;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/modules/DataBinding/ScopePrototype.js\n **/","/**\n * @module DataBinding/StyleBinding\n */\n\nimport { Make } from '../../util/make';\nimport { ObjectParser, assignExpression } from './Parser';\n\nimport Binding from './Binding';\nimport RenderEngine from './RenderEngine';\n\n/**\n * @param {StyleBinding} container - binding container\n * @param {ScopePrototype} scope - the scope for this binding\n * @return {void}\n */\nlet readStyleProperties = function(container, scope) {\n    Object.keys(container.bindings).forEach(styleKey => {\n        let style = window.getComputedStyle(container.parentNode);\n        let dimensions = container.parentNode.getBoundingClientRect();\n\n        if(styleKey.split('.')[0] === 'dimensions') {\n            let value = dimensions[styleKey.split('.')[1]];\n\n            assignExpression(container.bindings[styleKey], scope, value);\n        } else {\n            assignExpression(container.bindings[styleKey], scope, style[styleKey]);\n        }\n    });\n}\n\nlet StyleBinding = Make(/** @lends module:DataBinding/StyleBinding~StyleBinding# */{\n    bindings: null,\n\n    /**\n     * @constructs\n     * @extends {module:DataBinding.Binding}\n     *\n     * @return {void}\n     */\n    _make: function() {\n        this.bindings = ObjectParser(this.bindings);\n    },\n\n    update: function(scope) {\n        RenderEngine.schedulePostRenderTask(readStyleProperties.bind(null, this, scope));\n    }\n}, Binding).get();\n\n/**\n * @member StyleBinding\n * @type {module:DataBinding/StyleBinding~StyleBinding}\n * @static\n */\nexport default StyleBinding;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/modules/DataBinding/StyleBinding.js\n **/","import { Make } from '../../util/make.js';\nimport Binding from './Binding.js';\nimport { parseExpression } from './Parser.js';\nimport { bindNode } from './Bind.js';\nimport { polyInvoke, getPolyParent } from './Util.js';\n\nlet TemplateRepeatBinding = Make(/** @lends module:DataBinding.TemplateRepeatBinding# */{\n\n    /**\n     * @type {WeakMap}\n     */\n    itemNodeList : null,\n\n    /**\n     * @type {WeakMap}\n     */\n    itemScopeList : null,\n\n    /**\n     * @type {Node}\n     */\n    template : null,\n\n    /**\n     * @type {Node}\n     */\n    marker : null,\n\n    /**\n     * @type {Array}\n     */\n    modelBackup : null,\n\n    /**\n     * @constructs\n     * @extends {Binding}\n     * @return {void}\n     */\n    _make : function(){\n        Binding._make.apply(this);\n\n        this.itemNodeList = new Map();\n        this.itemScopeList = new Map();\n        this.modelBackup = [];\n    },\n\n    /**\n     * renders one model item to the DOM\n     *\n     * @param  {*} model      [description]\n     * @param  {ScopePrototype} scope      [description]\n     * @param  {string} itemName   [description]\n     * @param  {DocumentFragment} fragment   [description]\n     * @param  {Node} polyParent [description]\n     * @param  {Object} item       [description]\n     * @param  {number} index      [description]\n     * @return {void}            [description]\n     */\n    renderItem : function(model, scope, itemName, fragment, polyParent, item, index){\n        let node = null;\n\n        if (this.itemNodeList.has(item)) {\n            node = this.itemNodeList.get(item);\n            let childScope = this.itemScopeList.get(item);\n\n            childScope.$first = index === 0;\n            childScope.$last = model.length -1 === index;\n            childScope.$index = index;\n        } else {\n            let childScope = Make({\n                $first : index === 0,\n                $last : model.length-1 === index,\n                $index : index,\n                __parentScope__ : scope,\n            }, scope).get();\n\n            childScope[itemName] = item;\n\n            node = document.importNode(this.template.content, true).firstElementChild;\n            bindNode(node, childScope, true);\n\n            this.itemNodeList.set(item, node);\n            this.itemScopeList.set(item, childScope);\n        }\n\n        fragment.appendChild(node);\n    },\n\n    update : function(scope){\n        let [itemName, link, expression] = this.originalNodeValue.split(' ');\n        let model = parseExpression(expression, scope);\n        let polyParent = this.template.getAttribute('bind-polymer-parent');\n        let dirty = false;\n\n        if (link !== 'in') {\n            console.console.error('DataBinding: invalide expression', this.originalNodeValue);\n            return;\n        }\n\n        model = model && Array.isArray(model) ? model : [];\n        dirty = this.modelBackup.length !== model.length;\n\n        if (!dirty) {\n            for (let i = 0; i < model.length; i++) {\n                if (model[i] !== this.modelBackup[i]) {\n                    dirty = true;\n                    break;\n                }\n            }\n        }\n\n        if (dirty) {\n            this.modelBackup.forEach(item => {\n                if (model.indexOf(item) < 0) {\n                    if (polyParent) {\n                        polyInvoke(getPolyParent(this.marker, polyParent)).removeChild(this.itemNodeList.get(item));\n                    } else {\n                        polyInvoke(this.marker.parentNode).removeChild(this.itemNodeList.get(item));\n                    }\n\n                    this.itemScopeList.delete(item);\n                    this.itemNodeList.delete(item);\n                }\n            });\n\n            this.modelBackup = model.slice();\n\n            if (window.Polymer) {\n                window.Polymer.dom.flush();\n            }\n\n            /** @type {DocumentFragment} */\n            let fragment = new DocumentFragment();\n\n            model.forEach(this.renderItem.bind(this, model, scope, itemName, fragment, polyParent));\n\n            if (this.marker.nextElementSibling) {\n                if (polyParent) {\n                    polyInvoke(getPolyParent(this.marker, polyParent)).insertBefore(fragment, this.marker.nextElementSibling);\n                } else {\n                    polyInvoke(this.marker.parentNode).insertBefore(fragment, this.marker.nextElementSibling);\n                }\n            } else {\n                if (polyParent) {\n                    polyInvoke(getPolyParent(this.marker, polyParent)).appendChild(fragment);\n                } else {\n                    polyInvoke(this.marker.parentNode).appendChild(fragment);\n                }\n            }\n        }\n    },\n\n    destory : function(){\n        let count = this.modelBackup.reduce((prev, item) => {\n            let [scopes, bindings] = prev;\n            let scope = this.itemScopeList.get(item);\n            let [scopes_add, bindings_add] = scope.__destroy__(true);\n\n            return [scopes + scopes_add, bindings + bindings_add];\n        }, [0, 0]);\n\n        this.itemScopeList = null;\n        this.itemNodeList = null;\n\n        return count;\n    }\n\n}, Binding).get();\n\nexport default TemplateRepeatBinding;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/modules/DataBinding/TemplateRepeatBinding.js\n **/","import { Make } from '../../util/make.js';\nimport { attributeNames } from './Mapping.js';\nimport { parseExpression, assignExpression } from './Parser.js';\nimport { polyInvoke } from './Util.js';\nimport Binding from './Binding.js';\n\n/**\n * @class TwoWayBinding\n * @extends module:DataBinding.Binding\n * @memberof module:DataBinding\n */\n\nlet TwoWayBinding = Make(/** @lends module:DataBinding.TwoWayBinding# */{\n    /**\n     * @type {string}\n     */\n    currentValue : '',\n\n    /**\n     * @type {Node}\n     */\n    parentNode : null,\n\n    /**\n     * @type {boolean}\n     */\n    indirect : false,\n\n    /**\n     * @type {string}\n     */\n    viewBinding : '',\n\n    update : function(scope){\n        let value = parseExpression(this.properties[0], scope);\n        let attribute = attributeNames.rename(this.node.name);\n\n        if (!this.indirect) {\n            polyInvoke(this.parentNode).setAttribute(attribute, value);\n        } else {\n            let oldValue = parseExpression(this.viewBinding, this.parentNode);\n\n            if (value !== oldValue) {\n                assignExpression(this.viewBinding, this.parentNode, value);\n                this.currentValue = value;\n\n                if (document.activeElement === this.parentNode) {\n                    let range = document.createRange();\n                    let selection = window.getSelection();\n                    \n                    range.selectNodeContents(this.parentNode);\n                    range.collapse(false);\n                    selection.removeAllRanges();\n                    selection.addRange(range);\n                }\n            }\n        }\n    }\n}, Binding).get();\n\nexport default TwoWayBinding;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/modules/DataBinding/TwoWayBinding.js\n **/","import { Make } from '../../util/make.js';\nimport NetworkRequest from '../../core/prototypes/NetworkRequest.js';\n//import { polyInvoke } from './Util.js';\n\n\n/*let FakeTemplate = {\n    _markup : '',\n    _fragment: null,\n\n    _make : function(markup) {\n        this._markup = markup;\n    },\n\n    get content() {\n        if (!this._fragment) {\n            this._fragment = new DocumentFragment();\n            let container = document.createElement('div');\n\n            polyInvoke(container).innerHTML = this._markup;\n\n            [].forEach.apply(container.childNodes, [element => {\n                polyInvoke(this._fragment).appendChild(element);\n            }]);\n        }\n        return this._fragment;\n    }\n};*/\n\n/**\n * imports a template node from an external HTML file.\n *\n * @function\n * \n * @param {string} source the url of the file that holds the template to import\n * @param {HTMLTemplateElement} template the template element to contain the import\n *\n * @return {HTMLTemplateElement} returns the provided template node, but now holding the imported nodes.\n */\nexport let importTemplate = function(source, template) {\n    let request = Make(NetworkRequest)(source, {});\n\n    return request.send().then(markup => {\n        template.innerHTML = markup;\n\n        return template;\n    });\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/modules/DataBinding/TemplateLoader.js\n **/","/**\n * @module NetworkRequest\n */\n\n\n/**\n * removes angulars hashKey property from an object\n *\n * @param {Object} object the object to operate on\n *\n * @return {Object} the initial object\n */\nlet stripHashKey = function(object){\n\tif (Array.isArray(object)) {\n\t\tobject = object.map(stripHashKey);\n\n\t} else {\n\t\tobject = JSON.parse(JSON.stringify(object));\n\n\t\tObject.keys(object).forEach(function(key){\n\t\t\tif (key == '$$hashKey') {\n\t\t\t\tdelete object[key];\n\t\t\t}else if (typeof object[key] === 'object' ) {\n\t\t\t\tobject[key] = stripHashKey(object[key]);\n\t\t\t}\n\t\t});\n\t}\n\n\treturn object;\n}\n\n/**\n * @lends module:NetworkRequest.NetworkRequest#\n */\nlet NetworkRequest = {\n    /**\n     * @private\n     * @type {Object}\n     */\n    _body : {},\n\n    /**\n     * @private\n     * @type {Object}\n     */\n\t_headers : null,\n\n    /**\n     * @type {string}\n     */\n\ttype : '',\n\n    /**\n     * @type {string}\n     */\n\tmethod : '',\n\n    /**\n     * @type {string}\n     */\n\turl : '',\n\n    /**\n     * @type {function[]}\n     * @private\n     */\n    _listeners : null,\n\n\t/**\n\t * The constructor for the NetworkRequest. It simply sets up the properties.\n\t *\n\t * @constructs\n\t *\n\t * @param {string} url the url this request should be made to\n\t * @param {Object} config addintional configuartion for the request\n\t *\n\t * @return {NetworkRequest} the request it self\n\t */\n\t_make : function(url, { method = 'GET', type = 'none' } = {}){\n\t\tthis.type = type;\n\t\tthis.method = method;\n        this._headers = {};\n\t\tthis.url = url;\n        this._listeners = [];\n\t},\n\n\t/**\n\t * this method will set the given object as the request body.\n\t *\n\t * @param {Object} data body data for this request\n\t *\n\t * @return {NetworkRequest} the request it self\n\t */\n\tbody : function(data){\n\t\tthis._body = data;\n\n\t\treturn this;\n\t},\n\n\t/**\n\t * This method will set the request headers, in case custom headers are required.\n\t *\n\t * @param {Object} headers a object with all header properties for this request\n\t *\n\t * @return {NetworkRequest} the request it self\n\t */\n\theaders : function(headers) {\n\t\tthis._headers = headers;\n\n\t\treturn this;\n\t},\n\n    /**\n     * Sets a single header for this request.\n     *\n     * @param {string} key the header key\n     * @param {string} value the header value\n     *\n     * @return {NetworkRequest} the request it self\n     */\n    setHeader : function(key, value) {\n        this._headers[key] = value;\n\n        return this;\n    },\n\n    /**\n     * sets a callback for when the request is ready\n     *\n     * @param {function} fn a callback function as soon as the data is ready\n     *\n     * @return {void}\n     */\n    onReady : function(fn){\n        this._listeners.push(fn);\n    },\n\n\t/**\n\t * This will actually create the network connection and initiate the request.\n\t *\n\t * @return {Promise} resolves when the request is done\n\t */\n\tsend : function(){\n\t\tlet self = this;\n\t\tlet xhr = new XMLHttpRequest();\n\n\t\tif (this.method === 'GET' && this._body) {\n\t\t\tthis.url += '?' + Object.keys(this._body).map(function(key){\n\t\t\t\treturn `${key}=${self._body[key]}`;\n\t\t\t}).join('&');\n\t\t}\n\n\t\txhr.open(this.method, this.url, true);\n\n\t\tlet promise = new Promise((success, failure) => {\n\t\t\txhr.onreadystatechange = () => {\n\t\t\t\tif (xhr.readyState === 4) {\n\t\t\t\t\tif (xhr.status === 200) {\n\t\t\t\t\t\tlet response = xhr.response;\n\n\t\t\t\t\t\tif (xhr.getResponseHeader('Content-Type').indexOf('application/json') > -1 && typeof response  === 'string') {\n                            response = JSON.parse(response);\n\t\t\t\t\t\t}\n\n                        this._listeners.forEach(fn => fn(xhr));\n\n\t\t\t\t\t\tsuccess(response);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfailure(xhr);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\n\t\tObject.keys(this._headers).forEach(function(key){\n\t\t\txhr.setRequestHeader(key, self._headers[key]);\n\t\t});\n\n\t\tif (this.type === 'json') {\n            let body = this._body;\n\n\t\t\txhr.setRequestHeader('Content-Type', 'application/json');\n\n            if (body){\n                body = stripHashKey(body);\n                body = JSON.stringify(body);\n            }\n\n\t\t\txhr.send(body);\n\t\t} else {\n\t\t\txhr.send(this._body);\n\t\t}\n\n\t\treturn promise;\n\t}\n};\n\nexport default NetworkRequest;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/core/prototypes/NetworkRequest.js\n **/","/**\n * @module DataBinding/ViewPort\n */\n\nimport { DataBinding } from '../DataBinding.js';\nimport { Make } from '../../util/make.js';\nimport { polyInvoke } from './Util.js';\nimport RenderEngine from './RenderEngine';\n\nconst LIST_HAS_ITEMS = 0;\n\n/** @lends module:DataBinding/ViewPort.ViewPortInstance# */\nlet ViewPortInstance = {\n\n    /**\n     * @private\n     * @type {module:DataBinding.ScopePrototype}\n     */\n    _scope : null,\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    _bound : false,\n\n    /**\n     * @private\n     * @type {module:DataBinding.ScopePrototype}\n     */\n    _innerScope : null,\n\n    /**\n     * @private\n     * @type {HTMLTemplateElement}\n     */\n    _originalTemplate : null,\n\n    /**\n     * @private\n     * @type {Application}\n     */\n    _application : null,\n\n    /**\n     * @constructs\n     *\n     * @param  {module:DataBinding.ScopePrototype} scope    the scope of this viewport instance\n     * @param  {Application} application the application this viewport instance belongs to\n     *\n     * @return {void}\n     */\n    _make : function(scope, application) {\n        this._scope = scope;\n        this._application = application;\n    },\n\n    /**\n     * binds the ViewPort to a scope so it can be filled with content\n     *\n     * @param  {Object} context a collection of properties to configure the viewport\n     *\n     * @return {Promise.<module:DataBinding/ViewPort.ViewPortInstance>}  promise for when the viewport is bound\n     */\n    bind : function(context) {\n        return new Promise((done, error) => {\n            if (!this._bound) {\n                RenderEngine.schedulePostRenderTask(() => {\n                    this._scope.templateUrl = context.template;\n                    this._scope.overflow = '';\n                    this._scope.__apply__();\n\n                    if (!this._originalTemplate) {\n                        this._originalTemplate = this._scope.element.firstElementChild;\n                    }\n\n                    this._innerScope = DataBinding.makeTemplate(\n                        this._originalTemplate,\n                        context.scope || {},\n                        this._application,\n                        this._scope\n                    );\n\n                    this._bound = true;\n\n                    context.scope = this._innerScope;\n\n                    done(this);\n                });\n            } else {\n                error('ViewPort: viewport is already bound!');\n            }\n        });\n    },\n\n    /**\n     * updates the inner scope of the viewport\n     *\n     * @param  {...*} args arguments to be passed on to {@link module:DataBinding.ScopePrototype#__apply__}\n     *\n     * @return {void}\n     */\n    update : function(...args) {\n        return this._innerScope.__apply__(...args);\n    },\n\n    /**\n     * the scope if ViewPort content\n     *\n     * @type {module:DataBinding.ScopePrototype}\n     */\n    get scope() {\n        return this._innerScope;\n    },\n\n    destory : function(){\n        if (this._bound) {\n            this._innerScope.__destroy__();\n\n            while (this._scope.element.children.length > LIST_HAS_ITEMS) {\n                polyInvoke(this._scope.element).removeChild(this._scope.element.firstChild);\n            }\n\n            polyInvoke(this._scope.element).appendChild(this._originalTemplate);\n            this._bound = false;\n            this._originalTemplate.processed = false;\n        }\n    },\n\n    /**\n     * enables the viewport content to overflow the viewports bounds\n     *\n     * @return {void}\n     */\n    alowOverflow : function() {\n        this._scope.overflow = 'overflow';\n        this._scope.__apply__();\n    },\n};\n\n/**\n * the interface for the ViewPort module\n *\n * @namespace\n * @static\n */\nlet ViewPort = {\n\n    /**\n     * all instanciated ViewPorts\n     *\n     * @private\n     * @type {Map.<module:DataBinding.ScopePrototype>}\n     */\n    _elements : new Map(),\n\n    /**\n     * the applicaion the viewports are registered to\n     *\n     * @private\n     * @type {Application}\n     */\n    _application : null,\n\n    /**\n     * @constructs\n     * @param {Application} application - the application this viewport belongs to.\n     * @return {void}\n     */\n    _make : function(application){\n        let style = polyInvoke(document.head).appendChild(document.createElement('style'));\n        let template = document.createElement('template');\n\n        polyInvoke(style).innerHTML = `\n            .view-port {\n                position: relative;\n                left: 0;\n                top: 0;\n                height: 100%;\n                width: 100%;\n                display: flex;\n                flex-direction: column;\n                overflow: auto;\n            }\n\n            .view-port.overflow {\n                overflow: visible;\n            }\n        `;\n\n        template.id = 'view-port';\n        polyInvoke(template).setAttribute('bind-element', '');\n        polyInvoke(template).setAttribute('component', '');\n\n        polyInvoke(template).innerHTML = `\n            <div class=\"custom-element {{overflow}}\">\n                <template src=\"templateUrl\" replace></template>\n            </div>\n        `;\n\n        application.on('newElement:view-port', (scope) => {\n            this._elements[scope.name] = Make(ViewPortInstance)(scope, application);\n            application.emit(`viewPort:ready:${scope.name}`);\n        });\n\n        this._application = application;\n\n        DataBinding.makeTemplate(template, () => { return {} }, application);\n    },\n\n    /**\n     * fetches a viewPort instance by a name\n     *\n     * @param  {string} name the name to look for\n     *\n     * @return {Promise.<module:DataBinding.ScopePrototype>}  the matching scope\n     */\n    getInstance : function(name){\n        return new Promise((success) => {\n            if (this._elements[name]) {\n                success(this._elements[name]);\n            } else {\n                this._application.on(`viewPort:ready:${name}`, () => success(this._elements[name]));\n            }\n        });\n    },\n\n    /**\n     * destorys an viewPort instance\n     *\n     * @param  {module:DataBinding/ViewPort.ViewPortInstance} instance the instance to destroy\n     *\n     * @return {void}\n     */\n    free : function(instance){\n        this._elements[instance._scope.name] = null;\n\n        instance._scope.__destroy__();\n    }\n};\n\nexport default ViewPort;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/modules/DataBinding/ViewPort.js\n **/","import { Make } from '../../util/make.js';\nimport { parseExpression } from './Parser.js';\nimport Binding from './Binding.js';\nimport BindingRegistry from './BindingRegistry.js';\n\nlet IfBinding = Make(/** @lends module:DataBinding.IfBinding# **/{\n\n    /** @type {string} */\n    name: 'bind-if',\n\n    /**\n     * @type {Node}\n     */\n    parentNode: null,\n\n    /**\n     * @type {Node}\n     */\n    node: null,\n\n    /**\n     * @type {Node}\n     */\n    nextSibling: null,\n\n    /**\n     *\n     * @constructs\n     * @extends {Binding}\n     * @param {Node} parentNode - this node\n     * @param {string} text - the attribute value\n     * @param {ScopeInfo} scopeInfo - bindings container\n     *\n     * @return {void}\n     */\n    _make: function({ parentNode, text, scopeInfo }) {\n        this.node = parentNode;\n        this.parentNode = this.node.parentNode;\n        this.text = text;\n        this.nextSibling = parentNode.nextSibling;\n\n        scopeInfo.bindings.push(this);\n    },\n\n    update: function(scope) {\n        let isTrue = parseExpression(this.text, scope);\n\n        if (isTrue) {\n            if (this.node.parentNode !== this.parentNode)　{\n                if (this.nextSibling) {\n                    this.parentNode.insertBefore(this.node, this.nextSibling);\n                } else {\n                    this.parentNode.appendChild(this.node);\n                }\n            }\n        } else {\n            if (this.node.parentNode === this.parentNode) {\n                this.parentNode.removeChild(this.node);\n            }\n        }\n    },\n\n}, Binding).get();\n\nBindingRegistry.register(IfBinding);\n\nexport default IfBinding;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/modules/DataBinding/IfBinding.js\n **/","import { Make } from '../../util/make';\nimport { assignExpression, parseExpression } from './Parser';\nimport Binding from './Binding';\nimport BindingRegistry from './BindingRegistry.js';\n\nlet ElementToScopeBinding = Make(/** @lends module:DataBinding.ElementToScopeBinding.prototype */{\n\n    /**\n     * @type {string}\n     */\n    name: 'scope-id',\n\n    /**\n     * @type {Node}\n     */\n    parentNode: null,\n\n    /**\n     * @constructs\n     * @extends {module:DataBinding.Binding}\n     *\n     * @param  {Node} parentNode   parent node of this binding\n     * @param  {Object} scopeInfo  scope metadata object\n     * @param  {string} text       original text value of the binding\n     *\n     * @return {void}\n     */\n    _make: function({ parentNode, scopeInfo, text }) {\n        Binding._make.apply(this);\n\n        this.parentNode = parentNode;\n        this.text = text;\n\n        scopeInfo.bindings.push(this);\n\n    },\n\n    update: function(scope) {\n        /** @type {Node} */\n        let currentValue = parseExpression(this.text, scope);\n\n        if (currentValue !== this.parentNode) {\n            assignExpression(this.text, scope, this.parentNode);\n            scope.__apply__(null, true);\n        }\n    },\n\n}, Binding).get();\n\nBindingRegistry.register(ElementToScopeBinding);\n\nexport default ElementToScopeBinding;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/modules/DataBinding/ElementToScopeBinding.js\n **/","import { Make } from '../../util/make.js';\nimport { ObjectParser, parseExpression } from './Parser.js';\nimport Binding from './Binding.js';\nimport BindingRegistry from './BindingRegistry.js';\n\nconst AttributeBinding = Make({\n\n    name: 'bind-attr',\n\n    config: null,\n\n    _make: function({ parentNode, scopeInfo, text }) {\n        Binding._make.apply(this);\n\n        this.parentNode = parentNode;\n        this.config = ObjectParser(text);\n\n        scopeInfo.bindings.push(this);\n    },\n\n    update: function(scope) {\n        let attrName = this.config.name;\n        let attrValue = this.config.value ? parseExpression(this.config.value, scope) : '';\n        let attrEnabled = this.config.enabled ? parseExpression(this.config.enabled, scope) : true;\n\n\n        if (attrEnabled) {\n            this.parentNode.setAttribute(attrName, attrValue);\n        } else {\n            this.parentNode.removeAttribute(attrName);\n        }\n    }\n\n}, Binding).get();\n\nBindingRegistry.register(AttributeBinding);\n\nexport default AttributeBinding;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/modules/DataBinding/AttributeBinding.js\n **/","import DataBinding from '../af/modules/DataBinding.js';\n\n/** @lends Header# */\nlet Header = {\n    view: null,\n\n    /** @type {application} */\n    application: null,\n\n    get notConnected() {\n        /** @type {Socket} */\n        let socket = this.application.socket;\n\n        return !socket.isOnline || !socket.isConnected;\n    },\n\n    get connected() {\n        let socket = this.application.socket;\n\n        return socket.isOnline && socket.isConnected;\n    },\n\n    get connectionStatus() {\n        let socket = this.application.socket;\n\n        if (!socket.isOnline) {\n            return 'offline';\n        } else if (!socket.isConnected && socket.isConnecting) {\n            return 'connecting...';\n        } else {\n            return 'diconnected';\n        }\n    },\n\n    _make: function(application) {\n        this.application = application;\n\n        let scope = DataBinding.makeTemplate('#header-status', {\n            view: this,\n        }).scope;\n\n        this.application.socket.onStatusChange(scope.__apply__.bind(scope, null, true));\n    }\n}\n\nexport default Header;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/Header.js\n **/","import DataBinding from '../af/modules/DataBinding.js';\n\nconst LoginDialog = {\n\n    /** @type module:DataBinding.ScopePrototype */\n    _scope: null,\n    _account: null,\n\n    get active() {\n        return this._account.busy;\n    },\n\n    /**\n     * [userNameField description]\n     *\n     * @type {HTMLInputElement}\n     */\n    userNameField: null,\n\n    /**\n     * [passwordField description]\n     *\n     * @type {HTMLInputElement}\n     */\n    passwordField: null,\n\n    username: '',\n    password: '',\n\n    usernameError: '',\n    passwordError: '',\n\n    get isOpen() {\n        return (!this._account.credentialsReady || this.active);\n    },\n\n    get isNotActive() {\n        return !this.active;\n    },\n\n    get isValid() {\n        return this.usernameField.validate() && this.passwordField.validate();\n    },\n\n    _make: function(account) {\n        this._scope = DataBinding.makeTemplate('#login-dialog', { view: this }).scope;\n        this._account = account;\n\n        this._account.on('statusChange', this._scope.__apply__.bind(this._scope));\n    },\n\n    login: function() {\n        if (this.view.isValid) {\n            this.view._account.authenticate(this.view.username, this.view.password);\n        }\n    },\n\n    getErrorMessage(element, error) {\n        element = element.querySelector('input');\n\n        return element.validationMessage || error;\n    },\n\n    preventDefault: function(event) {\n        event.preventDefault();\n    }\n\n};\n\nexport default LoginDialog;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/LoginDialog.js\n **/","import DataBinding from '../af/modules/DataBinding.js';\n\nlet MessageList = {\n\n    currentMessages: [\n        {\n            type: 'out',\n            content: 'hey mein Schatz wo bist du?',\n            timestamp: '1473194720625',\n        },\n        {\n            type: 'out',\n            content: 'hey 😞😔😕',\n            timestamp: '1473194783059',\n        },\n        {\n            type: 'in',\n            content: 'was',\n            timestamp: '1473194821597',\n        },\n        {\n            type: 'in',\n            content: 'was',\n            timestamp: '1473194821597',\n        },\n        {\n            type: 'in',\n            content: 'was',\n            timestamp: '1473194821597',\n        }\n    ],\n\n    _make: function() {\n        DataBinding.makeTemplate('#message-list', { view: this });\n    }\n};\n\nexport default MessageList;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/MessageList.js\n **/","import { Make } from '../af/util/make.js';\n\nlet PushManager = Make(/** @lends PushManager */{\n\n    platform: '',\n\n    serviceStatus: '',\n\n    _newPushHandler: null,\n    _registerHandler: null,\n\n    /**\n     * [_handleServiceError description]\n     *\n     * @callback\n     * @param  {Object} data [description]\n     *\n     * @return {void}      [description]\n     */\n    _handleServiceError: function(data) {\n        this.serviceStatus = 'init failed';\n        console.console.error('push service failed:', data);\n    },\n\n    _baiduHandleServiceReady: function(data) {\n        this._register(data.clientId);\n\n        this.serviceStatus = 'OK';\n        console.log('baidu push is ready', data);\n    },\n\n    _handleMessageError: function(data) {\n        console.error('push message error:', data);\n    },\n\n    _make: function() {\n        if (!!window.cordova && window.cordova.platformId === 'android') {\n            this.platform = 'android';\n        } else if (!!navigator.push) {\n            this.platform = 'firefoxos';\n        }\n\n        this._newPushHandler = [];\n        this._registerHandler = [];\n    },\n\n    _newMessage: function() {\n        this._newPushHandler.forEach(fn => fn());\n    },\n\n    _register: function(token) {\n        this._registerHandler.forEach(fn => fn(token));\n    },\n\n    _registerServiceSimple: function(force) {\n        navigator.push.registrations().onsuccess = function(e) {\n            if (e.target.result.length === 0 && force) {\n                e.target.result.forEach(enpoint => navigator.push.unregister(enpoint));\n\n                let request = navigator.push.register();\n                request.onsuccess = this._simpleHandleServiceReady;\n                request.onerror = this._handleServiceError;\n            }\n        };\n    },\n\n    init: function() {\n        if (this.platform === 'android') {\n            window.baiduPush.startWork('KGQvyGtzWRG6X48cSAwf5Mxk', this._baiduHandleServiceReady.bind(this), this._handleServiceError.bind(this));\n            window.baiduPush.onNotificationArrived(this._newMessage.bind(this), this._handleMessageError.bind(this));\n        } else if (this.platform === 'firefoxos') {\n            this._registerServiceSimple();\n            navigator.mozSetMessageHandler('push', this._newMessage.bind(this));\n            navigator.mozSetMessageHandler('push-register', () => this._registerServiceSimple(true));\n        }\n    },\n\n    onPush: function(fn) {\n        this._newPusHandler.push(fn);\n    },\n\n    onRegister: function(fn) {\n        this._registerHandler.push(fn);\n    },\n\n    setRegistrationFailed: function() {\n        this.serviceStatus = 'unable to register push service';\n    }\n})();\n\nexport default PushManager;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/PushManager.js\n **/","import { Make } from '../af/util/make.js';\n\nlet ScreenManager = Make(/** @lends ScreenManager */{\n\n    applicationIsActive: false,\n\n    _make: function() {\n        this.applicationIsActive = !document.hidden;\n\n        document.addEventListener('visibilitychange', () => {\n            this.applicationIsActive = !document.hidden;\n\n            console.log('application is ', this.applicationIsActive ? 'active' : 'inactive', 'now');\n        });\n\n        document.addEventListener('resume', (e) => {\n            console.log('application has resumed', e);\n        });\n    }\n})();\n\nexport default ScreenManager;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/ScreenManager.js\n **/","import * as uuid from '../af/modules/uuid.js';\n\n\nlet Socket = {\n\n    _host: '',\n    _hostId: 0,\n\n    /** @type {WebSocket} */\n    _websocket: null,\n    _online: false,\n    _connected: false,\n    _connecting: false,\n    _stop: false,\n    _onStatusChange: null,\n\n    _decelerate: null,\n    _decelerateTimeout: 0,\n    _decelerateMaxTimeout: 30,\n\n    get isConnected() {\n        return this._connected;\n    },\n\n    set isConnected(value) {\n        this._connected = value;\n        this._statusChange();\n    },\n\n    get isConnecting() {\n        return this._connecting;\n    },\n\n    set isConnecting(value) {\n        this._connecting = value;\n        this._statusChange();\n    },\n\n\n    get isOnline() {\n        return this._online;\n    },\n\n    set isOnline(value) {\n        this._online = value;\n        this._statusChange();\n    },\n\n    _make: function({ host }) {\n        this._host = host;\n        this._onceQueue = {};\n        this._listeners = {};\n        this._onStatusChange = [];\n        this._connectedHandler = [];\n\n        this.isOnline = navigator.onLine;\n\n        window.addEventListener('online', () => {\n            this.isOnline = navigator.onLine;\n            console.log('Socket: online');\n            this.init();\n        });\n\n        window.addEventListener('offline', () => {\n            this.isOnline = navigator.onLine;\n            console.log('Socket: offline');\n            this.reconnect();\n        })\n    },\n\n    _ack: function(messageId) {\n        this._websocket.send(JSON.stringify({\n            type: `ack:${messageId}`,\n            id: uuid.v5('0', window.performance.now()),\n        }));\n    },\n\n    _onMessage: function(message) {\n        message = JSON.parse(message.data);\n        console.log('Socket: new message received', message.type);\n\n        if (message.type.search('ack') < 0) {\n            this._ack(message.id);\n        }\n\n        if (this._onceQueue[message.type]) {\n            this._onceQueue[message.type].forEach(fn => fn(message));\n            this._onceQueue[message.type] = [];\n        }\n\n        if (this._listeners[message.type]) {\n            this._listeners.forEach(fn => fn(message));\n        }\n    },\n\n    _statusChange: function() {\n        this._onStatusChange.forEach(fn => fn());\n    },\n\n    _onceQueue: null,\n    _listeners: null,\n    _connectedHandler: null,\n\n    sendMessage: function(type, message) {\n        let data = {\n            id: uuid.v5('0', window.performance.now()),\n            data: message,\n            type: type,\n        };\n\n        let promise = new Promise((success, failure) => {\n        /**    let timeoutId = setTimeout(() => {\n                console.warn('Socket: connection timed out! dropping connection!');\n                this.reconnect();\n                failure();\n            }, 10000); */\n\n/**            this.once(`ack:${data.id}`, () => {\n                clearTimeout(timeoutId);\n            });*/\n\n            this.once(`response:${data.id}`, message => {\n                success(message);\n            });\n        });\n\n        promise.catch(() => this.reconnect());\n\n        console.log('Socket: message sent', data.id);\n        this._websocket.send(JSON.stringify(data));\n\n        return promise;\n    },\n\n    reconnect: function() {\n        if (this.isConnected) {\n            this._websocket.close();\n        }\n    },\n\n    init: function() {\n        if (this.isOnline && !this.decelerate && !this._stop) {\n\n            this.isConnecting = true;\n            this._decelerate = setTimeout(() => {\n                console.log('trying to establish a connection...');\n                this._decelerate = null;\n                this._websocket = new WebSocket(`ws://${this._host[this._hostId]}`);\n\n                this._websocket.onopen = () => {\n                    this.isConnected = true;\n                    this.isConnecting = false;\n                    this._decelerateTimeout = 0;\n                    console.log('connection established!');\n\n                    this._connectedHandler.forEach(fn => fn());\n                }\n\n                this._websocket.onerror = function(error) {\n                    console.error('websocket error:', error);\n                    this.isConnecting = false;\n                }\n\n                this._websocket.onclose = () => {\n                    // socket closed restart\n                    this._hostId += 1;\n                    this._decelerateTimeout += 1;\n\n                    if (this._hostId > this._host.length - 1) {\n                        this._hostId = 0;\n                    }\n\n                    if (this._decelerateTimeout > this._decelerateMaxTimeout) {\n                        this._decelerateTimeout = this._decelerateMaxTimeout;\n                    }\n\n                    console.warn(`websocket disconnected! Retry in ${this._decelerateTimeout}s to ${this._host[this._hostId]}`);\n                    this.isConnected = false;\n                    this.init();\n                }\n\n                this._websocket.onmessage = this._onMessage.bind(this);\n            }, this._decelerateTimeout * 1000);\n        }\n\n        this._stop = false;\n    },\n\n    once: function(type, fn) {\n        if (!this._onceQueue[type]) {\n            this._onceQueue[type] = [];\n        }\n\n        this._onceQueue[type].push(fn);\n    },\n\n    on: function(type, fn) {\n        if (!this._listeners[type]) {\n            this._listeners[type] = [];\n        }\n\n        this._listeners[type].push(fn);\n    },\n\n    onStatusChange: function(fn) {\n        this._onStatusChange.push(fn);\n    },\n\n    /**\n     * [connected description]\n     *\n     * @param  {Function} fn [description]\n     *\n     * @return {void}      [description]\n     */\n    connected: function(fn) {\n        this._connectedHandler.push(fn);\n    },\n\n    disconnect: function() {\n        this._stop = true;\n        this._websocket.close();\n    }\n};\n\nexport default Socket;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/Socket.js\n **/","import { Make } from '../util/make.js';\nimport sha1 from './sha-1.js';\n\n/**\n * @module Uuid\n */\n\nconst UUID_SIZE = 16; // 16 byte / 128 bit\n\n/** @lends module:Uuid~ReadBytesOfHexString# */\nlet ReadBytesOfHexString = {\n\n    /**\n     * the remaining hex string data\n     *\n     * @type {string}\n     */\n    _value: null,\n\n    /**\n     * [_make description]\n     *\n     * @constructs\n     *\n     * @param  {string} value a hex string\n     *\n     * @return {void}\n     */\n    _make: function(value) {\n        this._value = value;\n    },\n\n    /**\n     * reads the lowest byte from the hex string, expecting bigendian notation.\n     *\n     * @return {number} uint8\n     */\n    readByte: function() {\n        let byte = parseInt(this._value.substring(this._value.length - 2), 16);\n        this._value = this._value.substring(0, this._value.length - 2);\n\n        return byte >>> 0;\n    }\n}\n\nlet hex8Bit = function(value) {\n    while(value.length * 4 < 8) {\n        value = '0' + value;\n    }\n\n    return value;\n}\n\nlet hex16Bit = function(value) {\n    while(value.length * 4 < 16) {\n        value = '0' + value;\n    }\n\n    return value;\n}\n\nlet hex32Bit = function(value) {\n    while(value.length * 4 < 32) {\n        value = '0' + value;\n    }\n\n    return value;\n}\n\nlet hex48Bit = function(value) {\n    while(value.length * 4 < 32) {\n        value = '0' + value;\n    }\n\n    return value;\n}\n\n\nexport let parse = function(uuid) {\n    let index = 0;\n    let buffer = new Uint8Array(UUID_SIZE);\n    let [time_low, time_mid, time_hi_and_version, clock_seq, node] = uuid.split('-');\n\n    let pushToBuffer = function(byte) {\n        buffer[index++] = parseInt(byte, 16);\n    }\n\n    hex32Bit(time_low || '').match(/.{1,2}/g).reverse().forEach(pushToBuffer);\n    hex16Bit(time_mid || '').match(/.{1,2}/g).reverse().forEach(pushToBuffer);\n    hex16Bit(time_hi_and_version || '').match(/.{1,2}/g).reverse().forEach(pushToBuffer);\n    hex16Bit(clock_seq || '').match(/.{1,2}/g).reverse().forEach(pushToBuffer);\n    hex48Bit(node || '').match(/.{1,2}/g).reverse().forEach(pushToBuffer);\n\n    return buffer.buffer;\n}\n\n/**\n * [v5 description]\n *\n * @param  {string} namespace the name space of the new uuid\n * @param  {string} name      the name of the resource of this uuid\n *\n * @return {string}           uuid string\n */\nexport let v5 = function(namespace, name) {\n    let nameValue = new ArrayBuffer(name.length);\n    let namespaceValue = parse(namespace);\n    let completeValue = new Uint8Array(nameValue.byteLength + namespaceValue.byteLength);\n    let uuidBuffer = new Uint8Array(UUID_SIZE);\n    let view = null;\n    let hash = null;\n\n    view = new Uint8Array(nameValue);\n\n    for (let i = 0; i < name.length; i++) {\n        view[i] = name.charCodeAt(i);\n    }\n\n    completeValue.set(new Uint8Array(namespaceValue), 0);\n    completeValue.set(new Uint8Array(nameValue), namespaceValue.byteLength);\n\n    hash = sha1(completeValue.buffer);\n    hash = Make(ReadBytesOfHexString)(hash);\n\n    //time_low (0 - 3)\n    for (let i = 0; i < 4; i++) {\n        uuidBuffer[i] = hash.readByte();\n    }\n\n    // time_mid (4 - 5)\n    for (let i = 4; i < 6; i++) {\n        uuidBuffer[i] = hash.readByte();\n    }\n\n    // time_hi_and_version (6 - 7)\n    for (let i = 6; i < 8; i++) {\n        uuidBuffer[i] = hash.readByte();\n    }\n\n    uuidBuffer[7] = (uuidBuffer[7] & 0x0F) | 0x50;\n\n    // clock_seq_hi_and_reserved (8)\n    uuidBuffer[8] = (hash.readByte() & 0x3F) | 0x80;\n\n    // clock_seq_low (9)\n    uuidBuffer[9] = hash.readByte();\n\n    // node (10 - 15)\n    for (let i = 10; i < 16; i++) {\n        uuidBuffer[i] = hash.readByte();\n    }\n\n    let time_low = hex8Bit(uuidBuffer[3].toString(16)) + hex8Bit(uuidBuffer[2].toString(16)) +\n                   hex8Bit(uuidBuffer[1].toString(16)) + hex8Bit(uuidBuffer[0].toString(16));\n    let time_mid = hex8Bit(uuidBuffer[5].toString(16)) + hex8Bit(uuidBuffer[4].toString(16));\n    let time_hi_and_version = hex8Bit(uuidBuffer[7].toString(16)) + hex8Bit(uuidBuffer[6].toString(16));\n    let clock_seq_hi_and_reserved = hex8Bit(uuidBuffer[8].toString(16));\n    let clock_seq_low = hex8Bit(uuidBuffer[9].toString(16));\n    let node = hex8Bit(uuidBuffer[15].toString(16)) + hex8Bit(uuidBuffer[14].toString(16)) +\n               hex8Bit(uuidBuffer[13].toString(16)) + hex8Bit(uuidBuffer[12].toString(16)) +\n               hex8Bit(uuidBuffer[11].toString(16)) + hex8Bit(uuidBuffer[10].toString(16));\n\n    return `${time_low}-${time_mid}-${time_hi_and_version}-${clock_seq_hi_and_reserved}${clock_seq_low}-${node}`;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/modules/uuid.js\n **/","\n/**\n * casts any number to an unsigned 32-bit integer\n *\n * @param  {number} value any numeric value\n *\n * @return {number}       an int32 number\n */\nlet uint32 = function(value) {\n    //cast to integer\n    value = value | 0;\n\n    //make value unsigned\n    value = value >>> 0;\n\n    //limit to 32 bit\n    value = value % Math.pow(2, 32);\n\n    return value;\n}\n\n/**\n * rotates the bits of an uint32 value to the left.\n *\n * @param  {number} value should be uint to prevent unwanted side effects\n * @param  {number} amount the amount of bits to shift <= 32\n *\n * @return {number}       the rotated value already casted to uint32\n */\nlet leftRotateBits = function(value, amount) {\n    value = (value << amount) | (value >>> 32 - amount);\n    value = uint32(value);\n\n    return value;\n}\n\n/**\n * makes sure a hex value is 32-bit long.\n *\n * @param  {string} value a hex string\n *\n * @return {string}       a hex string which is definetely 32-bit long\n */\nlet hex32Bit = function(value) {\n    while (value.length * 4 < 32) {\n        value = '0' + value;\n    }\n\n    return value;\n}\n\n/**\n * makes sure a hex value is 32-bit long.\n *\n * @param  {string} value a hex string\n *\n * @return {string}       a hex string which is definetely 32-bit long\n */\nlet hex64Bit = function(value) {\n    while (value.length * 4 < 64) {\n        value = '0' + value;\n    }\n\n    return value;\n}\n\n/**\n * creates a new array buffer from the utf-8 encoded string.\n *\n * @param  {string} value the original value\n *\n * @return {ArrayBuffer}       the encoded value\n */\nlet stringToBuffer = function(value) {\n    // make sure every character is only 8 bit long\n    value = unescape(encodeURIComponent(value));\n\n    let bufferView = new Uint8Array(value.length);\n\n    // push message into buffer\n    for (let i = 0; i < value.length; i++) {\n        bufferView[i] = value.charCodeAt(i);\n    }\n\n    return bufferView.buffer;\n}\n\n/**\n * the sha-1 algorithm.\n *\n * @param  {(ArrayBuffer|string)} message the message to hash\n *\n * @return {string}         the hex representation of the hash value\n */\nlet sha1 = function(message) {\n\n    if (typeof message === 'string') {\n        message = stringToBuffer(message);\n    }\n\n    // initial values\n    let h0 = 0x67452301;\n    let h1 = 0xEFCDAB89;\n    let h2 = 0x98BADCFE;\n    let h3 = 0x10325476;\n    let h4  = 0xC3D2E1F0;\n\n    let messageLength = message.byteLength;\n    let bufferSize = 0;\n    let buffer = null;\n    let view = null;\n\n    // calculate buffer size. First in bit and then convert to byte.\n    bufferSize = (messageLength + 1) * 8;\n    bufferSize = bufferSize + (448 - (bufferSize % 512)) + 64;\n    bufferSize = bufferSize / 8;\n    buffer = new ArrayBuffer(bufferSize);\n    view = new Uint8Array(buffer);\n\n    //apply data to our local buffer\n    view.set(new Uint8Array(message), 0);\n\n    // append the 1 bit. No idea why this is not just a single bit.\n    view[messageLength] = 0x80;\n\n\n    //reorder bytes\n    for(let i = 0; i < messageLength + 1; i+= 4) {\n        let temp = 0;\n\n        temp = view[i];\n        view[i] = view[i+3];\n        view[i+3] = temp;\n\n        temp = view[i+1];\n        view[i+1] = view[i+2];\n        view[i+2] = temp;\n    }\n\n    //append the message length\n    view = new Uint32Array(buffer);\n    let length = hex64Bit((messageLength * 8).toString(16));\n    view[view.length - 2] = parseInt(length.substring(0, length.length - 8), 16);\n    view[view.length - 1] = parseInt(length.substring(length.length - 8), 16);\n\n    // process each chunk\n    for (let i = 0; i < bufferSize / (512 / 8); i++) {\n        let a = h0;\n        let b = h1;\n        let c = h2;\n        let d = h3;\n        let e = h4;\n        let temp = 0;\n\n        view = new Uint32Array(80);\n        view.set(new Uint32Array(buffer.slice(i * 512, (i + 1 ) * 512)), 0);\n\n        for (let i = 16; i < 80; i++) {\n            view[i] = leftRotateBits(view[i - 3] ^ view[i - 8] ^ view[i - 14] ^ view[i - 16], 1);\n        }\n\n        for (let i = 0; i < 80; i++) {\n            let f = null;\n            let k = null;\n\n            if (i > -1 && i < 20) {\n                f = uint32((b & c) ^ (~b & d))\n                k = 0x5A827999;\n            } else if (i > 19 && i < 40) {\n                f = uint32(b ^ c ^ d);\n                k = 0x6ED9EBA1;\n            } else if (i > 39 && i < 60) {\n                f = uint32((b & c) ^ (b & d) ^ (c & d));\n                k = 0x8F1BBCDC;\n            } else if (i > 59 && i < 80) {\n                f = uint32(b ^ c ^ d);\n                k = 0xCA62C1D6;\n            }\n\n            temp = uint32(leftRotateBits(a, 5) + f + e + k + view[i]);\n            e = uint32(d);\n            d = uint32(c);\n            c = leftRotateBits(b, 30);\n            b = uint32(a)\n            a = uint32(temp);\n        }\n\n        h0 = uint32(h0 + a);\n        h1 = uint32(h1 + b);\n        h2 = uint32(h2 + c);\n        h3 = uint32(h3 + d);\n        h4 = uint32(h4 + e);\n    }\n\n    return hex32Bit(h0.toString(16)) + hex32Bit(h1.toString(16)) + hex32Bit(h2.toString(16)) + hex32Bit(h3.toString(16)) + hex32Bit(h4.toString(16));\n}\n\nexport default sha1;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/modules/sha-1.js\n **/"],"sourceRoot":""}