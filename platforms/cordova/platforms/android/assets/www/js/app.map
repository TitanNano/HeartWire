{"version":3,"sources":["webpack:///webpack/bootstrap 838fbf67138b176172d2","webpack:///./src/js/bootstrap.js","webpack:///./src/js/main.js","webpack:///./src/af/util/make.js","webpack:///./src/af/core/prototypes/Application.js","webpack:///./src/af/core/prototypes/Thread.js","webpack:///./src/af/core/objects/Shared.js","webpack:///./src/af/core/prototypes/ApplicationInternal.js","webpack:///./src/js/BottomInput.js","webpack:///./src/af/modules/DataBinding.js","webpack:///./src/af/modules/DataBinding/Template.js","webpack:///./src/af/modules/DataBinding/Bind.js","webpack:///./src/af/modules/DataBinding/Parser.js","webpack:///./src/af/modules/DataBinding/Mapping.js","webpack:///./src/af/modules/DataBinding/Util.js","webpack:///./src/af/modules/DataBinding/AutoBinding.js","webpack:///./src/af/modules/DataBinding/Binding.js","webpack:///./src/af/modules/DataBinding/BindingRegistry.js","webpack:///./src/af/modules/DataBinding/ClassBinding.js","webpack:///./src/af/modules/DataBinding/RenderEngine.js","webpack:///./src/af/modules/DataBinding/RenderEngine/TaskList.js","webpack:///./src/af/modules/DataBinding/EnabledBinding.js","webpack:///./src/af/modules/DataBinding/ScopePrototype.js","webpack:///./src/af/modules/DataBinding/StyleBinding.js","webpack:///./src/af/modules/DataBinding/TemplateRepeatBinding.js","webpack:///./src/af/modules/DataBinding/TwoWayBinding.js","webpack:///./src/af/modules/DataBinding/TemplateLoader.js","webpack:///./src/af/core/prototypes/NetworkRequest.js","webpack:///./src/af/modules/DataBinding/ViewPort.js","webpack:///./src/af/modules/DataBinding/IfBinding.js","webpack:///./src/af/modules/DataBinding/ElementToScopeBinding.js","webpack:///./src/js/Header.js","webpack:///./src/js/MessageList.js","webpack:///./src/js/PushManager.js","webpack:///./src/js/ScreenManager.js","webpack:///./src/js/Socket.js"],"names":["onDeviceReady","init","deviceReady","Promise","ready","window","cordova","document","addEventListener","readyState","polymerReady","Polymer","ImportStatus","_ready","whenReady","all","then","application","name","pushManager","socket","headerController","bottomInputController","messageListController","_make","host","sreeenManager","apply","target","source","Object","keys","forEach","key","defineProperty","getOwnPropertyDescriptor","Make","object","prototype","arguments","length","create","m","make","args","get","hasPrototype","p","getPrototypeOf","undefined","Mixin","prototypes","Proxy","MixinTrap","findProperty","i","item","bind","value","Internal","WeakMap","Application","version","author","set","console","log","on","type","listener","scope","listeners","push","removeListener","index","indexOf","splice","emit","data","setTimeout","f","thread","workers","terminate","reason","Thread","parent","_thread","_promise","catch","Worker","threadLoader","postMessage","func","progressListeners","done","e","ApplicationInternal","modules","BottomInput","currentDraft","inputValue","inputFocused","inputElement","getAttribute","usePlaceholderClass","inputFocusChange","event","cancleRecycle","view","__apply__","makeTemplate","NodeList","NamedNodeMap","Array","style","createElement","innerHTML","head","appendChild","DataBinding","bindNode","ViewPort","makeElementFromTemplate","template","schedulePostRenderTask","node","importNode","content","placeholder","querySelector","attributes","firstElementChild","setAttribute","attr","parentNode","replaceChild","children","className","id","map","search","replace","hasAttribute","element","parentScope","processed","makeElement","list","querySelectorAll","MutationObserver","mutations","addedNodes","slice","reduce","prev","next","concat","filter","localName","observe","body","childList","subtree","isReplace","isInsert","elementList","childNodes","__cleanElements__","removeChild","parentName","insertBefore","scopeList","Map","scopeIndex","watcherList","expressionTracking","isolated","Node","bindings","checkNode","recycle","dataRegex","scopeInfo","nodeName","nodeType","text","textContent","variables","match","visibilityBinding","transparencyBinding","enabledAttribute","classes","modelBinding","autoBinding","twoWay","styleBinding","singleBinding","bindTwoWay","bindClasses","bindEnabled","bindAuto","bindStyle","test","bindSimple","repeatedTemplate","child","bindTemplateRepeat","events","bindEvents","removeAttribute","indirect","property","split","viewBinding","eventBinding","preventDefault","binding","properties","originalNodeValue","currentValue","compareTwoWay","getElementValue","newValue","singleExpression","marker","createComment","method","$methods","trim","canceled","scopeName","executeWatchers","watcher","expression","cb","scheduleRenderTask","t0","performance","now","update","expr","t1","duration","color","toFixed","destoryScope","inProgress","scopes","destory","scopes_add","bindings_add","delete","ObjectParser","keyBuffer","valueBuffer","run","char","parseExpression","chain","pos","scopeChild","substring","assignExpression","attributeNames","visible","transparent","prefix","enabled","model","modelEvent","rename","selectElement","query","context","polyMask","selectAllElements","nodeList","unwrapPolymerNode","polyNode","additions","bare","dom","polyInvoke","getPolyParent","AutoBinding","_isBound","_scope","subScope","scopeHolder","scopeObjName","lastIndexOf","pop","join","__destroy__","Binding","values","pair","Attr","toString","registry","BindingRegistry","register","warn","ClassBinding","applyClass","substr","classList","add","remove","JSON","parse","stringify","preRenderHooks","postRenderHooks","preRenderTasks","renderTasks","postRenderTasks","nextPostRenderTasks","active","renderCycle","hook","task","tasks","flush","scheduleNextFrame","requestAnimationFrame","RenderEngine","addPreRenderHook","addPostRenderHook","removePreRenderHook","removePostRenderHook","schedulePreRenderTask","renderFrame","TaskList","registeredIds","EnabledBinding","ScopePrototype","fn","localRecycle","__watch__","has","require","readStyleProperties","container","getComputedStyle","dimensions","getBoundingClientRect","styleKey","StyleBinding","TemplateRepeatBinding","itemNodeList","itemScopeList","modelBackup","renderItem","itemName","fragment","polyParent","childScope","$first","$last","$index","__parentScope__","link","dirty","error","isArray","DocumentFragment","nextElementSibling","count","TwoWayBinding","attribute","oldValue","activeElement","range","createRange","selection","getSelection","selectNodeContents","collapse","removeAllRanges","addRange","importTemplate","request","send","markup","stripHashKey","NetworkRequest","_body","_headers","url","_listeners","headers","setHeader","onReady","self","xhr","XMLHttpRequest","open","promise","success","failure","onreadystatechange","status","response","getResponseHeader","setRequestHeader","LIST_HAS_ITEMS","ViewPortInstance","_bound","_innerScope","_originalTemplate","_application","templateUrl","overflow","firstChild","alowOverflow","_elements","getInstance","free","instance","IfBinding","nextSibling","isTrue","ElementToScopeBinding","Header","notConnected","online","connected","connectionStatus","connecting","onStatusChange","MessageList","currentMessages","timestamp","PushManager","platform","serviceStatus","_newPushHandler","_registerHandler","_handleServiceError","_baiduHandleServiceReady","_register","clientId","_handleMessageError","platformId","navigator","_newMessage","token","_registerServiceSimple","force","registrations","onsuccess","result","unregister","enpoint","_simpleHandleServiceReady","onerror","baiduPush","startWork","onNotificationArrived","mozSetMessageHandler","onPush","_newPusHandler","onRegister","setRegistrationFailed","ScreenManager","applicationIsActive","hidden","Socket","_host","_hostId","_websocket","_online","_connected","_connecting","_onStatusChange","_decelerate","_decelerateTimeout","_decelerateMaxTimeout","_statusChange","_onceQueue","onLine","reconnect","_ack","messageId","sendMessage","_onMessage","message","timeout","timeoutId","once","clearTimeout","websocket","close","decelerate","WebSocket","onopen","onclose","onmessage"],"mappings":"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","file":"838fbf67138b176172d2.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\texports: {},\n \t\t\tid: moduleId,\n \t\t\tloaded: false\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.loaded = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(0);\n\n\n\n/** WEBPACK FOOTER **\n ** webpack/bootstrap 838fbf67138b176172d2\n **/","import application from './main.js';\n\nlet onDeviceReady = function() {\n    application.init();\n}\n\n\nlet deviceReady = new Promise((ready) => {\n    if (!!window.cordova) {\n        document.addEventListener('deviceready', ready, false);\n    } else if (document.readyState != 'loading') {\n        onDeviceReady();\n    } else {\n        document.addEventListener('DOMContentLoaded', ready, false);\n    }\n});\n\nlet polymerReady = new Promise((ready) => {\n    if (window.Polymer && window.Polymer.ImportStatus._ready) {\n        window.Polymer.ImportStatus.whenReady(ready);\n    } else {\n        window.addEventListener('WebComponentsReady', ready);\n    }\n});\n\nPromise.all([deviceReady, polymerReady]).then(onDeviceReady);\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/bootstrap.js\n **/","import { Make } from '../af/util/make.js';\nimport Application from '../af/core/prototypes/Application.js';\nimport BottomInput from './BottomInput.js';\nimport Header from './Header.js';\nimport MessageList from './MessageList.js';\nimport PushManager from './PushManager.js';\nimport ScreenManager from './ScreenManager.js';\nimport Socket from './Socket.js';\n\nlet application = Make({\n    name: 'HeartWire',\n\n    pushManager: null,\n    socket: null,\n\n    headerController: null,\n    bottomInputController: null,\n    messageListController: null,\n\n    _make: function() {\n        this.pushManager = PushManager;\n        this.socket = Make(Socket)({ host: ['localhost:5000', '192.168.44.210:5000'] });\n        this.sreeenManager = ScreenManager;\n        this.headerController = Make(Header)(this);\n        this.bottomInputController = Make(BottomInput)();\n        this.messageListController = Make(MessageList)();\n    },\n\n    init: function() {\n        this.pushManager.init();\n        this.socket.init();\n    },\n\n}, Application)();\n\nexport default application;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/main.js\n **/","/**\n * The make module consits of Make, getPrototypeOf and mixin.\n * See the documentation for each method to see what is does.\n * This module is part of the ApplicationFrame.\n * @module Make\n * @author Jovan Gerodetti\n * @copyright Jovan Gerodetti\n * @version 1.0\n */\n\n\n/**\n * Internal function to apply one objects propteries to a target object.\n *\n * @param {Object} target\n * @param {Object} source\n * @inner\n */\nvar apply = function (target, source) {\n    Object.keys(source).forEach(function(key){\n        Object.defineProperty(target, key, Object.getOwnPropertyDescriptor(source, key));\n    });\n\n    return target;\n};\n\n/**\n * Creates a new object with the given prototype.\n * If two arguments are passed in, the properties of the first object will be\n * applied to the new object.\n *\n * @param {Object} object\n * @param {Object} prototype\n * @return {function}\n */\nexport var Make = function(object, prototype) {\n    if(arguments.length < 2){\n        prototype = object;\n        object = null;\n    }\n\n    if (object === null) {\n        object = Object.create(prototype);\n    } else {\n        object = apply(Object.create(prototype), object);\n    }\n\n    var m = function(...args){\n        var make = object.make || object._make ||function(){};\n\n        make.apply(object, args);\n\n        return object;\n    };\n\n    m.get = function(){ return object; };\n\n    return m;\n};\n\n/**\n * This method checks if the given prototype is in the prototype chain of\n * the given target object.\n *\n * @param {Object} object\n * @param {Object} prototype\n * @return {boolean}\n */\nexport var hasPrototype = function(object, prototype){\n    var p = Object.getPrototypeOf(object);\n\n    while(p !== null && p !== undefined){\n        if(typeof prototype == 'function')\n            prototype = prototype.prototype;\n\n        if(p == prototype)\n            return true;\n        else\n            p = Object.getPrototypeOf(p);\n    }\n\n    return false;\n};\n\n/**\n * Creates a new prototype mixing all the given prototypes. Incase two or more\n * prototypes contain the same propterty, the new prototype will return\n * the propterty of the first prototype in the list which contains it.\n *\n * @param {...Object} prototypes - the porotype object to combine\n * @return {Proxy} - the resulting proxy object\n */\nexport var Mixin = function(...prototypes){\n\n    return new Proxy(prototypes, MixinTrap);\n\n};\n\n/**\n * Internal function to find a proptery in a list of prototypes.\n *\n * @param {Object[]} prototypes\n * @param {string} key\n * @return {Object}\n */\nvar findProperty = function(prototypes, key) {\n    for (var i = 0; i < prototypes.length; i++) {\n        var item = prototypes[i];\n\n        if (item && item[key]) {\n            return item;\n        }\n    }\n\n    return undefined;\n};\n\n/**\n * Traps to create a mixin.\n */\nvar MixinTrap = {\n\n    'get' : function(prototypes, key) {\n        var object = findProperty(prototypes, key);\n\n        if (object && typeof object[key] === 'function') {\n            return object[key].bind(object);\n        }\n\n        return (object ? object[key] : null);\n    },\n\n    'set' : function(prototypes, key, value) {\n        var object = findProperty(prototypes, key);\n\n        if (object) {\n            object[key] = value;\n        } else {\n            prototypes[0][key] = value;\n        }\n\n        return true;\n    }\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/util/make.js\n **/","import { Make } from '../../util/make.js';\nimport Thread from './Thread.js';\nimport ApplicationInternal from './ApplicationInternal.js';\n\nlet Internal = new WeakMap();\n\n/** @lends Application.prototype */\nlet Application = {\n\n    /**\n    * Name of this application so other components can identify the application.\n    *\n    * @type {string}\n    */\n    name : '',\n\n    /**\n    * Some components may need to know the version of this applicaion.\n    *\n    * @type {string}\n    */\n    version : '0.0.0',\n\n    /**\n    * @type {string}\n    */\n    author : '',\n\n    /**\n    * @constructs\n    *\n    * @return {void}\n    */\n    _make : function(){\n        Internal.set(this, Make(ApplicationInternal)());\n    },\n\n    /**\n    * Initializes this application, default interface for components and modules.\n    *\n    * @return {void}\n    */\n    init : function(){\n        console.log(`Initialzing Application \"${this.name}\"!`);\n    },\n\n\n    /**\n    * Registers a new event listener for the given event type.\n    *\n    * @param {string} type the event type\n    * @param {function} listener the listener function\n    *\n    * @return {Application} this application\n    */\n    on : function(type, listener){\n        let scope = Internal.get(this);\n\n        if (!scope.listeners[type]) {\n            scope.listeners[type] = [];\n        }\n\n        scope.listeners[type].push(listener);\n\n        return this;\n    },\n\n    /**\n    * removes a previously attached listener function.\n    *\n    * @param  {string} type     the listener type\n    * @param  {Function} listener the listener function to remove\n    *\n    * @return {void}\n    */\n    removeListener: function(type, listener) {\n        let scope = Internal.get(this);\n\n        if (scope.listeners[type]) {\n            let index = scope.listeners[type].indexOf(listener);\n\n            scope.listeners[type].splice(index, 1);\n        }\n    },\n\n    /**\n    * Emmits a new event on this application.\n    *\n    * @param {string} type event type\n    * @param {Object} data event data\n    *\n    * @return {void}\n    */\n    emit : function(type, data){\n        let scope = Internal.get(this);\n        let name = this.name ? `${this.name}:%c ` : '%c%c';\n\n        if (scope.listeners[type]) {\n            console.log(`%c${name}${type} event emitted`,\n                'font-weight: 900; text-decoration: underline;',\n                'font-weight: initial; text-decoration: initial;');\n\n            setTimeout(() => scope.listeners[type].forEach(f => f(data)), 0);\n        }\n    },\n\n    /**\n    * Creates a new thread for this applicaion.\n    *\n    * @param {function} f function to execute in a new thread\n    *\n    * @return {ApplicationScopeInterface} this applicaion scope\n    */\n    thread : function(f){\n        let scope= Internal.get(this);\n\n        scope.workers.push(Make(Thread)(f));\n\n        return this;\n    },\n\n    /**\n    * This function will try to terminate the application by emitting the termination event.\n    *\n    * @param {string} reason - the reason for the termination.\n    *\n    * @return {void}\n    */\n    terminate : function(reason){\n        this.emit('terminate', reason);\n    }\n\n};\n\nexport default Application;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/core/prototypes/Application.js\n **/","/**\n * @file Thread\n * @deprecated Don't use this anymore. It will be removed soon.\n */\n\nimport Shared from '../objects/Shared.js';\n\n/**\n * this prototype defines a new scope worker\n */\nlet Thread = {\n\n    /**\n     * The parent application of this thread.\n     *\n     * @type {Application}\n     */\n    parent : null,\n\n    /**\n     * The Worker Object for this thread.\n     *\n     * @type {Worker}\n     * @private\n     */\n    _thread : null,\n\n    _promise : null,\n\n    then : null,\n\n    catch : null,\n\n    /**\n     * @constructs\n     * @param {function} f\n     * @param {Application} parent\n     */\n    _make : function(f, parent){\n        this.parent= parent;\n        this.thread= new Worker(Shared.threadLoader);\n        this.thread.postMessage({ name : 'init', func : f });\n        this.progressListeners= [];\n\n        this._promise = new Promise((done) => {\n            this._thread.addEventListener('message', function(e){\n                if(e.data.name == 'af-worker-done')\n                    done(e.data.data);\n            }, false);\n        });\n\n        this._thread.addEventListener('message', e => {\n            if(e.data.name == 'af-worker-progress') {\n                this.emit('progress', e.data.data);\n            }\n        }, false);\n\n        this.then = this._promise.then.bind(this._promise);\n        this.catch = this._promise.catch.bind(this._promise);\n    }\n};\n\nexport default Thread;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/core/prototypes/Thread.js\n **/","/**\n * @file Shared\n * @deprecated Don't use this anymore. It will be removed soon.\n */\n\nexport default {};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/core/objects/Shared.js\n **/","\n/** @lends ApplicationInternal# */\nlet ApplicationInternal = {\n    /**\n     * @type {Thread}\n     */\n    thread : null,\n\n    /**\n     * @type {Worker[]}\n     */\n    workers : null,\n\n    /**\n     * @type {Function[]}\n     */\n    listeners : null,\n\n    /**\n     * @type {Catalog}\n     */\n    modules : null,\n\n    /**\n     * this prototype defines a new application scope\n     *\n     * @constructs\n     *\n     * @return {void}\n     */\n    _make : function(){\n        this.workers= [];\n        this.listeners= [];\n\n        this._make = null;\n    }\n};\n\nexport default ApplicationInternal;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/core/prototypes/ApplicationInternal.js\n **/","import DataBinding from '../af/modules/DataBinding.js';\n\nlet BottomInput = {\n    currentDraft: '',\n\n    get inputValue() {\n        return this.inputFocused ||this.currentDraft.length > 0 ?\n            this.currentDraft : (this.inputElement && this.inputElement.getAttribute('placeholder'));\n    },\n\n    set inputValue(value) {\n        this.currentDraft = value;\n    },\n\n    inputFocused: false,\n\n    get usePlaceholderClass() {\n        return (!this.inputFocused && this.currentDraft.length === 0) ? 'placeholder': '';\n    },\n\n    /** @type HTMLDivElement */\n    inputElement: null,\n\n    inputFocusChange: function(event) {\n        event.cancleRecycle();\n        this.view.inputFocused = event.type === 'focus';\n        this.__apply__(null, true);\n    },\n\n    scope: null,\n\n    _make: function() {\n        this.scope = DataBinding.makeTemplate('#bottom-input', { view: this });\n    }\n}\n\nexport default BottomInput;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/BottomInput.js\n **/","/**\n * DataBinding Module\n *\n * @module DataBinding\n * @default module:DataBinding.DataBinding\n */\n\nimport { makeTemplate } from './DataBinding/Template.js';\nimport { polyInvoke } from './DataBinding/Util.js';\nimport { bindNode } from './DataBinding/Bind.js';\nimport ViewPort from './DataBinding/ViewPort.js';\nimport './DataBinding/IfBinding.js';\nimport './DataBinding/ElementToScopeBinding.js';\n\nNodeList.prototype.forEach = NamedNodeMap.prototype.forEach = Array.prototype.forEach;\n\nlet style = document.createElement('style');\n\nstyle.innerHTML = `\n    [bind-display=\"false\"] {\n        display: none !important;\n    }\n\n    [bind-visible=\"false\"] {\n        visibility: hidden;\n    }\n`;\n\npolyInvoke(document.head).appendChild(style);\n\n/**\n * [DataBinding description]\n *\n * @type {module:DataBinding.ModuleInterface}\n */\nexport let DataBinding = {\n    makeTemplate : makeTemplate,\n    bindNode : bindNode,\n    ViewPort : ViewPort,\n};\n\nexport default DataBinding;\n\n/**\n * @interface ModuleInterface\n * @borrows module:DataBinding/Bind.bindNode as bindNode\n * @borrows module:DataBinding/Template.makeTemplate as makeTemplate\n * @borrows module:DataBinding/ViewPort.ViewPort\n * @static\n *\n */\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/modules/DataBinding.js\n **/","/**\n * @module DataBinding/Template\n */\n\nimport { Make } from '../../util/make.js';\nimport { bindNode } from './Bind.js';\nimport { getPolyParent, polyInvoke } from './Util.js';\nimport { importTemplate } from './TemplateLoader.js';\nimport { parseExpression } from './Parser';\nimport RenderEngine from './RenderEngine';\nimport ScopePrototype from './ScopePrototype.js';\n\n/**\n * Instanciates a template based on a specified element.\n *\n * @param  {HTMLTemplateElement}               template    the template to instanciate\n * @param  {module:DataBinding.ScopePrototype} scope       the scope to operate on\n * @param  {Application}                       application the application this binding belongs to\n * @param  {Node}                              item        the original node\n *\n * @return {void}\n */\nlet makeElementFromTemplate = function(template, scope, application, item) {\n    RenderEngine.schedulePostRenderTask(() => {\n    let node = document.importNode(template.content, true);\n    let placeholder = node.querySelector('bind-placeholder');\n\n    item.attributes.forEach(attr => {\n        polyInvoke(node.firstElementChild).setAttribute(attr.name, attr.value);\n    });\n\n    if (placeholder) {\n        let node = item.firstElementChild;\n        polyInvoke(placeholder.parentNode).replaceChild(item.firstElementChild, placeholder);\n\n        [].forEach.apply(item.children, [item => {\n            polyInvoke(node.parentNode).appendChild(item);\n        }]);\n    }\n\n    node.firstElementChild.className = template.id + ' ' + node.firstElementChild.className;\n\n    scope = scope();\n\n    [].map.apply(node.firstElementChild.attributes, [item => {\n        if (item.name.search(/^scope\\-/) > -1 ) {\n            scope[item.name.replace(/^scope\\-/, '')] = item.value;\n        }\n    }]);\n\n    if (template.hasAttribute('component')) {\n        scope.element = node.firstElementChild;\n    }\n\n    scope = bindNode(node, scope);\n\n    polyInvoke(item.parentNode).replaceChild(node, item);\n\n    if (application) {\n        application.emit(`newElement:${template.id}`, scope);\n    }\n    });\n};\n\n/**\n * creates a new instance of an HTML template and applies the binding with\n * the given scope.\n *\n * @function\n *\n * @param {Node|string} template - the template to render\n * @param {ScopePrototype} scope - the scope for this template to bind to\n * @param {Application} [application] - the application this template belongs to\n * @param {ScopePrototype} [parentScope] - the surounding scope of this template node\n *\n * @return {Object} - collection of scope and rendered element\n */\nexport let makeTemplate = function (template, scope, application, parentScope) {\n    template = (typeof template === 'string') ? document.querySelector(template) : template;\n\n    if (template.hasAttribute('src') && !template.processed) {\n        let source = template.getAttribute('src');\n\n        if (parentScope) {\n            let value = parseExpression(source, parentScope);\n\n            source = (value && value != '') ? value : source;\n        }\n\n        scope = Make(scope, ScopePrototype)();\n\n        importTemplate(source, template)\n            .then(template => {\n                template.processed = true;\n                makeTemplate(template, scope, application, parentScope)\n            });\n\n        return scope;\n\n    }else if (template.hasAttribute('bind-element')) {\n        let makeElement = makeElementFromTemplate.bind(this, template, scope, application);\n        let list = document.querySelectorAll(template.id);\n\n        [].forEach.apply(list, [makeElement]);\n\n        (new MutationObserver(mutations => {\n            mutations.forEach(item => {\n                if (item.addedNodes.length > 0) {\n                    let list = [].map.apply(item.addedNodes, [node => {\n                        return node.querySelectorAll ? [].slice.apply(node.querySelectorAll(template.id)) : [];\n                    }]).reduce((prev, next) => prev.concat(next), []);\n\n                    list = list.concat([].filter.apply(item.addedNodes, [node => node.localName === template.id]));\n\n                    [].forEach.apply(list, [makeElement]);\n                }\n            });\n        })).observe(document.body, {\n            childList : true,\n            subtree : true\n        });\n\n    } else {\n        let node = document.importNode(template.content, true);\n        let isReplace = template.hasAttribute('replace');\n        let isInsert = template.hasAttribute('insert');\n\n        scope = bindNode(node, scope);\n\n        if (isReplace || isInsert) {\n            let elementList = [].slice.apply(node.childNodes);\n\n            scope.__cleanElements__ = function(){\n                elementList.forEach(node => {\n                    node.parentNode && node.parentNode.removeChild(node);\n                });\n            }\n        }\n\n        let parentNode = template.parentNode;\n\n        if (template.getAttribute('poly-parent')) {\n            let parentName = template.getAttribute('poly-parent');\n\n            parentNode = getPolyParent(template, parentName);\n        }\n\n        if (isReplace) {\n            console.log('replace template');\n\n            polyInvoke(parentNode).replaceChild(node, template);\n        } else if (isInsert) {\n            polyInvoke(parentNode).insertBefore(node, template);\n        }\n\n        return {node : node, scope : scope };\n    }\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/modules/DataBinding/Template.js\n **/","/**\n * @module DataBinding/Bind\n */\n\nimport { Make, hasPrototype } from '../../util/make.js';\nimport { ObjectParser, parseExpression, assignExpression } from './Parser.js';\nimport { attributeNames } from './Mapping.js';\nimport { polyInvoke } from './Util.js';\nimport AutoBinding from './AutoBinding.js';\nimport Binding from './Binding.js';\nimport BindingRegistry from './BindingRegistry.js';\nimport ClassBinding from './ClassBinding.js';\nimport EnabledBinding from './EnabledBinding.js';\nimport RenderEngine from './RenderEngine';\nimport ScopePrototype from './ScopePrototype.js';\nimport StyleBinding from './StyleBinding';\nimport TemplateRepeatBinding from './TemplateRepeatBinding.js';\nimport TwoWayBinding from './TwoWayBinding.js';\n\n/**\n * Contains all scope, scopeInfo pairs.\n *\n * @type {WeakMap}\n */\nlet scopeList = new Map();\n\n/**\n * @type {ScopePrototype[]}\n */\nlet scopeIndex = [];\n\n/**\n * @type {Array[]}\n */\nexport let watcherList = new Map();\n\n/**\n * @type {Object}\n */\nlet expressionTracking = {};\n\n/**\n * applies the binding to the node for the given scope.\n *\n * @function\n * @param {Node|string} node - the node which should be bound\n * @param {Object} scope - the scope which should be bound to\n * @param {boolean} isolated - indicates if this scope should be recycled isolated\n * @return {module:DataBinding~ScopePrototype} the scope this node is bound to\n */\nexport let bindNode = function(node, scope, isolated) {\n\tscope = hasPrototype(scope, ScopePrototype) ? scope : Make(scope, ScopePrototype)();\n    node = hasPrototype(node, Node) ? node : document.querySelector(node);\n\n\tscopeList.set(scope, {\n\t\tnode : node,\n\t\tbindings : []\n\t});\n\n    scopeIndex.push(scope);\n\n\tcheckNode(node, scope);\n    recycle(isolated ? scope : false);\n\n\treturn scope;\n};\n\n/**\n * Travels through a node and it's children searching for binding expressions\n *\n * @param {Node} node - the node to check\n * @param {module:DataBinding.ScopePrototype} scope - the scope this node should be bound to\n * @param {Node} parentNode - the parent of the provided node\n * @return {void}\n */\nlet checkNode = function(node, scope, parentNode) {\n    let dataRegex = /{{[^{}]*}}/g;\n    let scopeInfo = scopeList.get(scope);\n\n\tif (node.nodeName == '#text' || node.nodeType === 2) {\n    \tlet text = node.value ||polyInvoke(node).textContent,\n            variables = text.match(dataRegex),\n            visibilityBinding = (node.name === attributeNames.get('visible')),\n            transparencyBinding = (node.name === attributeNames.get('transparent')),\n            enabledAttribute = node.name === attributeNames.get('enabled'),\n            classes = (node.name === attributeNames.get('classes')),\n            modelBinding = node.name === attributeNames.get('model'),\n            autoBinding = node.name === 'bind',\n            twoWay = (node.name === attributeNames.get('value') || modelBinding),\n            styleBinding = (node.name === 'bind-style');\n\n        let singleBinding = visibilityBinding || transparencyBinding;\n\n        if (twoWay) {\n            bindTwoWay(text, scope, scopeInfo, node, parentNode, modelBinding);\n        } else if (classes) {\n            bindClasses(text, node, scopeInfo, parentNode);\n        } else if (enabledAttribute) {\n            bindEnabled(text, scopeInfo, parentNode);\n        } else if (autoBinding) {\n            bindAuto(text, scopeInfo, parentNode);\n        } else if (styleBinding) {\n            bindStyle(text, scopeInfo, scope, parentNode);\n        } else if (BindingRegistry.get(node.name) && BindingRegistry.get(node.name).test()) {\n            Make(BindingRegistry.get(node.name))({\n                text: text,\n                variables: variables,\n                scope: scope,\n                scopeInfo: scopeInfo,\n                node: node,\n                parentNode: parentNode,\n            });\n        } else if (variables || singleBinding) {\n            bindSimple(text, node, variables, scopeInfo, singleBinding, parentNode);\n        }\n\n    } else if(node.localName === 'template'){\n        let repeatedTemplate = (node.hasAttribute('replace') &&\n                                node.hasAttribute('repeat')) ||\n                                node.hasAttribute('bind-repeat');\n\n        node.attributes.forEach(child => checkNode(child, scope, node));\n\n        if (repeatedTemplate) {\n            bindTemplateRepeat(node, scopeInfo);\n        }\n    } else {\n        if (node.attributes) {\n            node.attributes.forEach((child) => checkNode(child, scope, node));\n\n            let events = node.getAttribute(attributeNames.get('events'));\n\n        \tif (events !== null) {\n        \t\tbindEvents(events, node, scope);\n\n\t\t\t\tpolyInvoke(node).removeAttribute(attributeNames.get('events'));\n       \t\t}\n        }\n\n        node.childNodes.forEach((node) => { return checkNode(node, scope); });\n    }\n};\n\n/**\n * creates a two way binding\n *\n * @param {string} text - the attribute text\n * @param {module:DataBinding.ScopePrototype} scope - the scope for this binding\n * @param {Object} scopeInfo - the scopeInfo for this binding\n * @param {Node} node - the attribute node\n * @param {Node} parentNode - the actual node\n * @param {boolean} indirect - indicates if this binding is indirect\n * @return {void}\n */\nlet bindTwoWay = function(text, scope, scopeInfo, node, parentNode, indirect){\n    let property = text.replace(/[{}]/g, '');\n    let value = parseExpression(property, scope);\n    let [event, viewBinding, eventBinding, preventDefault] = (parentNode.getAttribute(attributeNames.get('modelEvent')) ||'').split(':');\n\n    /** @type {TwoWayBinding} */\n    let binding = Make({\n        properties : [property],\n        originalNodeValue : text,\n        currentValue : value,\n        node : node,\n        parentNode : parentNode,\n        indirect : indirect,\n        viewBinding : viewBinding,\n    }, TwoWayBinding).get();\n\n    scopeInfo.bindings.push(binding);\n\n    if (node.name === attributeNames.get('model')) {\n        parentNode.addEventListener(event, e => {\n            if (preventDefault === 'true') {\n                e.preventDefault();\n            }\n\n            console.log(e);\n            let value = parseExpression(eventBinding, e);\n            compareTwoWay(value, scope, binding);\n        });\n    } else if(node.name === attributeNames.get('value')) {\n        parentNode.addEventListener('keyup', e => {\n            e.preventDefault();\n            compareTwoWay(getElementValue(e.target), scope, binding);\n        });\n    }\n};\n\n/**\n * Compares for changes in the UI in a two way binding\n *\n * @param {string} newValue - the new value to compare\n * @param {module:DataBinding.ScopePrototype} scope - the scope of the comparison\n * @param {TwoWayBinding} binding - the binding to compare\n * @return {void}\n */\nlet compareTwoWay = function(newValue, scope, binding){\n    if (binding.currentValue !== newValue) {\n        assignExpression(binding.properties[0], scope, newValue);\n        binding.currentValue = newValue;\n\n        console.log('update from view:', scope);\n\n        recycle();\n    }\n}\n\n/**\n * creates a simple binding\n *\n * @param {string} text the initial text of the node\n * @param {Node} node the text or attribute node of the binding\n * @param {string[]} variables list of expressions\n * @param {Object} scopeInfo meta data of the current scope\n * @param {boolean} singleExpression - indicates if text contains only one expression\n * @return {void}\n */\nlet bindSimple = function(text, node, variables, scopeInfo, singleExpression, parentNode){\n    /** @type {Binding} */\n    let binding = Make({\n        originalNodeValue : text,\n        node : node,\n        parentNode : parentNode,\n        singleExpression : singleExpression,\n        properties : variables ? variables.map(item => item.replace(/[{}]/g, '')) : []\n    }, Binding).get();\n\n    scopeInfo.bindings.push(binding);\n}\n\n/**\n * binds an object expression to node.className.\n *\n * @param  {string} text      the initial text value of the binding node\n * @param  {Node}   node        the binding node\n * @param  {Object} scopeInfo the meta data of the current scope\n * @param  {Node}   parentNode  the parent of the binding node\n *\n * @return {void}\n */\nlet bindClasses = function(text, node, scopeInfo, parentNode) {\n    let binding = Make({\n        originalNodeValue : text,\n        node : node,\n        classes : ObjectParser(text),\n        parentNode : parentNode\n    }, ClassBinding).get();\n\n    scopeInfo.bindings.push(binding);\n};\n\n/**\n * binds an expression to the disabled attribute.\n *\n * @param  {string} text       the initial value of the binding node\n * @param  {Object} scopeInfo  the meta data of the current scope\n * @param  {Node}   parentNode the parent of the binding node\n *\n * @return {void}\n */\nlet bindEnabled = function(text, scopeInfo, parentNode) {\n    let binding = Make({\n        originalNodeValue : text,\n        parentNode : parentNode\n    }, EnabledBinding)();\n\n    scopeInfo.bindings.push(binding);\n};\n\n/**\n * binds a template to an array or list. The template is repeated for each list item.\n *\n * @param  {Node}   template  the template node\n * @param  {Object} scopeInfo the meta data of the current scope\n *\n * @return {void}\n */\nlet bindTemplateRepeat = function(template, scopeInfo) {\n    let text = template.hasAttribute('bind-repeat') ?\n                            template.getAttribute('bind-repeat') :\n                            template.getAttribute('repeat');\n\n    let marker = document.createComment(`repeat ${template.id} with ${text}`);\n    let binding = Make({\n        originalNodeValue : text,\n        template : template,\n        marker : marker,\n    }, TemplateRepeatBinding)();\n\n    console.log('replace template with marker');\n    polyInvoke(template.parentNode).replaceChild(marker, template);\n    scopeInfo.bindings.push(binding);\n};\n\n/**\n * Binds the events specified for a Node\n *\n * @param {string[]}                          events a string representation of the object with all the event / expression pairs.\n * @param {Node}                              node   the node on which the event listeners should be registered.\n * @param {module:DataBinding~ScopePrototype} scope  the data scope on which the binding happens.\n * @return {void}\n */\nlet bindEvents = function(events, node, scope){\n\tevents = ObjectParser(events);\n\n\tObject.keys(events).forEach(name => {\n\t\tlet method = events[name];\n\n        if (scope.$methods && scope.$methods[method.trim()]) {\n            node.addEventListener(name.trim(), e => {\n                scope.$methods[method.trim()].apply(scope, [e]);\n\n                scope.__apply__();\n            });\n        } else {\n            method = parseExpression(method.trim(), scope);\n\n            node.addEventListener(name.trim(), e => {\n                let canceled = false;\n\n                e.cancleRecycle = function(){\n                    canceled = true;\n                }\n\n                method.apply(scope, [e]);\n\n                if (!canceled)\n                    scope.__apply__();\n            });\n        }\n\t});\n};\n\n/**\n * automatically binds a template to a property of the current scope\n *\n * @param  {string} text      the binding text\n * @param  {Object} scopeInfo the meta data of the current scope\n * @param  {Node}   template  the template node\n *\n * @return {void}\n */\nlet bindAuto = function(text, scopeInfo, template) {\n    let binding = Make({\n        scopeName : text,\n        template : template\n    }, AutoBinding)();\n\n    scopeInfo.bindings.push(binding);\n}\n\n/**\n * binds visual properties to the scope\n *\n * @param  {string}                            text       the binding text\n * @param  {Object}                            scopeInfo  the meta data of the scope\n * @param  {module:DataBinding~ScopePrototype} scope      the current scope\n * @param  {Node}                              parentNode the parent of the binding node\n *\n * @return {void}\n */\nlet bindStyle = function(text, scopeInfo, scope, parentNode) {\n    let binding = Make({\n        bindings: text,\n        parentNode: parentNode,\n    }, StyleBinding)(scope);\n\n    scopeInfo.bindings.push(binding);\n}\n\n/**\n * executes every watcher for the given scope.\n *\n * @param  {module:DataBinding~ScopePrototype} scope the current scope\n *\n * @return {void}\n */\nlet executeWatchers = function(scope) {\n    watcherList.get(scope) && watcherList.get(scope).forEach(watcher => {\n        let value = parseExpression(watcher.expression, scope);\n\n        expressionTracking[watcher.expression] = expressionTracking[watcher.expression] ||{ value : '', newValue : '' };\n\n        if (expressionTracking[watcher.expression].value !== value) {\n            watcher.cb.apply(scope, [value]);\n\n            expressionTracking[watcher.expression].newValue = value;\n        }\n    });\n}\n\n/**\n * Checks every binding for the given scope and updates every value.\n *\n * @function\n * @param {module:DataBinding~ScopePrototype} [scope] the scope to recycle\n *\n * @return {void}\n */\nexport let recycle = function (scope) {\n    RenderEngine.scheduleRenderTask(() => {\n        let t0 = window.performance.now();\n\n        if (scope) {\n            executeWatchers(scope);\n            scopeList.get(scope).bindings.forEach(binding => binding.update(scope));\n\n        } else {\n            scopeIndex.forEach(scope => {\n                executeWatchers(scope);\n    \t        scopeList.get(scope).bindings.forEach(binding => binding.update(scope));\n            });\n        }\n\n        Object.keys(expressionTracking).forEach(expr => {\n            expr = expressionTracking[expr];\n\n            expr.value = expr.newValue;\n        });\n\n        let t1 = window.performance.now();\n        let duration = ((t1 - t0) / 1000);\n        let color = null;\n\n        if (duration >= 0.033) {\n            color = 'red';\n        } else if (duration >= 0.016) {\n            color = 'yellow';\n        } else {\n            color = 'green';\n        }\n\n        color = `color: ${color};`;\n        duration = duration.toFixed(2);\n\n        if (scope) {\n            console.log(`scope recycled in %c${duration}s`, color);\n        } else {\n            console.log(`full recycle in %c${duration}s`, color);\n        }\n    }, scope || 'DataBindingRecycle');\n};\n\n/**\n * destories a scope.\n *\n * @function\n * @param {module:DataBinding~ScopePrototype} scope the scope to destory\n * @param {boolean} inProgress                indicates if this is an initial call or not.\n */\nexport let destoryScope = function(scope, inProgress) {\n    console.log(scopeList);\n    let scopeInfo = scopeList.get(scope);\n\n    let [scopes, bindings] = scopeInfo.bindings.reduce((prev, binding) => {\n        let [scopes, bindings] = prev;\n\n        if (binding.destory) {\n            let [scopes_add, bindings_add] = binding.destory();\n\n            scopes += scopes_add;\n            bindings += bindings_add;\n        }\n\n        return [scopes, bindings];\n    }, [0, 0]);\n\n    bindings += scopeInfo.bindings.length;\n    scopes += 1;\n\n    scopeList.delete(scope);\n    scopeIndex.splice(scopeIndex.indexOf(scope), 1);\n    watcherList.delete(scope);\n\n    if (inProgress) {\n        return [scopes, bindings];\n    } else {\n        console.log(`${scopes} scopes and ${bindings} bindings cleaned!`);\n    }\n};\n\n/**\n * Returns the value of an DOM Node\n *\n * @param {Node} node the node to fetch the value from\n *\n * @return {string} value of this node\n */\nlet getElementValue = function(node){\n    if (node.localName === 'input') {\n        return node.value;\n    } else {\n        return 'UNKNOWN NODE!';\n    }\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/modules/DataBinding/Bind.js\n **/","/**\n * @module DataBinding/Parser\n */\n\n/**\n * Parses an object expression\n *\n * @param {string} source - the string to parse.\n * @return {Object} the parsed result.\n */\nexport let ObjectParser = function(source){\n    let target = null;\n    let key = false;\n    let keyBuffer = '';\n    let valueBuffer = '';\n    let run = true;\n\n    source.split('').forEach((char) => {\n        if (run) {\n            if (char === '{') {\n                target = {};\n                key = true;\n            } else if(char === ':') {\n                key = false;\n            } else if(char === ',') {\n                target[keyBuffer.trim()] = valueBuffer.trim();\n                keyBuffer = valueBuffer = '';\n                key = true;\n            } else if(char === '}') {\n                target[keyBuffer.trim()] = valueBuffer.trim();\n                run = false;\n            } else if(key) {\n                keyBuffer += char;\n            } else if(!key) {\n                valueBuffer += char;\n            }\n        }\n    });\n\n    return target;\n};\n\n/**\n * Parses a given expression in the context of the given scope.\n *\n * @param {string} expression - the expression to parse.\n * @param {ScopePrototype} scope - the scope on which the expression should be parsed.\n * @return {*} the result value.\n */\nexport let parseExpression = function(expression, scope){\n\tlet chain = expression.split('.');\n\n    chain.forEach((item) => {\n        let pos = item.search(/\\(\\)$/);\n\n        if (scope) {\n            if (pos > 0) {\n                let scopeChild = scope[item.substring(0, pos)];\n\n                if (scopeChild) {\n                    scope = scopeChild.apply(scope);\n                } else {\n                    return '';\n                }\n            } else {\n                scope = scope[item];\n            }\n        }\n    });\n\n    return (scope !== null &&typeof scope !== \"undefined\") ? scope : '';\n};\n\n/**\n * Assings an value to an expression in an given scope\n *\n * @param {string} expression the expression on whith the value should be assigned\n * @param {ScopePrototype} scope the scope to operate on\n * @param {string} value the value to assign\n *\n * @return {void}\n */\nexport let assignExpression = function(expression, scope, value){\n    let chain = expression.split('.');\n\n    chain.forEach((property, index) => {\n        if (chain.length -1 !== index) {\n            scope = scope[property];\n        } else {\n            scope[property] = value;\n        }\n    });\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/modules/DataBinding/Parser.js\n **/","/**\n * @module DataBinding/Mapping\n */\n\n/**\n * Contains all the attribute names\n *\n * @namespace\n */\nexport let attributeNames = {\n    events : 'events',\n    visible : 'display',\n    transparent : 'visible',\n    classes : 'class',\n    value : 'value',\n    prefix : 'bind',\n    enabled : 'enabled',\n    model : 'model',\n    modelEvent : 'model-event',\n\n    /**\n     * returns the value for a key\n     *\n     * @param  {string} key the key to lookup\n     *\n     * @return {string}     the coresponding value\n     */\n    get : function(key){\n        return `${this.prefix}-${this[key]}`;\n    },\n\n    /**\n     * cuts off the prefix of the name\n     *\n     * @param  {string} name initial value\n     *\n     * @return {string}      the clean value\n     */\n    rename : function(name){\n        return name.replace(`${this.prefix}\\-`, '');\n    }\n};\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/modules/DataBinding/Mapping.js\n **/","import { Mixin, hasPrototype } from '../../util/make.js';\n\n/**\n * selects a dom node by the given query.\n *\n * @function\n * @deprecated don't use this anymore, polyMask is deprecated.\n *\n * @param {string} query the query selector to search for on the DOM\n * @param {Node} [context] the node to start the searching on\n *\n * @return {Node} the first node that matches the selector\n */\nexport let selectElement = function(query, context){\n    let node = null;\n\n    if (context) {\n        node = context.querySelector(query);\n    } else {\n        node = document.querySelector(query);\n    }\n\n    node = polyMask(node);\n\n    return node;\n};\n\n/**\n * @function\n * @deprecated don't use anymore. Use {@link document.querySelectorAll}\n *\n * @param {string} query the query to look for\n * @param {Node} context the node to start the searching on\n *\n * @return {NodeList} the node list with all matching nodes\n */\nexport let selectAllElements = function(query, context) {\n    let nodeList = null;\n\n    if (context) {\n        nodeList = context.querySelectorAll(query);\n    } else {\n        nodeList = document.querySelectorAll(query);\n    }\n\n    if (window.Polymer) {\n        nodeList = [].map.apply(nodeList, [polyMask]);\n    }\n\n    return nodeList;\n}\n\n/**\n * attempts to extract the original node from an polymer node\n *\n * @function\n * @deprecated there is no need to use this function anymore\n *\n * @param {Node} node the node to unwrap\n *\n * @return {Node} a mixin exposing the original node\n */\nexport let unwrapPolymerNode = function(node) {\n    if (!hasPrototype(node, Node)) {\n        return Mixin(node, node.node);\n    }\n\n    return node;\n}\n\n/**\n * creates a mixin of the node and a wrapped version from Polymer\n *\n * @function\n * @deprecated this method shouldn't be used anymore. Use polyInvoke\n *\n * @param {Node} node the dom node to mask\n *\n * @return {Node} returns the masked node\n */\nexport let polyMask = function(node){\n    let polyNode = {};\n\n    let additions = {\n        get bare (){\n            return node;\n        }\n    };\n\n    if (window.Polymer) {\n        polyNode = window.Polymer.dom(node);\n    }\n\n    return Mixin(polyNode, node, additions);\n};\n\n/**\n * Tries to call Polymers dom() function if available, to keep them in the loop.\n *\n * @param {Node} node the node we want to take care of.\n * @return {Node} the dom node, maybe wrapped.\n */\nexport let polyInvoke = function(node) {\n\n    if (window.Polymer) {\n        node = window.Polymer.dom(node);\n    }\n\n    return node;\n}\n\n/**\n * attempts to find a parent node with a particular node name\n *\n * @function\n *\n * @param {Node} node the base node\n * @param {string} parentName the node name to search for\n *\n * @return {Node} the node we where searching for \n */\nexport let getPolyParent = function(node, parentName){\n    while (node && node.localName !== parentName) {\n        node = node.parentNode;\n    }\n\n    return node;\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/modules/DataBinding/Util.js\n **/","import { Make } from '../../util/make.js';\nimport Binding from './Binding.js';\nimport { parseExpression } from './Parser.js';\nimport { makeTemplate } from './Template.js';\n\nlet AutoBinding = Make(/** @lends module:DataBinding.AutoBinding.prototype*/{\n\n    scopeName : '',\n\n    /** @type {HTMLTemplateNode} */\n    template : null,\n\n    /** @type {boolean} */\n    _isBound : false,\n\n    /**\n     * An auto binding instanciates a template and binds it\n     * to a property of the current scope.\n     *\n     * @constructs\n     * @extends module:DataBinding.Binding\n     * @return {void}\n     */\n    _make : function(){},\n\n    /** @type module:DataBinding.ScopePrototype */\n    _scope : null,\n\n    update : function(scope) {\n        if (!this._isBound) {\n            let subScope = parseExpression(this.scopeName, scope);\n\n            setTimeout(() => {\n                let scopeHolder = null;\n                let scopeObjName = null;\n\n                if (this.scopeName.lastIndexOf('.') > 0) {\n                    scopeHolder = this.scopeName.split('.');\n                    scopeObjName =  scopeHolder.pop();\n                    scopeHolder = parseExpression(scopeHolder.join('.'), scope);\n\n                    scopeHolder[scopeObjName] = makeTemplate(this.template, subScope, true);\n\n                    this._scope = scopeHolder[scopeObjName];\n                } else {\n                    this._scope = makeTemplate(this.template, subScope, true);\n                }\n            }, 0);\n\n            this._isBound = true;\n        }\n    },\n\n    /**\n     * destroys this binding. This binding needs to be destroied before\n     * it is deleted, since it creates a new scope.\n     *\n     * @return {void}\n     */\n    destory : function(){\n        if (this._scope) {\n            return this._scope.__destroy__(true);\n        } else {\n            return [0, 0];\n        }\n    }\n\n}, Binding).get();\n\nexport default AutoBinding;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/modules/DataBinding/AutoBinding.js\n **/","import { hasPrototype } from '../../util/make';\nimport { parseExpression } from './Parser.js';\nimport { polyInvoke } from './Util.js';\n\n/** @lends module:DataBinding.Binding.prototype */\nlet Binding = {\n\n    /**\n     * @type {string[]}\n     */\n    properties : null,\n\n    /**\n     * @type {string}\n     */\n    originalNodeValue : '',\n\n    /**\n     * @type {Node}\n     */\n    node : null,\n\n    /**\n     * @type {Node}\n     */\n    parentNode : null,\n\n    /**\n     * @type {Boolean}\n     */\n    singleExpression : false,\n\n    /**\n     * The basic prototype for bindings. Any binding should inherit form this prototype.\n     *\n     * @constructs\n     * @return {void}\n     */\n    _make : function() {\n        this.properties = [];\n    },\n\n    /**\n     * updates a binding. The model will be checked for changes\n     * and new data will be applied to the binding target.\n     *\n     * @param  {module:DataBinding.ScopePrototype} scope the scope on which\n     *                                             this binding should operate.\n     *\n     * @return {void}\n     */\n    update : function(scope){\n        let text = this.originalNodeValue;\n        let values = this.properties.map(key => {\n            let item = { name : key, value : parseExpression(key, scope) };\n\n            return item;\n        });\n\n        if (this.singleExpression) {\n                text = parseExpression(text, scope);\n        } else {\n            values.forEach(pair => {\n                text = text.replace(`\\{\\{${pair.name}\\}\\}`, pair.value);\n            });\n        }\n\n        if (hasPrototype(this.node, window.Attr)) {\n            if (this.parentNode.getAttribute(this.node.name) !== text) {\n                polyInvoke(this.parentNode).setAttribute(this.node.name, text);\n            }\n        } else {\n            text = text.toString().replace(/ /g, '\\u00a0');\n\n            if (this.node.textContent !== text) {\n                this.node.textContent = text;\n            }\n        }\n    },\n\n    test: function() { return true; }\n};\n\nexport default Binding;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/modules/DataBinding/Binding.js\n **/","/**\n * @module DataBinding/BindingRegistry\n */\n\n/**\n * Registry of all bindings.\n *\n * @type {Object}\n */\nlet registry = {};\n\n\n/**\n * Public Singleton Interface for the binding registry.\n *\n * @class BindingRegistry\n */\n/** @lends module:DataBinding/BindingRegistry~BindingRegistry.prototype */\nlet BindingRegistry = {\n\n    /**\n     * @param {Binding} binding - new binding type\n     * @return {boolean} - success status\n     */\n    register : function(binding) {\n        if (!registry[binding.name]) {\n            registry[binding.name] = binding;\n            return true;\n\n        } else {\n            console.warn(`Binding type ${binding.name} already exists!`);\n            return false;\n        }\n    },\n\n    /**\n     * @param {string} name - binding name\n     * @return {Binding} - the binding for the given name\n     */\n    get: function(name) {\n        return registry[name];\n    }\n}\n\n/**\n * @member BindingRegistry\n * @static\n * @type module:DataBinding/BindingRegistry~BindingRegistry\n */\nexport default BindingRegistry;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/modules/DataBinding/BindingRegistry.js\n **/","import { Make } from '../../util/make.js';\nimport { parseExpression } from './Parser.js';\nimport Binding from './Binding.js';\nimport RenderEngine from './RenderEngine';\n\nlet ClassBinding = Make(/** @lends module:DataBinding.ClassBinding.prototype */{\n\n    /**\n     * @type {Object}\n     */\n    classes : null,\n\n    /**\n     * @type {Node}\n     */\n    parentNode : null,\n\n    /**\n     * @constructs\n     * @extends {module:DataBinding.Binding}\n     */\n    _make : Binding._make,\n\n    /**\n     * applies a class to the parent node, based on the binding values.\n     *\n     * @param  {module:DataBinding.ScopePrototype} scope the scope to operate on.\n     * @param  {Object} classes class-expression-map\n     * @param  {string} key     the class name to apply\n     *\n     * @return {void}\n     */\n    applyClass : function(scope, classes, key) {\n        let expression = classes[key];\n        let value = parseExpression(expression, scope);\n\n        key = (key[0] === '!') ? key.substr(1) : key;\n\n        if (value) {\n            this.parentNode.classList.add(key);\n        } else {\n            this.parentNode.classList.remove(key);\n        }\n    },\n\n    update : function(scope){\n        let classes = JSON.parse(JSON.stringify(this.classes));\n\n        Object.keys(classes)\n            .filter(key => key.indexOf('!') === 0)\n            .forEach(this.applyClass.bind(this, scope, classes));\n\n        RenderEngine.scheduleRenderTask(() => {\n            Object.keys(classes)\n                .filter(key => key.indexOf('!') !== 0)\n                .forEach(this.applyClass.bind(this, scope, classes));\n        });\n    }\n\n}, Binding).get();\n\nexport default ClassBinding;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/modules/DataBinding/ClassBinding.js\n **/","/**\n * @module RenderEngine\n */\n\nimport { Make } from '../../util/make';\nimport TaskList from './RenderEngine/TaskList';\n\n/** @type {Function[]} */\nlet preRenderHooks = [];\n\n/** @type {Function[]} */\nlet postRenderHooks = [];\n\n/** @type {module:RenderEngine.TaskList} */\nlet preRenderTasks = Make(TaskList)();\n\n/** @type {module:RenderEngine.TaskList} */\nlet renderTasks = Make(TaskList)();\n\n/** @type {Function[]} */\nlet postRenderTasks = [];\n\n/** @type {Function[]} */\nlet nextPostRenderTasks = [];\n\n/** @type {boolean} */\nlet active = false;\n\n/**\n * performs all render tasks from one frame. This is one render cycle.\n *\n * @return {void}\n */\nlet renderCycle = function() {\n    active = false;\n\n    // run all post render hooks after a frame has been painted. So this happens\n    // at the beginning of the next cycle.\n    postRenderHooks.forEach(hook => hook());\n    postRenderTasks.forEach(task => task());\n\n    // init render cycle.\n    // nothing at the moment.\n\n    // run the pre render hooks before we start to do render stuff.\n    preRenderHooks.forEach(hook => hook());\n\n    // run pre render tasks\n    let tasks = preRenderTasks.tasks;\n    preRenderTasks.flush();\n    tasks.forEach(task => task());\n\n    //run all render tasks.\n    tasks = renderTasks.tasks;\n    renderTasks.flush();\n    tasks.forEach(task => task());\n\n    //finish rendering, final steps\n    postRenderTasks = nextPostRenderTasks;\n    nextPostRenderTasks = [];\n\n    // done wait for next frame.\n    scheduleNextFrame();\n};\n\n/**\n * Schedules a new render cycle in the browsers rendeing engine.\n * The cycle is performed as soon as the browser is ready to render a new frame.\n *\n * @return {void}\n */\nlet scheduleNextFrame = function() {\n    if (!active && (postRenderHooks.length > 0 ||preRenderHooks.length > 0 ||\n        renderTasks.length > 0 ||postRenderTasks.length > 0 ||nextPostRenderTasks.length > 0)) {\n            window.requestAnimationFrame(renderCycle);\n\n            active = true;\n    }\n}\n\n\n/**\n * RenderEngine Singleton\n *\n * @namespace\n */\nlet RenderEngine = {\n\n    /**\n     * @param {Function} f a hook function to execute before each render cycle\n     * @return {Function} returns the function which has been passed in\n     */\n    addPreRenderHook: function(f) {\n        preRenderHooks.push(f);\n        scheduleNextFrame();\n\n        return f;\n    },\n\n    /**\n     * @param {Function} f - a hook function to execute after each render cycle\n     * @return {Function} returns the function which has been passed in.\n     */\n    addPostRenderHook: function(f) {\n        postRenderHooks.push(f);\n        scheduleNextFrame();\n\n        return f;\n    },\n\n    /**\n     * Removes a previously added pre render hook\n     *\n     * @param  {Function} f - the function which was previously added\n     * @return {*} - see Array.prototype.splice\n     */\n    removePreRenderHook: function(f) {\n        return preRenderHooks.splice(preRenderHooks.indexOf(f), 1);\n    },\n\n    /**\n     * Removes a previously added post render hook\n     *\n     * @param  {Function} f - the function which was previously added\n     * @return {*} {@link Array.prototype.splice}\n     */\n    removePostRenderHook: function(f) {\n        return postRenderHooks.splice(postRenderHooks.indexOf(f), 1);\n    },\n\n    /**\n     * @param {Function} f - the task to preform in the next render cycle.\n     * @param {string} [id] optional task id\n     * @return {Function} the function which has been passed in.\n     */\n    schedulePreRenderTask: function(f, id) {\n        preRenderTasks.push(f, id);\n        scheduleNextFrame();\n\n        return f;\n    },\n\n    /**\n     * @param {Function} f - the task to preform in the next render cycle.\n     * @param {string} [id] optional task id\n     * @return {Function} the function which has been passed in.\n     */\n    scheduleRenderTask: function(f, id) {\n        renderTasks.push(f, id);\n        scheduleNextFrame();\n\n        return f;\n    },\n\n    /**\n     * @param {Function} f - the task to preform after the next render cycle.\n     * @return {Function} the function which has been passed in.\n     */\n    schedulePostRenderTask: function(f) {\n        nextPostRenderTasks.push(f);\n        scheduleNextFrame();\n\n        return f;\n    },\n\n    /**\n     * Forces the engine to render a new frame even if there are no tasks\n     *\n     * @return {void}\n     */\n    renderFrame: function() {\n        if(!active) {\n            scheduleNextFrame();\n        }\n    }\n};\n\n/**\n * @member {module:RenderEngine~RenderEngine} RenderEngine\n * @static\n */\nexport default RenderEngine;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/modules/DataBinding/RenderEngine.js\n **/","\n/** @lends module:RenderEngine.TaskList.prototype */\nlet TaskList = {\n\n    /** @type Array */\n    tasks: null,\n\n    /** @type Array */\n    registeredIds: null,\n\n    /**\n     * Render TaskList to manage rendertaks and optionally track duplicates by ids.\n     *\n     * @constructs\n     * @return {void}\n     */\n    _make: function() {\n        this.tasks = [];\n        this.registeredIds = [];\n    },\n\n    /**\n     * adds a new item to the task list.\n     *\n     * @param  {Function} task the task to add to the list\n     * @param  {string} [id] the id of this tasks. If provided no task with the same id can be added again.\n     * @return {void}\n     */\n    push: function(task, id) {\n        if (!id || this.registeredIds.indexOf(id) < 0) {\n            this.tasks.push(task);\n\n            if (id) {\n                this.registeredIds.push(id);\n            }\n        }\n    },\n\n    /** @type {number} */\n    get length(){\n        return this.tasks.length;\n    },\n\n    flush: function() {\n        this.tasks = [];\n        this.registeredIds = [];\n    }\n};\n\nexport default TaskList;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/modules/DataBinding/RenderEngine/TaskList.js\n **/","import { Make } from '../../util/make.js';\nimport { parseExpression } from './Parser.js';\nimport { polyInvoke } from './Util.js';\nimport Binding from './Binding.js';\n\nlet EnabledBinding = Make(/** @lends module:DataBinding.EnabledBinding# */{\n    /**\n     * @type {Node}\n     */\n    parentNode : null,\n\n    /**\n     * @constructs\n     * @extends {module:DataBinding.Binding}\n     */\n    _make: Binding._make,\n\n    /**\n     * @param {module:DataBinding.ScopePrototype} scope the scope to work on\n     * @return {void}\n     */\n    update : function(scope){\n        let value = parseExpression(this.originalNodeValue, scope);\n\n        if (!value) {\n            polyInvoke(this.parentNode).setAttribute('disabled', '');\n        } else {\n            polyInvoke(this.parentNode).removeAttribute('disabled');\n        }\n    }\n\n}, Binding).get();\n\nexport default EnabledBinding;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/modules/DataBinding/EnabledBinding.js\n **/","import { parseExpression } from './Parser';\nimport {recycle, watcherList, destoryScope } from './Bind.js';\n\n/**\n * @class ScopePrototype\n * @memberof module:DataBinding\n */\n\n/**\n * @lends module:DataBinding.ScopePrototype.prototype\n */\nlet ScopePrototype = {\n\n    /**\n    * will apply the current state of the bound model.\n    *\n    * @param {function} [fn]            function to execute before rendering\n    * @param {boolean} [localRecycle]   only recycle the current scope\n    *\n    * @return {void}\n    */\n    __apply__ : function(fn, localRecycle){\n        if (fn) {\n            fn();\n        }\n\n        return recycle(localRecycle ? this : null);\n    },\n\n    /**\n     * starts to watch the given expression and fires when the value changes.\n     *\n     * @param  {string}   expression the expression to watch\n     * @param  {Function} cb         will be called once the value changes\n     *\n     * @return {void}\n     */\n    __watch__ : function(expression, cb) {\n        if (!watcherList.has(this)) {\n            watcherList.set(this, []);\n        }\n\n        watcherList.get(this).push({\n            expression : expression,\n            cb : cb\n        });\n    },\n\n    /**\n     * destorys a scope\n     *\n     * @param  {boolean} inProgress whenever this is an initial call or not\n     *\n     * @return {boolean} status\n     */\n    __destroy__ : function(inProgress) {\n        return destoryScope(this, inProgress);\n    },\n\n    /**\n    * resolves when the expression returns not undefined or null\n    *\n    * @param  {string|Function}   expression the expression to evaluate\n    *\n    * @return {Promise}                      resolves when stable\n    */\n    require: function(expression) {\n        return new Promise((done) => {\n            let value = null;\n\n            if (typeof expression === 'function') {\n                value = expression();\n            } else {\n                value = parseExpression(expression, this);\n            }\n\n            if (value !== undefined && value !== null) {\n                done(value);\n            }\n        });\n    }\n};\n\nexport default ScopePrototype;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/modules/DataBinding/ScopePrototype.js\n **/","/**\n * @module DataBinding/StyleBinding\n */\n\nimport { Make } from '../../util/make';\nimport { ObjectParser, assignExpression } from './Parser';\n\nimport Binding from './Binding';\nimport RenderEngine from './RenderEngine';\n\n/**\n * @param {StyleBinding} container - binding container\n * @param {ScopePrototype} scope - the scope for this binding\n * @return {void}\n */\nlet readStyleProperties = function(container, scope){\n    Object.keys(container.bindings).forEach(styleKey => {\n        let style = window.getComputedStyle(container.parentNode);\n        let dimensions = container.parentNode.getBoundingClientRect();\n\n        if(styleKey.split('.')[0] === 'dimensions') {\n            let value = dimensions[styleKey.split('.')[1]];\n\n            assignExpression(container.bindings[styleKey], scope, value);\n        } else {\n            assignExpression(container.bindings[styleKey], scope, style[styleKey]);\n        }\n    });\n}\n\nlet StyleBinding = Make(/** @lends module:DataBinding/StyleBinding~StyleBinding# */{\n    bindings: null,\n\n    /**\n     * @constructs\n     * @extends {module:DataBinding.Binding}\n     *\n     * @return {void}\n     */\n    _make: function() {\n        this.bindings = ObjectParser(this.bindings);\n    },\n\n    update: function(scope) {\n        RenderEngine.schedulePostRenderTask(readStyleProperties.bind(null, this, scope));\n    }\n}, Binding).get();\n\n/**\n * @member StyleBinding\n * @type {module:DataBinding/StyleBinding~StyleBinding}\n * @static\n */\nexport default StyleBinding;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/modules/DataBinding/StyleBinding.js\n **/","import { Make } from '../../util/make.js';\nimport Binding from './Binding.js';\nimport { parseExpression } from './Parser.js';\nimport { bindNode } from './Bind.js';\nimport { polyInvoke, getPolyParent } from './Util.js';\n\nlet TemplateRepeatBinding = Make(/** @lends module:DataBinding.TemplateRepeatBinding# */{\n\n    /**\n     * @type {WeakMap}\n     */\n    itemNodeList : null,\n\n    /**\n     * @type {WeakMap}\n     */\n    itemScopeList : null,\n\n    /**\n     * @type {Node}\n     */\n    template : null,\n\n    /**\n     * @type {Node}\n     */\n    marker : null,\n\n    /**\n     * @type {Array}\n     */\n    modelBackup : null,\n\n    /**\n     * @constructs\n     * @extends {Binding}\n     * @return {void}\n     */\n    _make : function(){\n        Binding._make.apply(this);\n\n        this.itemNodeList = new Map();\n        this.itemScopeList = new Map();\n        this.modelBackup = [];\n    },\n\n    /**\n     * renders one model item to the DOM\n     *\n     * @param  {*} model      [description]\n     * @param  {ScopePrototype} scope      [description]\n     * @param  {string} itemName   [description]\n     * @param  {DocumentFragment} fragment   [description]\n     * @param  {Node} polyParent [description]\n     * @param  {Object} item       [description]\n     * @param  {number} index      [description]\n     * @return {void}            [description]\n     */\n    renderItem : function(model, scope, itemName, fragment, polyParent, item, index){\n        let node = null;\n\n        if (this.itemNodeList.has(item)) {\n            node = this.itemNodeList.get(item);\n            let childScope = this.itemScopeList.get(item);\n\n            childScope.$first = index === 0;\n            childScope.$last = model.length -1 === index;\n            childScope.$index = index;\n        } else {\n            let childScope = Make({\n                $first : index === 0,\n                $last : model.length-1 === index,\n                $index : index,\n                __parentScope__ : scope,\n            }, scope).get();\n\n            childScope[itemName] = item;\n\n            node = document.importNode(this.template.content, true).firstElementChild;\n            bindNode(node, childScope, true);\n\n            this.itemNodeList.set(item, node);\n            this.itemScopeList.set(item, childScope);\n        }\n\n        fragment.appendChild(node);\n    },\n\n    update : function(scope){\n        let [itemName, link, expression] = this.originalNodeValue.split(' ');\n        let model = parseExpression(expression, scope);\n        let polyParent = this.template.getAttribute('bind-polymer-parent');\n        let dirty = false;\n\n        if (link !== 'in') {\n            console.console.error('DataBinding: invalide expression', this.originalNodeValue);\n            return;\n        }\n\n        model = model && Array.isArray(model) ? model : [];\n        dirty = this.modelBackup.length !== model.length;\n\n        if (!dirty) {\n            for (let i = 0; i < model.length; i++) {\n                if (model[i] !== this.modelBackup[i]) {\n                    dirty = true;\n                    break;\n                }\n            }\n        }\n\n        if (dirty) {\n            this.modelBackup.forEach(item => {\n                if (model.indexOf(item) < 0) {\n                    if (polyParent) {\n                        polyInvoke(getPolyParent(this.marker, polyParent)).removeChild(this.itemNodeList.get(item));\n                    } else {\n                        polyInvoke(this.marker.parentNode).removeChild(this.itemNodeList.get(item));\n                    }\n\n                    this.itemScopeList.delete(item);\n                    this.itemNodeList.delete(item);\n                }\n            });\n\n            this.modelBackup = model.slice();\n\n            if (window.Polymer) {\n                window.Polymer.dom.flush();\n            }\n\n            /** @type {DocumentFragment} */\n            let fragment = new DocumentFragment();\n\n            model.forEach(this.renderItem.bind(this, model, scope, itemName, fragment, polyParent));\n\n            if (this.marker.nextElementSibling) {\n                if (polyParent) {\n                    polyInvoke(getPolyParent(this.marker, polyParent)).insertBefore(fragment, this.marker.nextElementSibling);\n                } else {\n                    polyInvoke(this.marker.parentNode).insertBefore(fragment, this.marker.nextElementSibling);\n                }\n            } else {\n                if (polyParent) {\n                    polyInvoke(getPolyParent(this.marker, polyParent)).appendChild(fragment);\n                } else {\n                    polyInvoke(this.marker.parentNode).appendChild(fragment);\n                }\n            }\n        }\n    },\n\n    destory : function(){\n        let count = this.modelBackup.reduce((prev, item) => {\n            let [scopes, bindings] = prev;\n            let scope = this.itemScopeList.get(item);\n            let [scopes_add, bindings_add] = scope.__destroy__(true);\n\n            return [scopes + scopes_add, bindings + bindings_add];\n        }, [0, 0]);\n\n        this.itemScopeList = null;\n        this.itemNodeList = null;\n\n        return count;\n    }\n\n}, Binding).get();\n\nexport default TemplateRepeatBinding;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/modules/DataBinding/TemplateRepeatBinding.js\n **/","import { Make } from '../../util/make.js';\nimport { attributeNames } from './Mapping.js';\nimport { parseExpression, assignExpression } from './Parser.js';\nimport { polyInvoke } from './Util.js';\nimport Binding from './Binding.js';\n\n/**\n * @class TwoWayBinding\n * @extends module:DataBinding.Binding\n * @memberof module:DataBinding\n */\n\nlet TwoWayBinding = Make(/** @lends module:DataBinding.TwoWayBinding# */{\n    /**\n     * @type {string}\n     */\n    currentValue : '',\n\n    /**\n     * @type {Node}\n     */\n    parentNode : null,\n\n    /**\n     * @type {boolean}\n     */\n    indirect : false,\n\n    /**\n     * @type {string}\n     */\n    viewBinding : '',\n\n    update : function(scope){\n        let value = parseExpression(this.properties[0], scope);\n        let attribute = attributeNames.rename(this.node.name);\n\n        if (!this.indirect){\n            polyInvoke(this.parentNode).setAttribute(attribute, value);\n        } else {\n            let oldValue = parseExpression(this.viewBinding, this.parentNode);\n\n            if (value !== oldValue) {\n                assignExpression(this.viewBinding, this.parentNode, value);\n                this.currentValue = value;\n\n                if (document.activeElement === this.parentNode) {\n                    let range = document.createRange();\n                    let selection = window.getSelection();\n                    \n                    range.selectNodeContents(this.parentNode);\n                    range.collapse(false);\n                    selection.removeAllRanges();\n                    selection.addRange(range);\n                }\n            }\n        }\n    }\n}, Binding).get();\n\nexport default TwoWayBinding;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/modules/DataBinding/TwoWayBinding.js\n **/","import { Make } from '../../util/make.js';\nimport NetworkRequest from '../../core/prototypes/NetworkRequest.js';\n//import { polyInvoke } from './Util.js';\n\n\n/*let FakeTemplate = {\n    _markup : '',\n    _fragment: null,\n\n    _make : function(markup) {\n        this._markup = markup;\n    },\n\n    get content() {\n        if (!this._fragment) {\n            this._fragment = new DocumentFragment();\n            let container = document.createElement('div');\n\n            polyInvoke(container).innerHTML = this._markup;\n\n            [].forEach.apply(container.childNodes, [element => {\n                polyInvoke(this._fragment).appendChild(element);\n            }]);\n        }\n        return this._fragment;\n    }\n};*/\n\n/**\n * imports a template node from an external HTML file.\n *\n * @function\n * \n * @param {string} source the url of the file that holds the template to import\n * @param {HTMLTemplateElement} template the template element to contain the import\n *\n * @return {HTMLTemplateElement} returns the provided template node, but now holding the imported nodes.\n */\nexport let importTemplate = function(source, template) {\n    let request = Make(NetworkRequest)(source, {});\n\n    return request.send().then(markup => {\n        template.innerHTML = markup;\n\n        return template;\n    });\n}\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/modules/DataBinding/TemplateLoader.js\n **/","/**\n * @module NetworkRequest\n */\n\n\n/**\n * removes angulars hashKey property from an object\n *\n * @param {Object} object the object to operate on\n *\n * @return {Object} the initial object\n */\nlet stripHashKey = function(object){\n\tif (Array.isArray(object)) {\n\t\tobject = object.map(stripHashKey);\n\n\t} else {\n\t\tobject = JSON.parse(JSON.stringify(object));\n\n\t\tObject.keys(object).forEach(function(key){\n\t\t\tif (key == '$$hashKey') {\n\t\t\t\tdelete object[key];\n\t\t\t}else if (typeof object[key] === 'object' ) {\n\t\t\t\tobject[key] = stripHashKey(object[key]);\n\t\t\t}\n\t\t});\n\t}\n\n\treturn object;\n}\n\n/**\n * @lends module:NetworkRequest.NetworkRequest#\n */\nlet NetworkRequest = {\n    /**\n     * @private\n     * @type {Object}\n     */\n    _body : {},\n\n    /**\n     * @private\n     * @type {Object}\n     */\n\t_headers : null,\n\n    /**\n     * @type {string}\n     */\n\ttype : '',\n\n    /**\n     * @type {string}\n     */\n\tmethod : '',\n\n    /**\n     * @type {string}\n     */\n\turl : '',\n\n    /**\n     * @type {function[]}\n     * @private\n     */\n    _listeners : null,\n\n\t/**\n\t * The constructor for the NetworkRequest. It simply sets up the properties.\n\t *\n\t * @constructs\n\t *\n\t * @param {string} url the url this request should be made to\n\t * @param {Object} config addintional configuartion for the request\n\t *\n\t * @return {NetworkRequest} the request it self\n\t */\n\t_make : function(url, { method = 'GET', type = 'none' } = {}){\n\t\tthis.type = type;\n\t\tthis.method = method;\n        this._headers = {};\n\t\tthis.url = url;\n        this._listeners = [];\n\t},\n\n\t/**\n\t * this method will set the given object as the request body.\n\t *\n\t * @param {Object} data body data for this request\n\t *\n\t * @return {NetworkRequest} the request it self\n\t */\n\tbody : function(data){\n\t\tthis._body = data;\n\n\t\treturn this;\n\t},\n\n\t/**\n\t * This method will set the request headers, in case custom headers are required.\n\t *\n\t * @param {Object} headers a object with all header properties for this request\n\t *\n\t * @return {NetworkRequest} the request it self\n\t */\n\theaders : function(headers) {\n\t\tthis._headers = headers;\n\n\t\treturn this;\n\t},\n\n    /**\n     * Sets a single header for this request.\n     *\n     * @param {string} key the header key\n     * @param {string} value the header value\n     *\n     * @return {NetworkRequest} the request it self\n     */\n    setHeader : function(key, value) {\n        this._headers[key] = value;\n\n        return this;\n    },\n\n    /**\n     * sets a callback for when the request is ready\n     *\n     * @param {function} fn a callback function as soon as the data is ready\n     *\n     * @return {void}\n     */\n    onReady : function(fn){\n        this._listeners.push(fn);\n    },\n\n\t/**\n\t * This will actually create the network connection and initiate the request.\n\t *\n\t * @return {Promise} resolves when the request is done\n\t */\n\tsend : function(){\n\t\tlet self = this;\n\t\tlet xhr = new XMLHttpRequest();\n\n\t\tif (this.method === 'GET' && this._body) {\n\t\t\tthis.url += '?' + Object.keys(this._body).map(function(key){\n\t\t\t\treturn `${key}=${self._body[key]}`;\n\t\t\t}).join('&');\n\t\t}\n\n\t\txhr.open(this.method, this.url, true);\n\n\t\tlet promise = new Promise((success, failure) => {\n\t\t\txhr.onreadystatechange = () => {\n\t\t\t\tif (xhr.readyState === 4) {\n\t\t\t\t\tif (xhr.status === 200) {\n\t\t\t\t\t\tlet response = xhr.response;\n\n\t\t\t\t\t\tif (xhr.getResponseHeader('Content-Type').indexOf('application/json') > -1 && typeof response  === 'string') {\n                            response = JSON.parse(response);\n\t\t\t\t\t\t}\n\n                        this._listeners.forEach(fn => fn(xhr));\n\n\t\t\t\t\t\tsuccess(response);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tfailure(xhr);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t})\n\n\t\tObject.keys(this._headers).forEach(function(key){\n\t\t\txhr.setRequestHeader(key, self._headers[key]);\n\t\t});\n\n\t\tif (this.type === 'json') {\n            let body = this._body;\n\n\t\t\txhr.setRequestHeader('Content-Type', 'application/json');\n\n            if (body){\n                body = stripHashKey(body);\n                body = JSON.stringify(body);\n            }\n\n\t\t\txhr.send(body);\n\t\t} else {\n\t\t\txhr.send(this._body);\n\t\t}\n\n\t\treturn promise;\n\t}\n};\n\nexport default NetworkRequest;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/core/prototypes/NetworkRequest.js\n **/","/**\n * @module DataBinding/ViewPort\n */\n\nimport { DataBinding } from '../DataBinding.js';\nimport { Make } from '../../util/make.js';\nimport { polyInvoke } from './Util.js';\nimport RenderEngine from './RenderEngine';\n\nconst LIST_HAS_ITEMS = 0;\n\n/** @lends module:DataBinding/ViewPort.ViewPortInstance# */\nlet ViewPortInstance = {\n\n    /**\n     * @private\n     * @type {module:DataBinding.ScopePrototype}\n     */\n    _scope : null,\n\n    /**\n     * @private\n     * @type {boolean}\n     */\n    _bound : false,\n\n    /**\n     * @private\n     * @type {module:DataBinding.ScopePrototype}\n     */\n    _innerScope : null,\n\n    /**\n     * @private\n     * @type {HTMLTemplateElement}\n     */\n    _originalTemplate : null,\n\n    /**\n     * @private\n     * @type {Application}\n     */\n    _application : null,\n\n    /**\n     * @constructs\n     *\n     * @param  {module:DataBinding.ScopePrototype} scope    the scope of this viewport instance\n     * @param  {Application} application the application this viewport instance belongs to\n     *\n     * @return {void}\n     */\n    _make : function(scope, application) {\n        this._scope = scope;\n        this._application = application;\n    },\n\n    /**\n     * binds the ViewPort to a scope so it can be filled with content\n     *\n     * @param  {Object} context a collection of properties to configure the viewport\n     *\n     * @return {Promise.<module:DataBinding/ViewPort.ViewPortInstance>}  promise for when the viewport is bound\n     */\n    bind : function(context) {\n        return new Promise((done, error) => {\n            if (!this._bound) {\n                RenderEngine.schedulePostRenderTask(() => {\n                    this._scope.templateUrl = context.template;\n                    this._scope.overflow = '';\n                    this._scope.__apply__();\n\n                    if (!this._originalTemplate) {\n                        this._originalTemplate = this._scope.element.firstElementChild;\n                    }\n\n                    this._innerScope = DataBinding.makeTemplate(\n                        this._originalTemplate,\n                        context.scope || {},\n                        this._application,\n                        this._scope\n                    );\n\n                    this._bound = true;\n\n                    context.scope = this._innerScope;\n\n                    done(this);\n                });\n            } else {\n                error('ViewPort: viewport is already bound!');\n            }\n        });\n    },\n\n    /**\n     * updates the inner scope of the viewport\n     *\n     * @param  {...*} args arguments to be passed on to {@link module:DataBinding.ScopePrototype#__apply__}\n     *\n     * @return {void}\n     */\n    update : function(...args) {\n        return this._innerScope.__apply__(...args);\n    },\n\n    /**\n     * the scope if ViewPort content\n     *\n     * @type {module:DataBinding.ScopePrototype}\n     */\n    get scope() {\n        return this._innerScope;\n    },\n\n    destory : function(){\n        if (this._bound) {\n            this._innerScope.__destroy__();\n\n            while (this._scope.element.children.length > LIST_HAS_ITEMS) {\n                polyInvoke(this._scope.element).removeChild(this._scope.element.firstChild);\n            }\n\n            polyInvoke(this._scope.element).appendChild(this._originalTemplate);\n            this._bound = false;\n            this._originalTemplate.processed = false;\n        }\n    },\n\n    /**\n     * enables the viewport content to overflow the viewports bounds\n     *\n     * @return {void}\n     */\n    alowOverflow : function() {\n        this._scope.overflow = 'overflow';\n        this._scope.__apply__();\n    },\n};\n\n/**\n * the interface for the ViewPort module\n *\n * @namespace\n * @static\n */\nlet ViewPort = {\n\n    /**\n     * all instanciated ViewPorts\n     *\n     * @private\n     * @type {Map.<module:DataBinding.ScopePrototype>}\n     */\n    _elements : new Map(),\n\n    /**\n     * the applicaion the viewports are registered to\n     *\n     * @private\n     * @type {Application}\n     */\n    _application : null,\n\n    /**\n     * @constructs\n     * @param {Application} application - the application this viewport belongs to.\n     * @return {void}\n     */\n    _make : function(application){\n        let style = polyInvoke(document.head).appendChild(document.createElement('style'));\n        let template = document.createElement('template');\n\n        polyInvoke(style).innerHTML = `\n            .view-port {\n                position: relative;\n                left: 0;\n                top: 0;\n                height: 100%;\n                width: 100%;\n                display: flex;\n                flex-direction: column;\n                overflow: auto;\n            }\n\n            .view-port.overflow {\n                overflow: visible;\n            }\n        `;\n\n        template.id = 'view-port';\n        polyInvoke(template).setAttribute('bind-element', '');\n        polyInvoke(template).setAttribute('component', '');\n\n        polyInvoke(template).innerHTML = `\n            <div class=\"custom-element {{overflow}}\">\n                <template src=\"templateUrl\" replace></template>\n            </div>\n        `;\n\n        application.on('newElement:view-port', (scope) => {\n            this._elements[scope.name] = Make(ViewPortInstance)(scope, application);\n            application.emit(`viewPort:ready:${scope.name}`);\n        });\n\n        this._application = application;\n\n        DataBinding.makeTemplate(template, () => { return {} }, application);\n    },\n\n    /**\n     * fetches a viewPort instance by a name\n     *\n     * @param  {string} name the name to look for\n     *\n     * @return {Promise.<module:DataBinding.ScopePrototype>}  the matching scope\n     */\n    getInstance : function(name){\n        return new Promise((success) => {\n            if (this._elements[name]) {\n                success(this._elements[name]);\n            } else {\n                this._application.on(`viewPort:ready:${name}`, () => success(this._elements[name]));\n            }\n        });\n    },\n\n    /**\n     * destorys an viewPort instance\n     *\n     * @param  {module:DataBinding/ViewPort.ViewPortInstance} instance the instance to destroy\n     *\n     * @return {void}\n     */\n    free : function(instance){\n        this._elements[instance._scope.name] = null;\n\n        instance._scope.__destroy__();\n    }\n};\n\nexport default ViewPort;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/modules/DataBinding/ViewPort.js\n **/","import { Make } from '../../util/make.js';\nimport { parseExpression } from './Parser.js';\nimport Binding from './Binding.js';\nimport BindingRegistry from './BindingRegistry.js';\n\nlet IfBinding = Make(/** @lends module:DataBinding.IfBinding# **/{\n\n    /** @type {string} */\n    name: 'bind-if',\n\n    /**\n     * @type {Node}\n     */\n    parentNode: null,\n\n    /**\n     * @type {Node}\n     */\n    node: null,\n\n    /**\n     * @type {Node}\n     */\n    nextSibling: null,\n\n    /**\n     *\n     * @constructs\n     * @extends {Binding}\n     * @param {Node} parentNode - this node\n     * @param {string} text - the attribute value\n     * @param {ScopeInfo} scopeInfo - bindings container\n     *\n     * @return {void}\n     */\n    _make: function({ parentNode, text, scopeInfo }) {\n        this.node = parentNode;\n        this.parentNode = this.node.parentNode;\n        this.text = text;\n        this.nextSibling = parentNode.nextSibling;\n\n        scopeInfo.bindings.push(this);\n    },\n\n    update: function(scope) {\n        let isTrue = parseExpression(this.text, scope);\n\n        if (isTrue) {\n            if (this.node.parentNode !== this.parentNode){\n                if (this.nextSibling) {\n                    this.parentNode.insertBefore(this.node, this.nextSibling);\n                } else {\n                    this.parentNode.appendChild(this.node);\n                }\n            }\n        } else {\n            if (this.node.parentNode === this.parentNode) {\n                this.parentNode.removeChild(this.node);\n            }\n        }\n    },\n\n}, Binding).get();\n\nBindingRegistry.register(IfBinding);\n\nexport default IfBinding;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/modules/DataBinding/IfBinding.js\n **/","import { Make } from '../../util/make';\nimport { assignExpression, parseExpression } from './Parser';\nimport Binding from './Binding';\nimport BindingRegistry from './BindingRegistry.js';\n\nlet ElementToScopeBinding = Make(/** @lends module:DataBinding.ElementToScopeBinding.prototype */{\n\n    /**\n     * @type {string}\n     */\n    name: 'scope-id',\n\n    /**\n     * @type {Node}\n     */\n    parentNode: null,\n\n    /**\n     * @constructs\n     * @extends {module:DataBinding.Binding}\n     *\n     * @param  {Node} parentNode   parent node of this binding\n     * @param  {Object} scopeInfo  scope metadata object\n     * @param  {string} text       original text value of the binding\n     *\n     * @return {void}\n     */\n    _make: function({parentNode, scopeInfo, text }) {\n        Binding._make.apply(this);\n\n        this.parentNode = parentNode;\n        this.text = text;\n\n        scopeInfo.bindings.push(this);\n\n    },\n\n    update: function(scope) {\n        /** @type {Node} */\n        let currentValue = parseExpression(this.text, scope);\n\n        if (currentValue !== this.parentNode) {\n            assignExpression(this.text, scope, this.parentNode);\n            scope.__apply__(null, true);\n        }\n    },\n\n}, Binding).get();\n\nBindingRegistry.register(ElementToScopeBinding);\n\nexport default ElementToScopeBinding;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/af/modules/DataBinding/ElementToScopeBinding.js\n **/","import DataBinding from '../af/modules/DataBinding.js';\n\n/** @lends Header# */\nlet Header = {\n    view: null,\n\n    /** @type {application} */\n    application: null,\n\n    get notConnected() {\n        /** @type {Socket} */\n        let socket = this.application.socket;\n\n        return !socket.online ||!socket.connected;\n    },\n\n    get connected() {\n        let socket = this.application.socket;\n\n        return socket.online && socket.connected;\n    },\n\n    get connectionStatus() {\n        let socket = this.application.socket;\n\n        if (!socket.online) {\n            return 'offline';\n        } else if (!socket.connected && socket.connecting) {\n            return 'connecting...';\n        } else {\n            return 'diconnected';\n        }\n    },\n\n    _make: function(application) {\n        this.application = application;\n\n        let scope = DataBinding.makeTemplate('#header-status', {\n            view: this,\n        }).scope;\n\n        this.application.socket.onStatusChange(scope.__apply__.bind(scope, null, true));\n    }\n}\n\nexport default Header;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/Header.js\n **/","import DataBinding from '../af/modules/DataBinding.js';\n\nlet MessageList = {\n\n    currentMessages: [\n        {\n            type: 'out',\n            content: 'hey mein Schatz wo bist du?',\n            timestamp: '1473194720625',\n        },\n        {\n            type: 'out',\n            content: 'hey ',\n            timestamp: '1473194783059',\n        },\n        {\n            type: 'in',\n            content: 'was',\n            timestamp: '1473194821597',\n        },\n        {\n            type: 'in',\n            content: 'was',\n            timestamp: '1473194821597',\n        },\n        {\n            type: 'in',\n            content: 'was',\n            timestamp: '1473194821597',\n        }\n    ],\n\n    _make: function() {\n        DataBinding.makeTemplate('#message-list', { view: this });\n    }\n};\n\nexport default MessageList;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/MessageList.js\n **/","import { Make } from '../af/util/make.js';\n\nlet PushManager = Make(/** @lends PushManager */{\n\n    platform: '',\n\n    serviceStatus: '',\n\n    _newPushHandler: null,\n    _registerHandler: null,\n\n    /**\n     * [_handleServiceError description]\n     *\n     * @callback\n     * @param  {Object} data [description]\n     *\n     * @return {void}      [description]\n     */\n    _handleServiceError: function(data) {\n        this.serviceStatus = 'init failed';\n        console.console.error('push service failed:', data);\n    },\n\n    _baiduHandleServiceReady: function(data) {\n        this._register(data.clientId);\n\n        this.serviceStatus = 'OK';\n        console.log('baidu push is ready', data);\n    },\n\n    _handleMessageError: function(data) {\n        console.error('push message error:', data);\n    },\n\n    _make: function() {\n        if (!!window.cordova && window.cordova.platformId === 'android') {\n            this.platform = 'android';\n        } else if (!!navigator.push) {\n            this.platform = 'firefoxos';\n        }\n\n        this._newPushHandler = [];\n        this._registerHandler = [];\n    },\n\n    _newMessage: function() {\n        this._newPushHandler.forEach(fn => fn());\n    },\n\n    _register: function(token) {\n        this._registerHandler.forEach(fn => fn(token));\n    },\n\n    _registerServiceSimple: function(force) {\n        navigator.push.registrations().onsuccess = function(e) {\n            if (e.target.result.length === 0 && force) {\n                e.target.result.forEach(enpoint => navigator.push.unregister(enpoint));\n\n                let request = navigator.push.register();\n                request.onsuccess = this._simpleHandleServiceReady;\n                request.onerror = this._handleServiceError;\n            }\n        };\n    },\n\n    init: function() {\n        if (this.platform === 'android') {\n            window.baiduPush.startWork('KGQvyGtzWRG6X48cSAwf5Mxk', this._baiduHandleServiceReady.bind(this), this._handleServiceError.bind(this));\n            window.baiduPush.onNotificationArrived(this._newMessage.bind(this), this._handleMessageError.bind(this));\n        } else if (this.platform === 'firefoxos') {\n            this._registerServiceSimple();\n            navigator.mozSetMessageHandler('push', this._newMessage.bind(this));\n            navigator.mozSetMessageHandler('push-register', () => this._registerServiceSimple(true));\n        }\n    },\n\n    onPush: function(fn) {\n        this._newPusHandler.push(fn);\n    },\n\n    onRegister: function(fn) {\n        this._registerHandler.push(fn);\n    },\n\n    setRegistrationFailed: function() {\n        this.serviceStatus = 'unable to register push service';\n    }\n})();\n\nexport default PushManager;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/PushManager.js\n **/","import { Make } from '../af/util/make.js';\n\nlet ScreenManager = Make(/** @lends ScreenManager */{\n\n    applicationIsActive: false,\n\n    _make: function() {\n        this.applicationIsActive = !document.hidden;\n\n        document.addEventListener('visibilitychange', () => {\n            this.applicationIsActive = !document.hidden;\n\n            console.log('application is ', this.applicationIsActive ? 'active' : 'inactive', 'now');\n        });\n\n        document.addEventListener('resume', (e) => {\n            console.log('application has resumed', e);\n        });\n    }\n})();\n\nexport default ScreenManager;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/ScreenManager.js\n **/","\n\nlet Socket = {\n\n    _host: '',\n    _hostId: 0,\n    _websocket: null,\n    _online: false,\n    _connected: false,\n    _connecting: false,\n    _onStatusChange: null,\n\n    _decelerate: null,\n    _decelerateTimeout: 0,\n    _decelerateMaxTimeout: 30,\n\n    get connected() {\n        return this._connected;\n    },\n\n    set connected(value) {\n        this._connected = value;\n        this._statusChange();\n    },\n\n    get connecting() {\n        return this._connecting;\n    },\n\n    set connecting(value) {\n        this._connecting = value;\n        this._statusChange();\n    },\n\n\n    get online() {\n        return this._online;\n    },\n\n    set online(value) {\n        this._online = value;\n        this._statusChange();\n    },\n\n    _make: function({ host }) {\n        this._host = host;\n        this._onceQueue = {};\n        this._listeners = {};\n        this._onStatusChange = [];\n\n        this.online = navigator.onLine;\n\n        window.addEventListener('online', () => {\n            this.online = navigator.onLine;\n            console.log('Socket: online');\n            this.init();\n        });\n\n        window.addEventListener('offline', () => {\n            this.online = navigator.onLine;\n            console.log('Socket: offline');\n            this.reconnect();\n        })\n    },\n\n    _ack: function(messageId) {\n        this.sendMessage({}, `response::${messageId}`);\n    },\n\n    _onMessage: function(message) {\n        this._ack(message.id);\n\n        if (this._onceQueue[message.type]) {\n            this._onceQueue[message.type].forEach(fn => fn(message.data));\n            this._onceQueue[message.type] = [];\n        }\n\n        if (this._listeners[message.type]) {\n            this._listeners.forEach(fn => fn(message.data));\n        }\n    },\n\n    _statusChange: function() {\n        this._onStatusChange.forEach(fn => fn());\n    },\n\n    _onceQueue: null,\n    _listeners: null,\n\n    sendMessage: function(message, type=\"message\") {\n        let data = {\n//            id: uuid.v4(null, window.performance.now()),\n            data: message,\n            type: type,\n        };\n\n        let promise = new Promise((success, timeout) => {\n            if (type.indexOf('response::') === 0) {\n                return success();\n            }\n\n            let timeoutId = setTimeout(timeout, 10000);\n\n            this.once(`response::${data.id}`, data => {\n                clearTimeout(timeoutId);\n                success(data.message);\n            });\n        });\n\n        promise.catch(() => this.reconnect());\n\n        this.websocket.send(JSON.stringify(data));\n    },\n\n    reconnect: function() {\n        this.websocket.close();\n    },\n\n    init: function() {\n        if (this.online && !this.decelerate) {\n\n            this.connecting = true;\n            this._decelerate = setTimeout(() => {\n                console.log('trying to establishe a connection...');\n                this._decelerate = null;\n                this.websocket = new WebSocket(`ws://${this._host[this._hostId]}`);\n\n                this.websocket.onopen = () => {\n                    this.connected = true;\n                    this.connecting = false;\n                    this._decelerateTimeout = 0;\n                    console.log('connection established!');\n                }\n\n                this.websocket.onerror = function(error) {\n                    console.error('websocket error:', error);\n                }\n\n                this.websocket.onclose = () => {\n                    // socket closed restart\n                    this._hostId += 1;\n                    this._decelerateTimeout += 1;\n\n                    if (this._hostId > this._host.length - 1) {\n                        this._hostId = 0;\n                    }\n\n                    if (this._decelerateTimeout > this._decelerateMaxTimeout) {\n                        this._decelerateTimeout = this._decelerateMaxTimeout;\n                    }\n\n                    console.warn(`websocket disconnected! Retry in ${this._decelerateTimeout}s to ${this._host[this._hostId]}`);\n                    this.connected = false;\n                    this.init();\n                }\n\n                this.websocket.onmessage = this._onMessage.bind(this);\n            }, this._decelerateTimeout * 1000);\n        }\n    },\n\n    once: function(type, fn) {\n        if (!this._onceQueue[type]) {\n            this._onceQueue[type] = [];\n        }\n\n        this._onceQueue.push(fn);\n    },\n\n    onStatusChange: function(fn) {\n        this._onStatusChange.push(fn);\n    }\n};\n\nexport default Socket;\n\n\n\n/** WEBPACK FOOTER **\n ** ./src/js/Socket.js\n **/"],"sourceRoot":""}